<?xml version="1.0" standalone="yes" ?>
<?xml-stylesheet href="x2script.xsl" type="text/xsl" ?>
<script>
<name>!ship.cmd.mtc.buy.pre</name>
<version>6</version>
<engineversion>71</engineversion>
<description>Ship Command: (MENU) Manual Trade - Buy</description>
<arguments>
<argument index="1" name="a.ship" type="Value" desc="Ship" />
<argument index="2" name="a.state" type="Var/String" desc="State" />
<argument index="3" name="a.value" type="Value" desc="Last Value" />
</arguments>
<sourceplaintext>
<![CDATA[
  * receive cancelled state if any input was cancelled
  if $a.state == [MEvent.Cancelled]
    if $a.value == 'amount'
      $a.state = 'start'
    else
      gosub sub.ClearVars
    end
  end
  
  * State: 'start' will be received when the menu is first opened
  if $a.state == [MEvent.Start]
  * return a station user input
    if is datatype[ $a.value ] == DATATYPE_ARRAY
      $station = $a.value[1]
      $product = $a.value[0]
      if $station -> is of class Station
        if is datatype[ $product ] == DATATYPE_WARE
          $a.ship ->set local variable: name='mtc.buy.station' value=$a.value
          gosub sub.BuildMenu
          return $input
        end
      end
    end
    $text = read text: page=6001 id=1312
    $input = create input: id='station', user input=Var/Station and Product, refobj=$a.ship, description=$text, without sector=[FALSE], filterclass=null, racemask=null, flags=null, default=null
    return $input
    
  else if $a.state == 'station'
    $a.ship ->set local variable: name='mtc.buy.station' value=$a.value
    gosub sub.BuildMenu
    return $input
    
  else if $a.state == 'amount'
  * return [TRUE] when there is no more input required
    $amount = $a.value[1]
    $a.ship ->set local variable: name='mtc.buy.amount' value=$amount
    return [TRUE]
    
  else if $a.state == [MEvent.Update]
    gosub sub.BuildMenu
    return $menu
    
  * the "tradebar" state will be sent every update when the bar is active
  else if $a.state == [MEvent.TradeBarCh]
    $value = $a.value[2]
    $a.ship ->set local variable: name='mtc.buy.val' value=$value
    gosub sub.BuildMenu
    return $menu
    
  * Once all inputs have finished, receive the 'arguments' state
  else if $a.state == [MEvent.Arguments]
    gosub sub.GetStationProduct
    $amount = $a.ship -> get local variable: name='mtc.buy.amount'
  * return the arguments that will be passed to the command script
  * can either be a single argument, or an array of multiple arguments
    $ret = create new array, arguments=$stationProduct, $amount, null, null, null
    gosub sub.ClearVars
    return $ret
    
  else if $a.state == 'args'
    $size = size of array $a.value
    if $size == 1
      $arg = $a.value[0]
@     $ret = [THIS] -> call script !ship.cmd.mtc.buy.pre :  Ship=$a.ship  State='station'  Last Value=$arg
      return $ret
    else if $size > 1
      $arg = $a.value[0]
      $a.ship ->set local variable: name='mtc.buy.station' value=$a.value
      $arg = $a.value[1]
@     $ret = [THIS] -> call script !ship.cmd.mtc.buy.pre :  Ship=$a.ship  State='amount'  Last Value=$arg
      return $ret
    end
    
  else if $a.state == [MEvent.Finished]
    gosub sub.ClearVars
  end
  
  return null
  
  
  sub.BuildMenu:
  gosub sub.GetStationProduct
  $menu = create custom menu array
  
  $heading = read text: page=[Page.Menus] id=9306
  $default = $a.ship -> get local variable: name='mtc.buy.val'
@ = [THIS] -> call script !lib.menu.tradebar.trade :  Ship=$a.ship  Station=$station  Product=$product  Menu Array=$menu  Current Value=$default  Selling?=[FALSE]  Heading=$heading
  
  set menu option: $menu, icon=7
  set menu option: $menu, maximum menu height=7 lines
  $title = read text: page=6001 id=9
  $text = read text: page=6001 id=7
  $input = create input: id='amount', dynamic menu=$menu, title=$title, description=$text, callback=[Callback.TradeBarCh], update=1000ms
  endsub
  
  
  sub.GetStationProduct:
  $stationProduct = $a.ship -> get local variable: name='mtc.buy.station'
  $station = $stationProduct[1]
  $product = $stationProduct[0]
  endsub
  
  sub.ClearVars:
  $a.ship ->set local variable: name='mtc.buy.amount' value=null
  $a.ship ->set local variable: name='mtc.buy.station' value=null
  $a.ship ->set local variable: name='mtc.buy.val' value=null
  endsub
  return null
]]>
</sourceplaintext>
<sourcetext>
<line indent=""><comment><text>*&#160;</text><var>receive&#160;cancelled&#160;state&#160;if&#160;any&#160;input&#160;was&#160;cancelled</var></comment></line>
<line indent=""><var>if&#160;</var><var>$a.state</var><text>&#160;</text><var>==</var><text>&#160;</text><var>[MEvent.Cancelled]</var></line>
<line indent="&#160;"><var>if&#160;</var><var>$a.value</var><text>&#160;</text><var>==</var><text>&#160;</text><var>'amount'</var></line>
<line indent="&#160;&#160;"><var>$a.state&#160;=&#160;</var><var>'start'</var></line>
<line indent="&#160;"><text>else</text></line>
<line indent="&#160;&#160;"><text>gosub&#160;</text><var>sub.ClearVars</var></line>
<line indent="&#160;"><text>end</text></line>
<line indent=""><text>end</text></line>
<line indent=""></line>
<line indent=""><comment><text>*&#160;</text><var>State:&#160;'start'&#160;will&#160;be&#160;received&#160;when&#160;the&#160;menu&#160;is&#160;first&#160;opened</var></comment></line>
<line indent=""><var>if&#160;</var><var>$a.state</var><text>&#160;</text><var>==</var><text>&#160;</text><var>[MEvent.Start]</var></line>
<line indent=""><comment><text>*&#160;</text><var>return&#160;a&#160;station&#160;user&#160;input</var></comment></line>
<line indent="&#160;"><var>if&#160;</var><text>is&#160;datatype[&#160;</text><var>$a.value</var><text>&#160;]&#160;==&#160;</text><var>DATATYPE_ARRAY</var></line>
<line indent="&#160;&#160;"><var>$station&#160;=&#160;</var><var>$a.value</var><text>[</text><var>1</var><text>]</text></line>
<line indent="&#160;&#160;"><var>$product&#160;=&#160;</var><var>$a.value</var><text>[</text><var>0</var><text>]</text></line>
<line indent="&#160;&#160;"><var>if&#160;</var><var>$station&#160;-&gt;</var><text>&#160;is&#160;of&#160;class&#160;</text><var>Station</var></line>
<line indent="&#160;&#160;&#160;"><var>if&#160;</var><text>is&#160;datatype[&#160;</text><var>$product</var><text>&#160;]&#160;==&#160;</text><var>DATATYPE_WARE</var></line>
<line indent="&#160;&#160;&#160;&#160;"><var>$a.ship&#160;-&gt;</var><text>set&#160;local&#160;variable:&#160;name=</text><var>'mtc.buy.station'</var><text>&#160;value=</text><var>$a.value</var></line>
<line indent="&#160;&#160;&#160;&#160;"><text>gosub&#160;</text><var>sub.BuildMenu</var></line>
<line indent="&#160;&#160;&#160;&#160;"><text>return&#160;</text><var>$input</var></line>
<line indent="&#160;&#160;&#160;"><text>end</text></line>
<line indent="&#160;&#160;"><text>end</text></line>
<line indent="&#160;"><text>end</text></line>
<line indent="&#160;"><var>$text&#160;=&#160;</var><text>read&#160;text:&#160;page=</text><var>6001</var><text>&#160;id=</text><var>1312</var></line>
<line indent="&#160;"><var>$input&#160;=&#160;</var><text>create&#160;input:&#160;id=</text><var>'station'</var><text>,&#160;user&#160;input=</text><var>Var/Station&#160;and&#160;Product</var><text>,&#160;refobj=</text><var>$a.ship</var><text>,&#160;description=</text><var>$text</var><text>,&#160;without&#160;sector=</text><var>[FALSE]</var><text>,&#160;filterclass=</text><var>null</var><text>,&#160;racemask=</text><var>null</var><text>,&#160;flags=</text><var>null</var><text>,&#160;default=</text><var>null</var></line>
<line indent="&#160;"><text>return&#160;</text><var>$input</var></line>
<line indent="&#160;"></line>
<line indent=""><var>else&#160;if&#160;</var><var>$a.state</var><text>&#160;</text><var>==</var><text>&#160;</text><var>'station'</var></line>
<line indent="&#160;"><var>$a.ship&#160;-&gt;</var><text>set&#160;local&#160;variable:&#160;name=</text><var>'mtc.buy.station'</var><text>&#160;value=</text><var>$a.value</var></line>
<line indent="&#160;"><text>gosub&#160;</text><var>sub.BuildMenu</var></line>
<line indent="&#160;"><text>return&#160;</text><var>$input</var></line>
<line indent="&#160;"></line>
<line indent=""><var>else&#160;if&#160;</var><var>$a.state</var><text>&#160;</text><var>==</var><text>&#160;</text><var>'amount'</var></line>
<line indent=""><comment><text>*&#160;</text><var>return&#160;[TRUE]&#160;when&#160;there&#160;is&#160;no&#160;more&#160;input&#160;required</var></comment></line>
<line indent="&#160;"><var>$amount&#160;=&#160;</var><var>$a.value</var><text>[</text><var>1</var><text>]</text></line>
<line indent="&#160;"><var>$a.ship&#160;-&gt;</var><text>set&#160;local&#160;variable:&#160;name=</text><var>'mtc.buy.amount'</var><text>&#160;value=</text><var>$amount</var></line>
<line indent="&#160;"><text>return&#160;</text><var>[TRUE]</var></line>
<line indent="&#160;"></line>
<line indent=""><var>else&#160;if&#160;</var><var>$a.state</var><text>&#160;</text><var>==</var><text>&#160;</text><var>[MEvent.Update]</var></line>
<line indent="&#160;"><text>gosub&#160;</text><var>sub.BuildMenu</var></line>
<line indent="&#160;"><text>return&#160;</text><var>$menu</var></line>
<line indent="&#160;"></line>
<line indent=""><comment><text>*&#160;</text><var>the&#160;&quot;tradebar&quot;&#160;state&#160;will&#160;be&#160;sent&#160;every&#160;update&#160;when&#160;the&#160;bar&#160;is&#160;active</var></comment></line>
<line indent=""><var>else&#160;if&#160;</var><var>$a.state</var><text>&#160;</text><var>==</var><text>&#160;</text><var>[MEvent.TradeBarCh]</var></line>
<line indent="&#160;"><var>$value&#160;=&#160;</var><var>$a.value</var><text>[</text><var>2</var><text>]</text></line>
<line indent="&#160;"><var>$a.ship&#160;-&gt;</var><text>set&#160;local&#160;variable:&#160;name=</text><var>'mtc.buy.val'</var><text>&#160;value=</text><var>$value</var></line>
<line indent="&#160;"><text>gosub&#160;</text><var>sub.BuildMenu</var></line>
<line indent="&#160;"><text>return&#160;</text><var>$menu</var></line>
<line indent="&#160;"></line>
<line indent=""><comment><text>*&#160;</text><var>Once&#160;all&#160;inputs&#160;have&#160;finished,&#160;receive&#160;the&#160;'arguments'&#160;state</var></comment></line>
<line indent=""><var>else&#160;if&#160;</var><var>$a.state</var><text>&#160;</text><var>==</var><text>&#160;</text><var>[MEvent.Arguments]</var></line>
<line indent="&#160;"><text>gosub&#160;</text><var>sub.GetStationProduct</var></line>
<line indent="&#160;"><var>$amount&#160;=&#160;</var><var>$a.ship&#160;-&gt;</var><text>&#160;get&#160;local&#160;variable:&#160;name=</text><var>'mtc.buy.amount'</var></line>
<line indent=""><comment><text>*&#160;</text><var>return&#160;the&#160;arguments&#160;that&#160;will&#160;be&#160;passed&#160;to&#160;the&#160;command&#160;script</var></comment></line>
<line indent=""><comment><text>*&#160;</text><var>can&#160;either&#160;be&#160;a&#160;single&#160;argument,&#160;or&#160;an&#160;array&#160;of&#160;multiple&#160;arguments</var></comment></line>
<line indent="&#160;"><var>$ret&#160;=&#160;</var><text>create&#160;new&#160;array,&#160;arguments=</text><var>$stationProduct</var><text>,&#160;</text><var>$amount</var><text>,&#160;</text><var>null</var><text>,&#160;</text><var>null</var><text>,&#160;</text><var>null</var></line>
<line indent="&#160;"><text>gosub&#160;</text><var>sub.ClearVars</var></line>
<line indent="&#160;"><text>return&#160;</text><var>$ret</var></line>
<line indent="&#160;"></line>
<line indent=""><var>else&#160;if&#160;</var><var>$a.state</var><text>&#160;</text><var>==</var><text>&#160;</text><var>'args'</var></line>
<line indent="&#160;"><var>$size&#160;=&#160;</var><text>size&#160;of&#160;array&#160;</text><var>$a.value</var></line>
<line indent="&#160;"><var>if&#160;</var><var>$size</var><text>&#160;</text><var>==</var><text>&#160;</text><var>1</var></line>
<line indent="&#160;&#160;"><var>$arg&#160;=&#160;</var><var>$a.value</var><text>[</text><var>0</var><text>]</text></line>
<line interruptable="@" indent="&#160;&#160;"><var>$ret&#160;=&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;call&#160;script&#160;</text><call>!ship.cmd.mtc.buy.pre</call><text>&#160;:&#160;</text><text>&#160;Ship=</text><var>$a.ship</var><text>&#160;</text><text>&#160;State=</text><var>'station'</var><text>&#160;</text><text>&#160;Last&#160;Value=</text><var>$arg</var></line>
<line indent="&#160;&#160;"><text>return&#160;</text><var>$ret</var></line>
<line indent="&#160;"><var>else&#160;if&#160;</var><var>$size</var><text>&#160;</text><var>&gt;</var><text>&#160;</text><var>1</var></line>
<line indent="&#160;&#160;"><var>$arg&#160;=&#160;</var><var>$a.value</var><text>[</text><var>0</var><text>]</text></line>
<line indent="&#160;&#160;"><var>$a.ship&#160;-&gt;</var><text>set&#160;local&#160;variable:&#160;name=</text><var>'mtc.buy.station'</var><text>&#160;value=</text><var>$a.value</var></line>
<line indent="&#160;&#160;"><var>$arg&#160;=&#160;</var><var>$a.value</var><text>[</text><var>1</var><text>]</text></line>
<line interruptable="@" indent="&#160;&#160;"><var>$ret&#160;=&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;call&#160;script&#160;</text><call>!ship.cmd.mtc.buy.pre</call><text>&#160;:&#160;</text><text>&#160;Ship=</text><var>$a.ship</var><text>&#160;</text><text>&#160;State=</text><var>'amount'</var><text>&#160;</text><text>&#160;Last&#160;Value=</text><var>$arg</var></line>
<line indent="&#160;&#160;"><text>return&#160;</text><var>$ret</var></line>
<line indent="&#160;"><text>end</text></line>
<line indent="&#160;"></line>
<line indent=""><var>else&#160;if&#160;</var><var>$a.state</var><text>&#160;</text><var>==</var><text>&#160;</text><var>[MEvent.Finished]</var></line>
<line indent="&#160;"><text>gosub&#160;</text><var>sub.ClearVars</var></line>
<line indent=""><text>end</text></line>
<line indent=""></line>
<line indent=""><text>return&#160;</text><var>null</var></line>
<line indent=""></line>
<line indent=""></line>
<line indent=""><var>sub.BuildMenu</var><text>:</text></line>
<line indent=""><text>gosub&#160;</text><var>sub.GetStationProduct</var></line>
<line indent=""><var>$menu&#160;=&#160;</var><text>create&#160;custom&#160;menu&#160;array</text></line>
<line indent=""></line>
<line indent=""><var>$heading&#160;=&#160;</var><text>read&#160;text:&#160;page=</text><var>[Page.Menus]</var><text>&#160;id=</text><var>9306</var></line>
<line indent=""><var>$default&#160;=&#160;</var><var>$a.ship&#160;-&gt;</var><text>&#160;get&#160;local&#160;variable:&#160;name=</text><var>'mtc.buy.val'</var></line>
<line interruptable="@" indent=""><var>=&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;call&#160;script&#160;</text><call>!lib.menu.tradebar.trade</call><text>&#160;:&#160;</text><text>&#160;Ship=</text><var>$a.ship</var><text>&#160;</text><text>&#160;Station=</text><var>$station</var><text>&#160;</text><text>&#160;Product=</text><var>$product</var><text>&#160;</text><text>&#160;Menu&#160;Array=</text><var>$menu</var><text>&#160;</text><text>&#160;Current&#160;Value=</text><var>$default</var><text>&#160;</text><text>&#160;Selling?=</text><var>[FALSE]</var><text>&#160;</text><text>&#160;Heading=</text><var>$heading</var></line>
<line indent=""></line>
<line indent=""><text>set&#160;menu&#160;option:&#160;</text><var>$menu</var><text>,&#160;icon=</text><var>7</var></line>
<line indent=""><text>set&#160;menu&#160;option:&#160;</text><var>$menu</var><text>,&#160;maximum&#160;menu&#160;height=</text><var>7</var><text>&#160;lines</text></line>
<line indent=""><var>$title&#160;=&#160;</var><text>read&#160;text:&#160;page=</text><var>6001</var><text>&#160;id=</text><var>9</var></line>
<line indent=""><var>$text&#160;=&#160;</var><text>read&#160;text:&#160;page=</text><var>6001</var><text>&#160;id=</text><var>7</var></line>
<line indent=""><var>$input&#160;=&#160;</var><text>create&#160;input:&#160;id=</text><var>'amount'</var><text>,&#160;dynamic&#160;menu=</text><var>$menu</var><text>,&#160;title=</text><var>$title</var><text>,&#160;description=</text><var>$text</var><text>,&#160;callback=</text><var>[Callback.TradeBarCh]</var><text>,&#160;update=</text><var>1000</var><text>ms</text></line>
<line indent=""><text>endsub</text></line>
<line indent=""></line>
<line indent=""></line>
<line indent=""><var>sub.GetStationProduct</var><text>:</text></line>
<line indent=""><var>$stationProduct&#160;=&#160;</var><var>$a.ship&#160;-&gt;</var><text>&#160;get&#160;local&#160;variable:&#160;name=</text><var>'mtc.buy.station'</var></line>
<line indent=""><var>$station&#160;=&#160;</var><var>$stationProduct</var><text>[</text><var>1</var><text>]</text></line>
<line indent=""><var>$product&#160;=&#160;</var><var>$stationProduct</var><text>[</text><var>0</var><text>]</text></line>
<line indent=""><text>endsub</text></line>
<line indent=""></line>
<line indent=""><var>sub.ClearVars</var><text>:</text></line>
<line indent=""><var>$a.ship&#160;-&gt;</var><text>set&#160;local&#160;variable:&#160;name=</text><var>'mtc.buy.amount'</var><text>&#160;value=</text><var>null</var></line>
<line indent=""><var>$a.ship&#160;-&gt;</var><text>set&#160;local&#160;variable:&#160;name=</text><var>'mtc.buy.station'</var><text>&#160;value=</text><var>null</var></line>
<line indent=""><var>$a.ship&#160;-&gt;</var><text>set&#160;local&#160;variable:&#160;name=</text><var>'mtc.buy.val'</var><text>&#160;value=</text><var>null</var></line>
<line indent=""><text>endsub</text></line>
<line indent=""><text>return&#160;</text><var>null</var></line>
</sourcetext>
<codearray>

<sval type="array" size="10">
  <sval type="string" val="!ship.cmd.mtc.buy.pre"/>
  <sval type="int" val="71"/>
  <sval type="string" val="Ship Command: (MENU) Manual Trade - Buy"/>
  <sval type="int" val="6"/>
  <sval type="int" val="0"/>
  <sval type="array" size="17">
    <sval type="string" val="a.ship"/>
    <sval type="string" val="a.state"/>
    <sval type="string" val="a.value"/>
    <sval type="string" val="station"/>
    <sval type="string" val="product"/>
    <sval type="string" val="input"/>
    <sval type="string" val="text"/>
    <sval type="string" val="amount"/>
    <sval type="string" val="menu"/>
    <sval type="string" val="value"/>
    <sval type="string" val="ret"/>
    <sval type="string" val="stationProduct"/>
    <sval type="string" val="size"/>
    <sval type="string" val="arg"/>
    <sval type="string" val="heading"/>
    <sval type="string" val="default"/>
    <sval type="string" val="title"/>
  </sval>
  <sval type="array" size="85">
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610611453"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="434"/>
      <sval type="int" val="15"/>
      <sval type="int" val="0"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="0"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610611709"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="2"/>
      <sval type="int" val="5"/>
      <sval type="string" val="amount"/>
      <sval type="int" val="15"/>
      <sval type="int" val="0"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="0"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="7">
      <sval type="int" val="104"/>
      <sval type="int" val="1"/>
      <sval type="int" val="1"/>
      <sval type="int" val="5"/>
      <sval type="string" val="start"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-1"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="112"/>
      <sval type="int" val="5"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="1167"/>
      <sval type="int" val="79"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610608125"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="430"/>
      <sval type="int" val="15"/>
      <sval type="int" val="0"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="0"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="125"/>
      <sval type="int" val="-1610609149"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="2"/>
      <sval type="int" val="20"/>
      <sval type="int" val="21"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="129"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="2"/>
      <sval type="int" val="4"/>
      <sval type="int" val="1"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="129"/>
      <sval type="int" val="4"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="2"/>
      <sval type="int" val="4"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="705"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1610609149"/>
      <sval type="int" val="12"/>
      <sval type="int" val="2016"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="125"/>
      <sval type="int" val="-1610609149"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="4"/>
      <sval type="int" val="20"/>
      <sval type="int" val="9"/>
    </sval>
    <sval type="array" size="7">
      <sval type="int" val="155"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
      <sval type="int" val="5"/>
      <sval type="string" val="mtc.buy.station"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="1167"/>
      <sval type="int" val="62"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="5"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="126"/>
      <sval type="int" val="6"/>
      <sval type="int" val="4"/>
      <sval type="int" val="6001"/>
      <sval type="int" val="4"/>
      <sval type="int" val="1312"/>
    </sval>
    <sval type="array" size="20">
      <sval type="int" val="1647"/>
      <sval type="int" val="5"/>
      <sval type="int" val="5"/>
      <sval type="string" val="station"/>
      <sval type="int" val="24"/>
      <sval type="int" val="47"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="6"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="9"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="5"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="112"/>
      <sval type="int" val="61"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610606843"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="1"/>
      <sval type="int" val="5"/>
      <sval type="string" val="station"/>
      <sval type="int" val="15"/>
      <sval type="int" val="0"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="0"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="7">
      <sval type="int" val="155"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
      <sval type="int" val="5"/>
      <sval type="string" val="mtc.buy.station"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="1167"/>
      <sval type="int" val="62"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="5"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="112"/>
      <sval type="int" val="61"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610605563"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="1"/>
      <sval type="int" val="5"/>
      <sval type="string" val="amount"/>
      <sval type="int" val="15"/>
      <sval type="int" val="0"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="0"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="129"/>
      <sval type="int" val="7"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="2"/>
      <sval type="int" val="4"/>
      <sval type="int" val="1"/>
    </sval>
    <sval type="array" size="7">
      <sval type="int" val="155"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
      <sval type="int" val="5"/>
      <sval type="string" val="mtc.buy.amount"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="7"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="10"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="112"/>
      <sval type="int" val="61"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610604539"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="494"/>
      <sval type="int" val="15"/>
      <sval type="int" val="0"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="0"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="1167"/>
      <sval type="int" val="62"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="8"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="112"/>
      <sval type="int" val="61"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610603003"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="497"/>
      <sval type="int" val="15"/>
      <sval type="int" val="0"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="0"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="129"/>
      <sval type="int" val="9"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="2"/>
      <sval type="int" val="4"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="7">
      <sval type="int" val="155"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
      <sval type="int" val="5"/>
      <sval type="string" val="mtc.buy.val"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="9"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="1167"/>
      <sval type="int" val="62"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="8"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="112"/>
      <sval type="int" val="61"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610601211"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="429"/>
      <sval type="int" val="15"/>
      <sval type="int" val="0"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="0"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="1167"/>
      <sval type="int" val="74"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="156"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
      <sval type="int" val="5"/>
      <sval type="string" val="mtc.buy.amount"/>
      <sval type="int" val="7"/>
    </sval>
    <sval type="array" size="12">
      <sval type="int" val="1415"/>
      <sval type="int" val="10"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="11"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="7"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="1167"/>
      <sval type="int" val="79"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="10"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="112"/>
      <sval type="int" val="61"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610597627"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="1"/>
      <sval type="int" val="5"/>
      <sval type="string" val="args"/>
      <sval type="int" val="15"/>
      <sval type="int" val="0"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="0"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="131"/>
      <sval type="int" val="12"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610599421"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="12"/>
      <sval type="int" val="4"/>
      <sval type="int" val="1"/>
      <sval type="int" val="15"/>
      <sval type="int" val="0"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="0"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="129"/>
      <sval type="int" val="13"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="2"/>
      <sval type="int" val="4"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="12">
      <sval type="int" val="102"/>
      <sval type="string" val="!ship.cmd.mtc.buy.pre"/>
      <sval type="int" val="10"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
      <sval type="int" val="5"/>
      <sval type="string" val="station"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="13"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="10"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="112"/>
      <sval type="int" val="58"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610597883"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="12"/>
      <sval type="int" val="4"/>
      <sval type="int" val="1"/>
      <sval type="int" val="15"/>
      <sval type="int" val="2"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="2"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="129"/>
      <sval type="int" val="13"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="2"/>
      <sval type="int" val="4"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="7">
      <sval type="int" val="155"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
      <sval type="int" val="5"/>
      <sval type="string" val="mtc.buy.station"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="129"/>
      <sval type="int" val="13"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="2"/>
      <sval type="int" val="4"/>
      <sval type="int" val="1"/>
    </sval>
    <sval type="array" size="12">
      <sval type="int" val="102"/>
      <sval type="string" val="!ship.cmd.mtc.buy.pre"/>
      <sval type="int" val="10"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
      <sval type="int" val="5"/>
      <sval type="string" val="amount"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="13"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="10"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="112"/>
      <sval type="int" val="61"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610597115"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="431"/>
      <sval type="int" val="15"/>
      <sval type="int" val="0"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="0"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="1167"/>
      <sval type="int" val="79"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="101"/>
      <sval type="string" val="sub.BuildMenu"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="1167"/>
      <sval type="int" val="74"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="1445"/>
      <sval type="int" val="8"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="126"/>
      <sval type="int" val="14"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1100"/>
      <sval type="int" val="4"/>
      <sval type="int" val="9306"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="156"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
      <sval type="int" val="5"/>
      <sval type="string" val="mtc.buy.val"/>
      <sval type="int" val="15"/>
    </sval>
    <sval type="array" size="20">
      <sval type="int" val="102"/>
      <sval type="string" val="!lib.menu.tradebar.trade"/>
      <sval type="int" val="-2147483647"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="7"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="4"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="8"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="15"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="9"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="14"/>
    </sval>
    <sval type="array" size="5">
      <sval type="int" val="1776"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="8"/>
      <sval type="int" val="4"/>
      <sval type="int" val="7"/>
    </sval>
    <sval type="array" size="5">
      <sval type="int" val="1596"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="8"/>
      <sval type="int" val="4"/>
      <sval type="int" val="7"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="126"/>
      <sval type="int" val="16"/>
      <sval type="int" val="4"/>
      <sval type="int" val="6001"/>
      <sval type="int" val="4"/>
      <sval type="int" val="9"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="126"/>
      <sval type="int" val="6"/>
      <sval type="int" val="4"/>
      <sval type="int" val="6001"/>
      <sval type="int" val="4"/>
      <sval type="int" val="7"/>
    </sval>
    <sval type="array" size="14">
      <sval type="int" val="1661"/>
      <sval type="int" val="5"/>
      <sval type="int" val="5"/>
      <sval type="string" val="amount"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="8"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="16"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="6"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="586"/>
      <sval type="int" val="4"/>
      <sval type="int" val="1000"/>
    </sval>
    <sval type="array" size="1">
      <sval type="int" val="1168"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="101"/>
      <sval type="string" val="sub.GetStationProduct"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="156"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
      <sval type="int" val="5"/>
      <sval type="string" val="mtc.buy.station"/>
      <sval type="int" val="11"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="129"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="11"/>
      <sval type="int" val="4"/>
      <sval type="int" val="1"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="129"/>
      <sval type="int" val="4"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="11"/>
      <sval type="int" val="4"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="1">
      <sval type="int" val="1168"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="101"/>
      <sval type="string" val="sub.ClearVars"/>
    </sval>
    <sval type="array" size="7">
      <sval type="int" val="155"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
      <sval type="int" val="5"/>
      <sval type="string" val="mtc.buy.amount"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="7">
      <sval type="int" val="155"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
      <sval type="int" val="5"/>
      <sval type="string" val="mtc.buy.station"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="7">
      <sval type="int" val="155"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
      <sval type="int" val="5"/>
      <sval type="string" val="mtc.buy.val"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="1">
      <sval type="int" val="1168"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
    </sval>
  </sval>
  <sval type="array" size="3">
    <sval type="array" size="2">
      <sval type="int" val="9"/>
      <sval type="string" val="Ship"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="11"/>
      <sval type="string" val="State"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="9"/>
      <sval type="string" val="Last Value"/>
    </sval>
  </sval>
  <sval type="array" size="32">
    <sval type="array" size="3">
      <sval type="int" val="0"/>
      <sval type="int" val="1"/>
      <sval type="string" val="receive cancelled state if any input was cancelled"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="4"/>
      <sval type="int" val="5"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="5"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="5"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="5"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="5"/>
      <sval type="int" val="1"/>
      <sval type="string" val="State: 'start' will be received when the menu is first opened"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="6"/>
      <sval type="int" val="1"/>
      <sval type="string" val="return a station user input"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="14"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="14"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="14"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="17"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="22"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="24"/>
      <sval type="int" val="1"/>
      <sval type="string" val="return [TRUE] when there is no more input required"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="27"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="31"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="31"/>
      <sval type="int" val="1"/>
      <sval type="string" val="the &quot;tradebar&quot; state will be sent every update when the bar is active"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="37"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="37"/>
      <sval type="int" val="1"/>
      <sval type="string" val="Once all inputs have finished, receive the 'arguments' state"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="41"/>
      <sval type="int" val="1"/>
      <sval type="string" val="return the arguments that will be passed to the command script"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="41"/>
      <sval type="int" val="1"/>
      <sval type="string" val="can either be a single argument, or an array of multiple arguments"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="44"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="58"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="58"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="61"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="61"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="62"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="62"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="65"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="68"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="74"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="74"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="79"/>
      <sval type="int" val="2"/>
    </sval>
  </sval>
  <sval type="int" val="0"/>
</sval>

</codearray>
<nosignature>1030</nosignature>
</script>
