<?xml version="1.0" encoding="utf-8" ?>
<?xml-stylesheet href="director.xsl" type="text/xsl" ?>
<director name="template" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="director.xsd">
  <documentation>
    <author name="ANH Team" alias="..." contact="Forums"/>
    <content reference="CSV" name="A New Home" description="The entire mission and toplevel manager"/>
    <version number="1.1" date="03/08/2009" status="release"/>
  </documentation>
  <cues>
    <cue name="CSV_MadHawk_Fix" delay="2s">
      <condition>
        <check_value value="{value@ANH Plot Complete}" exact="1"/>
      </condition>
      <action>
        <do_all>
          <find_ship group="this.M1sinDC" multiple="1" typename="SS_SH_A_M1" race="argon">
            <sector x="4" y="8"/>
            <jumps exact="0"/>
          </find_ship>
          <do_all counter="M1counter" exact="{group.object.count@this.M1sinDC}">
            <do_if value="{group.object.{counter@M1counter}.invincible@this.M1sinDC}" exact="1">
              <add_object_to_group object="{group.object.{counter@M1counter}@this.M1sinDC}" group="this.MadHawks"/>
            </do_if>
          </do_all>
          <destroy_group group="this.MadHawks" warp="1"/>
          <remove_group group="this.M1sinDC"/>
        </do_all>
      </action>
    </cue>
    <cue name="CSV_toplevel" delay="5s" version="3">
      <documentation>
        <content reference="CSV_toplevel" name="CSV Setup and management"/>
        <version number="1.0" date="03/08/2009" status="candidate"/>
        <history>
          <change author="ANH Team" date="08/12/2008" description="Initial version"/>
          <change author="Owen Lake" date="03/08/2009" description="2.5 Beta 2 version. Merged all files into one."/>
          <change author="Jens" date="07/08/2009" description="All text.duration Checked"/>
          <change author="Jens" date="15/08/2009" description="All XXXXP in briefing and set objective remotely."/>
          <change author="Jens" date="18/08/2009" description="All popup messages examines. With group heimkerer cue name in CSC_toplevel changed."/>
          <change author="Jens" date="21/08/2009" description="All popup messages examines. With group heimkerer cue name in CSC_toplevel changed."/>
          <change author="Owen Lake" date="30/08/2009" description="Reworked the station exist code for fix bugs."/>
          <change author="Owen Lake" date="20/11/2009" description="Finished final overview for 2.6 Beta 1. Set to Candidate status"/>
          <change author="Owen Lake" date="23/12/2009" description="Finished final overview for 2.6 RC 1. Removed debug TODOS"/>
          <change author="Ketraar" date="29/04/2010" description="Removed set_invincible=0 and set_boardable=0 in cue CSV_Chapter1_Accapted No"/>
        </history>
      </documentation>
      <condition>
        <check_all>
			<check_any>
				<check_value value="{value@Terran Plot Complete}" exact="1"/>
				<check_value value="{value@AP Terran Plot Start}" exact="1"/>
				<check_value value="{value@Albion Prelude Plot Start}" exact="1"/>
			</check_any>
            <check_value value="{value@Goner Plot Finished}" exact="1"/>
            <check_value value="{player.ship.cargo.SS_WARE_UNFOCUS_JUMP.exists}" exact="1"/>
            <count_stations class="shipyard" dockingallowed="1" race="default" min="1">
                <sector x="4" y="9"/>
                <jumps max="20"/>
            </count_stations>
        </check_all>
      </condition>
      <action>
        <do_all>
			<set_value name="this.StartedNewHome" exact="1"/>
          <load_map file="ANH_Map_effa"/>
          <!--Find Sektoren.-->
          <find_sector name="CSV_toplevel.CSV_DannasChance" x="4" y="8" comment="Danna's Chance"/>
          <find_sector name="CSV_toplevel.CSV_WegZuFreiheit" x="4" y="9" comment="Freedom's Reach"/>
          <find_sector name="CSV_toplevel.CSV_ElenasGlueck" x="3" y="5" comment="Elena's Fortune"/>
          <find_sector name="CSV_toplevel.CSV_VergeltungDerKoenigin" x="20" y="5" comment="Ocean of Fantasty Alpha"/>
          <find_sector name="CSV_toplevel.CSV_UFJD Sektoren1" x="23" y="19" comment="UFJD Sector"/>
          <find_sector name="CSV_toplevel.CSV_Aldrin" x="16" y="1" comment="Aldrin"/>
          <find_sector name="CSV_toplevel.CSV_playersector" x="22" y="5" comment="Player Sector"/>
          <!--Find Stationen.-->
          <find_station name="this.MiliDock1" group="CSV_toplevel.PlotStations" typename="SS_DOCK_A_MILITARY" race="argon">
            <sector x="3" y="5"/>
          </find_station>
          <find_station name="this.HsWzF" group="CSV_toplevel.PlotStations" typename="SS_DOCK_T_TRADE" race="teladi">
            <sector sector="CSV_toplevel.CSV_WegZuFreiheit"/>
          </find_station>
          <find_station name="this.Shipyard VdK" group="CSV_toplevel.PlotStations" typename="SS_FAC_B_SHIP" race="boron">
            <sector sector="CSV_toplevel.CSV_VergeltungDerKoenigin"/>
          </find_station>
          <find_station name="this.StationAl1" group="CSV_toplevel.PlotStations" typename="SS_DOCK_LC_1" race="terran">
            <sector sector="CSV_toplevel.CSV_Aldrin"/>
          </find_station>
          <find_station name="this.XFStation" group="CSV_toplevel.PlotStations" typename="SS_FAC_LC_6" race="terran">
            <sector sector="CSV_toplevel.CSV_Aldrin"/>
          </find_station>
          <find_station name="this.CSV_NotarSY" class="shipyard" group="CSV_toplevel.PlotStations" dockingallowed="1" race="default">
            <sector x="4" y="9"/>
            <jumps max="20"/>
          </find_station>
          
          <!--Find Gates-->
          <find_gate name="this.DC GateS" gate="south">
            <sector sector="CSV_toplevel.CSV_DannasChance"/>
          </find_gate>
          <find_gate name="this.WzF GateN" gate="north">
            <sector sector="CSV_toplevel.CSV_WegZuFreiheit"/>
          </find_gate>

          <!--Set Value!-->
          <set_value name="this.CSVchapter2link" exact="0"/>
          <set_value name="this.CSVchapter3link" exact="0"/>
          <set_value name="this.CSVchapter4link" exact="0"/>
          <set_value name="this.CSVchapter5link" exact="0"/>
          <set_value name="this.CSVchapter6link" exact="0"/>
          <set_value name="this.CSVchapter7link" exact="0"/>
          <set_value name="this.CSVComplet" exact="0"/>
          <set_value name="this.CSVNotarOffer" exact="0"/>
          <set_value name="this.CSVSectorofferbriefing" exact="0"/>
          <set_value name="this.CSVEFactorloadcheck" exact="0"/>
          <set_value name="this.CSVNPCfleetreset" exact="0"/>
          
          <!--Value definitions-->
          <set_value name="this.CSVsectorregcost" exact="333333333"/>
          <set_value name="this.CSVNPCfleetresetlimit" min="3" max="7"/>
          <set_value name="CSV_toplevel.NeededEnergyForJump" exact="20"/>
          
          
          <!--effa sector set up-->
          <do_any>
            <set_value name="this.SectorBackgroundvalue" exact="71"/>
            <set_value name="this.SectorBackgroundvalue" exact="72"/>
          </do_any>
		  <find_sector name="CSV_toplevel.CSV_playersector" x="22" y="5" comment="Player Sector"/>
		  <alter_sector sector="CSV_toplevel.CSV_playersector" background="{value@this.SectorBackgroundvalue}" size="60km" population="0"/>
          <set_sector_override sector="CSV_toplevel.CSV_playersector" textid="1020000"/>
          <do_if value="{object.exists@this.MiliDock1}" exact="0">
            <create_station name="this.MiliDock1" group="CSV_toplevel.PlotStations" typename="SS_DOCK_A_MILITARY" race="argon">
              <position x="26500m" y="3500m" z="-8500m"/>
              <sector sector="CSV_toplevel.CSV_ElenasGlueck"/>
              <equipment loadout="default"/>
            </create_station>
          </do_if>
          <do_if value="{object.exists@this.HsWzF}" exact="0">
            <create_station name="this.HsWzF" group="CSV_toplevel.PlotStations" typename="SS_DOCK_T_TRADE" race="teladi">
              <position x="-1800m" y="8850m" z="3000m"/>
              <sector sector="CSV_toplevel.CSV_WegZuFreiheit"/>
              <equipment loadout="default"/>
            </create_station>
          </do_if>
          <do_if value="{object.exists@this.XFStation}" exact="0">
            <create_station name="this.XFStation" group="CSV_toplevel.PlotStations" typename="SS_FAC_LC_6" race="terran">
              <position x="16598571" y="1641017" z="-57304815"/>
              <sector sector="CSV_toplevel.CSV_Aldrin"/>
              <equipment loadout="default"/>
              <products>
                <ware exact="1" typename="SS_SH_TERRAFORMER2"/>
                <ware exact="1" typename="SS_SH_TERRAFORMER3"/>
                <ware exact="1" typename="SS_SH_TERRAFORMER4"/>
                <ware exact="1" typename="SS_SH_LOST_M3H"/>
                <ware exact="1" typename="SS_SH_LOST_M6H"/>
              </products>
            </create_station>
          </do_if>
          <do_if value="{object.exists@this.StationAl1}" exact="0">
            <create_station name="this.StationAl1" group="CSV_toplevel.PlotStations" typename="SS_DOCK_LC_1" race="terran">
              <position x="70719573" y="-30992663" z="80563322"/>
              <sector sector="CSV_toplevel.CSV_Aldrin"/>
              <equipment loadout="default"/>
            </create_station>
          </do_if>
          <do_if value="{object.exists@this.Shipyard VdK}" exact="0">
            <create_station name="this.Shipyard VdK" group="CSV_toplevel.PlotStations" typename="SS_FAC_B_SHIP_BIG" race="boron">
              <position x="22000m" y="3000m" z="21000m"/>
              <sector sector="CSV_toplevel.CSV_VergeltungDerKoenigin"/>
              <equipment loadout="default"/>
            </create_station>
          </do_if>
          <do_if value="{object.exists@this.Shipyard VdK}" exact="0">
            <create_station name="this.Shipyard VdK" group="CSV_toplevel.PlotStations" typename="SS_FAC_B_SHIP_BIG" race="boron">
              <position x="22000m" y="3000m" z="21000m"/>
              <sector sector="CSV_toplevel.CSV_VergeltungDerKoenigin"/>
              <equipment loadout="default"/>
            </create_station>
          </do_if>
          <do_if value="{object.exists@this.CSV_NotarSY}" exact="0">
            <find_sector name="this.argonsector" race="argon" max="50" x="1" y="1"/>
            <do_if value="{sector.exists@this.argonsector}" exact="0">
              <find_sector name="this.argonsector" sector="{player.sector}"/>
            </do_if>
            <create_station name="this.CSV_NotarSY" group="CSV_toplevel.PlotStations" typename="SS_FAC_A_SHIP" race="argon">
              <position max="10km"/>
              <sector sector="this.argonsector"/>
              <equipment loadout="default"/>
            </create_station>
          </do_if>

          <set_group_invincible group="CSV_toplevel.PlotStations" invincible="1"/>

          <!--Create actors.-->
          <create_actor name="this.csvJeffMarxon" character="{3895,56}" race="argon" face="106" voice="110" object="this.MiliDock1" invincible="1"/>
          <create_actor name="this.csvBelisarius" character="{3895,57}" race="teladi" face="503" voiceflags="32" object="CSV_toplevel.MiliDock1" location="crew" invincible="1"/>
          <create_actor name="this.csvGagaWa" character="{3895,58}" race="boron" face="203" voice="203" invincible="1"/>
          <create_actor name="this.csvJensKa" character="{3895,59}" race="terran" face="1133" voice="110" invincible="1"/>
          <create_actor name="this.csvNolaHi" character="{3895,60}" race="boron" face="205" voice="205" invincible="1"/>
          <create_actor name="this.csvKetraar" character="{3895,61}" race="terran" face="1135" voice="111" invincible="1"/>
          <create_actor name="this.CSVNotaractor" character="{3895,64}" race="paranid" face="405" voice="410" location="crew" object="this.CSV_NotarSY" invincible="1"/>
          <create_actor name="this.csvMarteen" character="{3895,62}" race="argon" face="107" voice="111" invincible="1"/>
          <create_actor name="this.csvGero" character="{3895,63}" race="terran" face="1139" voice="110" invincible="1"/>
          <create_actor name="this.csvCAFE" character="{3895,65}"/>
          <create_actor name="this.csvEFAA" character="{3895,66}"/>
          <create_actor name="this.CSVBetty" voice="13"/>
          <create_actor name="this.CSVBetty2" voice="17"/>
          <create_actor name="this.CSVBetty3" voice="7"/>
          <set_value name="this.CSVchapter1link" exact="1"/>
        </do_all>
      </action>
	  <patch>
		<find_sector name="CSV_toplevel.CSV_playersector" x="22" y="5" comment="Player Sector"/>
	  </patch>
	  <cues>
        <cue name="CSV_cleanup" delay="30s">
          <condition>
            <check_value value="{value@CSV_toplevel.CSVComplet}" exact="1"/>
          </condition>
          <action>
            <do_all>
              <destroy_group group="CSV_toplevel.CPU Defenders" warp="1"/>
              <destroy_object object="CSV_NPC_Fleet_top.NPCfleetM1" warp="1"/>
              <destroy_group group="CSV_NPC_Fleet_top.NPCfleetgroup" warp="1"/>
              <destroy_group group="CSV_toplevel.CPU Player Attackers" warp="1"/>
              <destroy_actor actor="CSV_toplevel.csvJeffMarxon"/>
              <destroy_actor actor="CSV_toplevel.csvBelisarius"/>
              <destroy_actor actor="CSV_toplevel.csvGagaWa"/>
              <destroy_actor actor="CSV_toplevel.csvJensKa"/>
              <destroy_actor actor="CSV_toplevel.csvNolaHi"/>
              <destroy_actor actor="CSV_toplevel.csvKetraar"/>
              <destroy_actor actor="CSV_toplevel.CSVNotaractor"/>
              <destroy_actor actor="CSV_toplevel.csvMarteen"/>
              <destroy_actor actor="CSV_toplevel.csvGero"/>
              <destroy_actor actor="CSV_toplevel.csvCAFE"/>
              <destroy_actor actor="CSV_toplevel.csvEFAA"/>
              <destroy_actor actor="CSV_toplevel.CSVBetty"/>
              <destroy_actor actor="CSV_toplevel.CSVBetty2"/>
              <destroy_actor actor="CSV_toplevel.CSVBetty3"/>
              <set_group_invincible group="CSV_toplevel.PlotStations" invincible="0"/>
              <cancel_cue cue="CSV_toplevel"/>
              <cancel_cue cue="CSV_Chapter1"/>
              <cancel_cue cue="CSV_Chapter2"/>
              <cancel_cue cue="CSV_Chapter3"/>
              <cancel_cue cue="CSV_Chapter4"/>
              <cancel_cue cue="CSV_Chapter5"/>
              <cancel_cue cue="CSV_Chapter6"/>
              <cancel_cue cue="CSV_NPC_Fleet_top"/>
            </do_all>
          </action>
        </cue>
        <cue name="CSV_toplevel set station relations" delay="3s" instantiate="static">
          <condition>
            <check_any exact="{group.object.count@CSV_toplevel.PlotStations}" counter="count">
              <object_relation object="{group.object.{counter@count}@CSV_toplevel.PlotStations}">
                <relation relation="enemy"/>
              </object_relation>
            </check_any>
          </condition>
          <timing>
            <time exact="2s"/>
          </timing>
          <action>
            <set_group_relation group="CSV_toplevel.PlotStations">
              <relation relation="neutral"/>
            </set_group_relation>
          </action>
        </cue>
      </cues>
    </cue>
    <cue name="CSV_Chapter1" version="2">
      <documentation>
        <content reference="CSV_Chapter1" name="Chapter 1"/>
        <version number="1.0" date="03/08/2009" status="candidate"/>
        <history>
          <change author="Jens" date="08/12/2008" description="Initial version"/>
          <change author="Owen Lake" date="03/08/2009" description="2.5 Beta 2 version"/>
          <change author="Jens" date="06/08/2009" description="fixed: in stap 4 briefing and objective acton textid."/>
        </history>
      </documentation>
      <condition>
        <check_all>
          <object_changed_sector/>
          <check_value value="{value@CSV_toplevel.CSVchapter1link}" exact="1"/>
          <check_value value="{sector.jumps@CSV_toplevel.CSV_DannasChance}" min="2" max="6"/>
        </check_all>
      </condition>
      <timing>
        <time exact="8s"/>
      </timing>
      <action>
        <do_all>
          <do_choose>
            <do_when value="{object.exists@CSV_toplevel.CafeCPU}" exact="0">
              <create_ship name="CSV_toplevel.CafeCPU" typename="SS_SH_TERRAFORMER1" race="xenon" racelogic="0" invincible="1" textid="90801">
                <position x="-12km" y="-7km" z="-12km"/>
                <sector sector="CSV_toplevel.CSV_DannasChance"/>
                <equipment>
                  <ware typename="SS_WARE_TECH246" exact="10"/>
                  <ware typename="SS_WARE_TECH213" exact="10"/>
                  <ware typename="SS_SHIELD_F" exact="6"/>
                </equipment>
              </create_ship>
            </do_when>
            <do_otherwise>
              <set_invincible object="CSV_toplevel.CafeCPU" invincible="1"/>
            </do_otherwise>
          </do_choose>
          <do_all min="3" max="5">
            <create_ship group="CSV_toplevel.cafeprotectgroupM3" typename="SS_SH_TERRAFORMER2" capturable="0" race="xenon" dockobject="CSV_toplevel.CafeCPU" racelogic="0" textid="90811">
              <equipment loadout="maximum" loadoutmask="lasers|shields|missiles">
				  <ware typename="SS_LASER_EMP_1" exact="8"/>
			  </equipment>
            </create_ship>
          </do_all>
          <do_all min="5" max="7">
            <create_ship group="CSV_toplevel.cafeprotectgroupM4" typename="SS_SH_TERRAFORMER3" capturable="0" race="xenon" dockobject="CSV_toplevel.CafeCPU" racelogic="0" textid="90821">
              <equipment loadout="maximum" loadoutmask="lasers|shields|missiles">
				  <ware typename="SS_LASER_EMP_1" exact="6"/>
			  </equipment>
				  
            </create_ship>
          </do_all>
          <do_all min="7" max="10">
            <create_ship group="CSV_toplevel.cafeprotectgroupM5" typename="SS_SH_TERRAFORMER4" capturable="0" race="xenon" dockobject="CSV_toplevel.CafeCPU" racelogic="0" textid="90831">
				<equipment loadout="maximum" loadoutmask="lasers|shields|missiles">
    				  <ware typename="SS_LASER_EMP_1" exact="4"/>
				</equipment>
            </create_ship>
          </do_all>
          <do_all min="3" max="5">
            <create_ship group="CSV_toplevel.gateprotectgroupM3" typename="SS_SH_TERRAFORMER2" capturable="0" race="xenon" racelogic="0" textid="90811">
              <position object="CSV_toplevel.CafeCPU" min="6km" max="8km"/>
              <sector sector="{object.sector@CSV_toplevel.CafeCPU}"/>
				<equipment loadout="maximum" loadoutmask="lasers|shields|missiles">
    				  <ware typename="SS_LASER_EMP_1" exact="8"/>
				</equipment>				  
              <command command="killenemiesrange" distance="4km" commandobject="CSV_toplevel.DC GateS"/>
            </create_ship>
          </do_all>
          <do_all min="5" max="7">
            <create_ship group="CSV_toplevel.gateprotectgroupM4" typename="SS_SH_TERRAFORMER3" capturable="0" race="xenon" racelogic="0" textid="90821">
              <position object="CSV_toplevel.CafeCPU" min="6km" max="8km"/>
              <sector sector="{object.sector@CSV_toplevel.CafeCPU}"/>
				<equipment loadout="maximum" loadoutmask="lasers|shields|missiles">
    				  <ware typename="SS_LASER_EMP_1" exact="6"/>
				</equipment>
              <command command="killenemiesrange" distance="4km" commandobject="CSV_toplevel.DC GateS"/>
            </create_ship>
          </do_all>
          <do_all min="7" max="10">
            <create_ship group="CSV_toplevel.gateprotectgroupM5" typename="SS_SH_TERRAFORMER4" capturable="0" race="xenon" racelogic="0" textid="90831">
              <position object="CSV_toplevel.CafeCPU" min="6km" max="8km"/>
              <sector sector="{object.sector@CSV_toplevel.CafeCPU}"/>
				<equipment loadout="maximum" loadoutmask="lasers|shields|missiles">
    				  <ware typename="SS_LASER_EMP_1" exact="4"/>
				</equipment>
              <command command="killenemiesrange" distance="4km" commandobject="CSV_toplevel.DC GateS"/>
            </create_ship>
          </do_all>
          <ask_question name="CSV Chapter1" author="{actor.name@CSV_toplevel.csvJeffMarxon}" text="{3895,560001}"/>
        </do_all>
      </action>
      <cues>
        <cue ref="CSV CPU Defence"/>
        <cue ref="CSV_NPC_Fleet_top"/>
        <cue ref="CSV_CPU_DFP_top"/>
        <cue name="CSV_Chapter1_Accapted No">
          <condition>
            <question_answered question="CSV Chapter1" answer="no"/>
          </condition>
          <action>
            <do_all>
              <set_command object="CSV_toplevel.CafeCPU" command="moveposition">
                <position x="-50km" y="-7km" z="-50km"/>
                <sector sector="CSV_toplevel.CSV_DannasChance"/>
              </set_command>
              <cancel_cue cue="CSV_Chapter1_Accapted"/>
              <cancel_cue cue="CSV_Chapter2"/>
              <cancel_cue cue="CSV_Chapter3"/>
              <cancel_cue cue="CSV_Chapter4"/>
              <cancel_cue cue="CSV_Chapter5"/>
              <cancel_cue cue="CSV_Chapter6"/>
              <cancel_cue cue="CSV CPU Defence"/>
              <cancel_cue cue="CSV_CPU_DFP_top"/>
              <cancel_cue cue="CSV_NPC_Fleet_top"/>
              <do_if value="{player.licence.argon}" exact="1">
                <add_cargo>
                  <ware typename="SS_WARE_L_A" exact="-1"/>
                </add_cargo>
              </do_if>
              <do_choose>
                <do_when value="{player.notoriety.argon}" min="333333">
                  <reward_player>
                    <notoriety>
                      <relation race="argon" exact="-({player.notoriety.argon}/100*30)"/>
                    </notoriety>
                  </reward_player>
                </do_when>
                <do_when value="{player.notoriety.argon}" min="100000" max="333332">
                  <reward_player>
                    <notoriety>
                      <relation race="argon" exact="-({player.notoriety.argon}/100*25)"/>
                    </notoriety>
                  </reward_player>
                </do_when>
                <do_when value="{player.notoriety.argon}" min="33333" max="99999">
                  <reward_player>
                    <notoriety>
                      <relation race="argon" exact="-({player.notoriety.argon}/100*20)"/>
                    </notoriety>
                  </reward_player>
                </do_when>
                <do_when value="{player.notoriety.argon}" min="10000" max="33332">
                  <reward_player>
                    <notoriety>
                      <relation race="argon" exact="-({player.notoriety.argon}/100*15)"/>
                    </notoriety>
                  </reward_player>
                </do_when>
                <do_otherwise>
                  <reward_player>
                    <notoriety>
                      <relation race="argon" exact="-({player.notoriety.argon}/100*10)"/>
                    </notoriety>
                  </reward_player>
                </do_otherwise>
              </do_choose>
            </do_all>
          </action>
          <cues>
            <cue name="CSV_Chapter1_Accapted No weit">
              <condition>
                <cue_is_complete cue="CSV_Chapter1_Accapted No"/>
              </condition>
              <timing>
                <time min="30m"/>
              </timing>
              <action>
                <do_all>
                  <destroy_actor actor="CSV_toplevel.csvJeffMarxon"/>
                  <destroy_actor actor="CSV_toplevel.csvBelisarius"/>
                  <destroy_actor actor="CSV_toplevel.csvGagaWa"/>
                  <destroy_actor actor="CSV_toplevel.csvJensKa"/>
                  <destroy_actor actor="CSV_toplevel.csvNolaHi"/>
                  <destroy_actor actor="CSV_toplevel.csvKetraar"/>
                  <destroy_actor actor="CSV_toplevel.CSVNotaractor"/>
                  <destroy_actor actor="CSV_toplevel.csvMarteen"/>
                  <destroy_actor actor="CSV_toplevel.csvGero"/>
                  <destroy_actor actor="CSV_toplevel.csvCAFE"/>
                  <destroy_actor actor="CSV_toplevel.csvEFAA"/>
                  <destroy_actor actor="CSV_toplevel.CSVBetty"/>
                  <destroy_actor actor="CSV_toplevel.CSVBetty2"/>
                  <destroy_actor actor="CSV_toplevel.CSVBetty3"/>
                  <destroy_object object="CSV_toplevel.CafeCPU"/>
                  <destroy_object object="CSV_NPC_Fleet_top.NPCfleetM1" warp="1"/>
                  <destroy_group group="CSV_NPC_Fleet_top.NPCfleetgroup" warp="1"/>
                  <destroy_group group="CSV_toplevel.cafeprotectgroupM3" warp="1"/>
                  <destroy_group group="CSV_toplevel.cafeprotectgroupM4" warp="1"/>
                  <destroy_group group="CSV_toplevel.cafeprotectgroupM5" warp="1"/>
                  <destroy_group group="CSV_toplevel.gateprotectgroupM3" warp="1"/>
                  <destroy_group group="CSV_toplevel.gateprotectgroupM4" warp="1"/>
                  <destroy_group group="CSV_toplevel.gateprotectgroupM5" warp="1"/>
                  <reset_cue cue="CSV_toplevel"/>
                  <reset_cue cue="CSV_Chapter1"/>
                  <reset_cue cue="CSV_Chapter2"/>
                  <reset_cue cue="CSV_Chapter3"/>
                  <reset_cue cue="CSV_Chapter4"/>
                  <reset_cue cue="CSV_Chapter5"/>
                  <reset_cue cue="CSV_Chapter6"/>
                  <reset_cue cue="CSV_Chapter7"/>
                </do_all>
              </action>
            </cue>
          </cues>
        </cue>
        <cue name="CSV_Chapter1_Accapted">
          <condition>
            <question_answered question="CSV Chapter1" answer="yes"/>
          </condition>
          <action>
            <do_all>
              <cancel_cue cue="CSV_Chapter1_Accapted No"/>
              <incoming_message author="{actor.name@CSV_toplevel.csvJeffMarxon}" text="{3895,560002}"/>
              <create_briefing cue="CSV_Chapter1_Accapted" title="{3212,20100}" text="{3212,20101}" background="CSV_C6S4_DannasChance2.tga">
                <mission discipline="XXXT" level="easy"/>
                <objectives>
                  <objective step="1">
                    <flyto>
                      <sector sector="CSV_toplevel.CSV_DannasChance"/>
                    </flyto>
                  </objective>
                </objectives>
              </create_briefing>
              <set_objective cue="CSV_Chapter1_Accapted" story="{3200,12}" title="{3212,20100}" noabort="1">
                <briefing cue="CSV_Chapter1_Accapted" step="1"/>
                <mission discipline="XXXT" level="easy"/>
                <flyto>
                  <sector sector="CSV_toplevel.CSV_DannasChance"/>
                </flyto>
              </set_objective>
            </do_all>
          </action>
          <cues>
            <cue name="CSV_Chapter1_inSektorDC" delay="2s">
              <condition>
                <check_value value="{player.sector}" exact="{sector@CSV_toplevel.CSV_DannasChance}"/>
              </condition>
              <action>
                <do_all>
                  <set_group_command group="CSV_toplevel.cafeprotectgroupM3" command="dock" commandobject="CSV_toplevel.CafeCPU"/>
                  <set_group_command group="CSV_toplevel.cafeprotectgroupM4" command="dock" commandobject="CSV_toplevel.CafeCPU"/>
                  <set_group_command group="CSV_toplevel.cafeprotectgroupM5" command="dock" commandobject="CSV_toplevel.CafeCPU"/>
                  <set_group_command group="CSV_toplevel.gateprotectgroupM3" command="killenemiesrange" distance="10km">
                    <position object="CSV_toplevel.DC GateS"/>
                  </set_group_command>
                  <set_group_command group="CSV_toplevel.gateprotectgroupM4" command="killenemiesrange" distance="10km">
                    <position object="CSV_toplevel.DC GateS"/>
                  </set_group_command>
                  <set_group_command group="CSV_toplevel.gateprotectgroupM5" command="killenemiesrange" distance="10km">
                    <position object="CSV_toplevel.DC GateS"/>
                  </set_group_command>
                </do_all>
              </action>
              <cues>
                <cue name="CSV_Chapter1_CSV Plot C1">
                  <condition>
                    <check_all>
                      <cue_is_complete cue="CSV_Chapter1_inSektorDC"/>
                      <check_value value="{player.sector}" exact="{sector@CSV_toplevel.CSV_DannasChance}"/>
                    </check_all>
                  </condition>
                  <timing>
                    <time exact="5s"/>
                  </timing>
                  <action>
                    <do_if value="{player.sector}" exact="{sector@CSV_toplevel.CSV_DannasChance}">
                      <play_cutscene file="CSV Plot C1">
                        <object name="Cafe" object="{object@CSV_toplevel.CafeCPU}"/>
                      </play_cutscene>
                    </do_if>
                  </action>
                  <cues>
                    <cue name="CSV_Chapter1_Kill">
                      <condition>
						  <check_all>
                            <cutscene_stopped cue="CSV_Chapter1_CSV Plot C1" key="CSV Plot C1"/>
					        <!--<check_distance value="{object.distance@CSV_toplevel.CafeCPU}" max="5km"/>-->
					    </check_all>
                      </condition>
                      <timing>
                        <time exact="5s"/>
                      </timing>
                      <action>
                        <do_all>
                          <create_briefing cue="CSV_Chapter1_Accapted" title="{3212,20100}" text="{3212,20101}" background="CSV_C6S4_DannasChance2.tga">
                            <mission discipline="XXXT" level="hard"/>
                            <objectives>
                              <objective step="2">
                                <custom action="{35,2024}" text="{1000,106} {35,2110}"/>
                              </objective>
                            </objectives>
                          </create_briefing>
                          <set_objective cue="CSV_Chapter1_Accapted" story="{3200,12}" title="{3212,20100}" noabort="1">
                            <briefing cue="CSV_Chapter1_Accapted" step="2"/>
                            <mission discipline="XXXT" level="hard"/>
                            <custom action="{35,2024}" text="{1000,106} {35,2110}"/>
                          </set_objective>
                          <set_command command="stay" object="CSV_toplevel.CafeCPU"/>
                        </do_all>
                      </action>
                      <cues>
						  <cue name="CSV_Chapter1_flytoCPU" delay="5s">
							  <condition>
					            <check_distance value="{object.distance@CSV_toplevel.CafeCPU}" max="7km"/>
							  </condition>
							  <action>
								  <do_all>
                                    <set_command command="none" object="CSV_toplevel.CafeCPU"/>
                                    <warp_object object="CSV_toplevel.CafeCPU">
                                        <position x="0km" y="5km" z="18km"/>
                                        <sector sector="CSV_toplevel.CSV_WegZuFreiheit"/>
                                    </warp_object>
                                    <set_command command="stay" object="CSV_toplevel.CafeCPU"/>
							    </do_all>
							  </action>
						  </cue>
                        <cue name="CSV_Chapter1_jumpWzF" delay="2s">
                          <condition>
                            <check_all>
                              <cue_is_complete cue="CSV_Chapter1_Kill"/>
                              <cue_is_complete cue="CSV_Chapter1_flytoCPU"/>
                              <object_sector object="CSV_toplevel.CafeCPU" exact="0">
                                <sector sector="CSV_toplevel.CSV_WegZuFreiheit"/>
                              </object_sector>
                            </check_all>
                          </condition>
                          <timing>
                            <time min="10s" max="20s"/>
                          </timing>
                          <action>
                            <do_all>
                              <set_command object="CSV_NPC_Fleet_top.NPCfleetM1" command="killenemies"/>
                              <remove_objective cue="CSV_Chapter1_Accapted" comment="Removes the guidance"/>
                              <incoming_message author="{actor.name@CSV_toplevel.csvJeffMarxon}" text="{3895,560003}"/>
                              <create_briefing cue="CSV_Chapter1_Accapted" title="{3212,20100}" text="{3212,20101}" background="CSV_C6S4_DannasChance2.tga">
                                <mission discipline="XXXT" level="average"/>
                                <objectives>
                                  <objective step="1">
                                    <flyto>
                                      <sector sector="CSV_toplevel.CSV_DannasChance"/>
                                    </flyto>
                                  </objective>
                                  <objective step="2">
                                    <custom action="{35,2024}" text="{1000,106} {35,2110}" comment="Investigate: Xenon Ships"/>
                                  </objective>
                                  <objective step="3">
                                    <custom action="{35,2030}" text="{3212,10210}" comment="Obtain: TM Class Ship with a Fighter docked"/>
                                  </objective>
                                </objectives>
                              </create_briefing>
                              <set_objective cue="CSV_Chapter1_Accapted" story="{3200,12}" title="{3212,20100}" noabort="1">
                                <briefing cue="CSV_Chapter1_Accapted" step="3"/>
                                <mission discipline="XXXT" level="average"/>
                                <custom action="{35,2030}" text="{1263,19315} {35,611} {35,721}"/>
                              </set_objective>
                            </do_all>
                          </action>
                          <cues>
                            <cue name="CSV_Chapter1_CheckTM" delay="5s">
                              <condition>
                                <check_all>
                                  <cue_is_complete cue="CSV_Chapter1_jumpWzF"/>
                                  <match_object class="tm"/>
                                  <check_value value="{player.ship.dockedships.count}" min="1"/>
                                </check_all>
                              </condition>
                              <action>
                                <do_all>
                                  <create_briefing cue="CSV_Chapter1_Accapted" title="{3212,20100}" text="{3212,20101}" background="CSV_C1S4_WegZurFreiheit.tga">
                                    <mission discipline="XXXT" level="average"/>
                                    <objectives>
                                      <objective step="4">
                                        <custom action="{35,2174}" text="{sector.name@CSV_toplevel.CSV_WegZuFreiheit}" comment="Jump To:">
                                          <sector sector="CSV_toplevel.CSV_WegZuFreiheit"/>
                                        </custom>
                                      </objective>
                                    </objectives>
                                  </create_briefing>
                                  <set_objective cue="CSV_Chapter1_Accapted" story="{3200,12}" title="{3212,20100}" noabort="1">
                                    <briefing cue="CSV_Chapter1_Accapted" step="4"/>
                                    <mission discipline="XXXT" level="average"/>
                                    <custom action="{35,2174}" text="{sector.name@CSV_toplevel.CSV_WegZuFreiheit}">
                                      <sector sector="CSV_toplevel.CSV_WegZuFreiheit"/>
                                    </custom>
                                  </set_objective>
                                  <set_value name="this.jumpcounter" min="3" max="6"/>
                                </do_all>
                              </action>
                              <cues>
                                <cue name="CSV_Chapter1_Checkjump">
                                  <condition>
                                    <check_all>
                                      <cue_is_complete cue="CSV_Chapter1_CheckTM"/>
                                      <object_sector exact="0">
                                        <sector sector="CSV_toplevel.CSV_UFJD Sektoren1"/>
                                      </object_sector>
                                    </check_all>
                                  </condition>
                                  <action>
                                    <set_value name="CSV_Chapter1_CheckTM.jumpcounter" exact="{value@CSV_Chapter1_CheckTM.jumpcounter}-1"/>
                                  </action>
                                  <cues>
                                    <cue name="CSV_Chapter1_Checkjump_reset">
                                      <condition>
                                        <object_changed_sector/>
                                      </condition>
                                      <timing>
                                        <time exact="1s"/>
                                      </timing>
                                      <action>
                                        <do_if value="{value@CSV_Chapter1_CheckTM.jumpcounter}" min="1">
                                          <do_choose>
                                            <do_when value="{player.sector}" exact="{sector@CSV_toplevel.CSV_WegZuFreiheit}">
                                              <set_value name="CSV_Chapter1_CheckTM.jumpcounter" exact="0"/>
                                            </do_when>
                                            <do_otherwise>
                                              <reset_cue cue="CSV_Chapter1_Checkjump"/>
                                            </do_otherwise>
                                          </do_choose>
                                        </do_if>
                                      </action>
                                    </cue>
                                  </cues>
                                </cue>
                                <cue name="CSV_Chapter1_jump to WzF">
                                  <condition>
                                    <check_all>
                                      <cue_is_complete cue="CSV_Chapter1_CheckTM"/>
                                      <check_value value="{value@CSV_Chapter1_CheckTM.jumpcounter}" max="0"/>
                                    </check_all>
                                  </condition>
                                  <action>
                                    <do_all>
                                      <do_if value="{player.sector}" exact="{sector@CSV_toplevel.CSV_WegZuFreiheit}" negate="1">
                                        <warp_player>
                                          <position x="0km" y="-100km" z="0km"/>
                                          <sector sector="CSV_toplevel.CSV_WegZuFreiheit"/>
                                        </warp_player>
                                        <play_text priority="99">
                                          <line actor="CSV_toplevel.CSVBetty" pageid="13" textid="1385" comment="enetering system"/>
                                          <line actor="CSV_toplevel.CSVBetty3" pageid="7" textid="1020805" comment="Weg zur Freiheit"/>
                                        </play_text>
                                      </do_if>
                                      <remove_briefing cue="CSV_Chapter1_Accapted"/>
                                      <remove_objective cue="CSV_Chapter1_Accapted"/>
                                      <set_value name="CSV_toplevel.CSVchapter2link" exact="1"/>
                                    </do_all>
                                  </action>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>
          </cues>
        </cue>
      </cues>
    </cue>
    <cue name="CSV_Chapter2" delay="2002" version="2">
      <documentation>
        <content reference="CSV_Chapter2" name="Chapter 2"/>
        <version number="1.0" date="30/08/2009" status="candidate"/>
        <history>
          <change author="Ketraar" date="20/12/2008" description="Initial version"/>
          <change author="Owen Lake" date="03/08/2009" description="2.5 Beta 2 version"/>
          <change author="Owen Lake" date="30/08/2009" description="2.5 RC 2 version"/>
        </history>
      </documentation>
      <condition>
        <check_all>
          <cue_is_complete cue="CSV_toplevel"/>
          <check_value value="{value@CSV_toplevel.CSVchapter2link}" exact="1"/>
        </check_all>
      </condition>
      <cues>
        <cue name="CSV_Chapter2_warp" delay="2004">
          <condition>
            <check_all>
              <object_sector exact="0">
                <sector sector="CSV_toplevel.CSV_WegZuFreiheit"/>
              </object_sector>
            </check_all>
          </condition>
          <timing>
            <time exact="500"/>
          </timing>
          <action>
            <do_all>
              <set_value name="CSV_Chapter2_warp.CSVpeoplestillinHSamount" exact="94"/>
              <set_value name="CSV_Chapter2_warp.Chickencheckset" exact="0"/>
            </do_all>
          </action>
        </cue>
        <cue name="CSV_Chapter2_Wareshandling" instantiate="static" delay="5s">
          <condition>
            <check_all>
              <cue_is_complete cue="CSV_Chapter2_warp"/>
              <object_is_docked dockobject="CSV_toplevel.HsWzF" negate="1"/>
              <check_any>
                <check_value value="{object.tradables.SS_WARE_ENERGY.exists@CSV_toplevel.HsWzF}" exact="0"/>
                <check_value value="{object.tradables.SS_WARE_ENERGY.count@CSV_toplevel.HsWzF}" max="19"/>
              </check_any>
            </check_all>
          </condition>
          <action>
            <do_all>
              <do_if value="{object.tradables.SS_WARE_WARPING.exists@CSV_toplevel.HsWzF}" exact="0">
                <add_tradables object="CSV_toplevel.HsWzF">
                  <ware exact="1" typename="SS_WARE_WARPING"/>
                </add_tradables>
              </do_if>
              <add_tradables object="CSV_toplevel.HsWzF">
                <ware exact="40" typename="SS_WARE_ENERGY"/>
              </add_tradables>
            </do_all>
          </action>
        </cue>
        <cue name="CSV_Chapter2_top_NoTM" delay="5s">
          <condition>
            <check_all>
              <check_value value="{player.sector}" exact="{sector@CSV_toplevel.CSV_WegZuFreiheit}"/>
              <match_object class="tm" negate="1"/>
              <match_object class="ts" negate="1"/>
              <match_object class="tp" negate="1"/>
              <count_ships class="tm" race="player" includedocked="1" exact="0"/>
              <count_ships class="ts" race="player" includedocked="1" exact="0"/>
              <count_ships class="tp" race="player" includedocked="1" exact="0"/>
            </check_all>
          </condition>
          <timing>
            <time exact="6s"/>
          </timing>
          <action>
            <do_all>
              <set_value name="CSV_toplevel.CSVchapter2link" exact="0"/>
              <incoming_message author="{actor.name@CSV_toplevel.csvJeffMarxon}" text="{3895,560009}"/>
              <reset_cue cue="CSV_Chapter1_jumpWzF"/>
              <reset_cue cue="CSV_Chapter2"/>
            </do_all>
          </action>
        </cue>
        <cue name="CSV_Chapter2_TM_killed" delay="836">
          <condition>
            <check_all>
              <cue_is_complete cue="CSV_Chapter2_top"/>
              <object_exists object="CSV_Chapter2_top.CSVplayerTM" negate="1"/>
            </check_all>
          </condition>
          <timing>
            <time exact="1s"/>
          </timing>
          <action>
            <do_choose>
              <do_when value="{value@CSV_Chapter2_warp.CSVpeoplestillinHSamount}" min="1">
                <do_choose>
                  <do_when value="{player.ship.cargo.SS_WARE_WARPING.count}" min="1">
                    <incoming_message author="{actor.name@CSV_toplevel.csvJeffMarxon}" text="{3895,570010}"/>
                    <remove_briefing cue="CSV_Chapter2_top"/>
                    <remove_objective cue="CSV_Chapter2_top"/>
                    <cancel_cue cue="CSV_Chapter2_top"/>
                  </do_when>
                  <do_otherwise>
                    <incoming_message author="{actor.name@CSV_toplevel.csvJeffMarxon}" text="{3895,570011}"/>
                    <remove_briefing cue="CSV_Chapter2_top"/>
                    <remove_objective cue="CSV_Chapter2_top"/>
                    <cancel_cue cue="CSV_Chapter2_top"/>
                    <create_briefing cue="CSV_Chapter2_TM_killed" title="{3212,20200}" text="{3212,20201}" background="CSV_C6S6_MA_EG2.tga">
                      <mission discipline="TXXX" level="easy"/>
                      <objectives>
                        <objective step="1">
                          <custom action="{35,2002}" text="{lookup.type.name@SS_WARE_WARPING}" object="CSV_toplevel.HsWzF"/>
                        </objective>
                      </objectives>
                    </create_briefing>
                    <set_objective cue="CSV_Chapter2_TM_killed" story="{3200,12}" title="{3212,20200}" noabort="1">
                      <briefing cue="CSV_Chapter2_top" step="1"/>
                      <mission discipline="TXXX" level="easy"/>
                      <custom action="{35,2002}" text="{lookup.type.name@SS_WARE_WARPING}" object="CSV_toplevel.HsWzF"/>
                    </set_objective>
                  </do_otherwise>
                </do_choose>
              </do_when>
              <do_otherwise>
                <incoming_message author="{actor.name@CSV_toplevel.csvJeffMarxon}" text="{3895,570016}"/>
                <remove_briefing cue="CSV_Chapter2_top"/>
                <remove_objective cue="CSV_Chapter2_top"/>
                <reward_player>
                  <notoriety>
                    <relation operation="set" exact="noto0" race="argon"/>
                  </notoriety>
                </reward_player>
                <complete_cue cue="CSV_Chapter2_atMiliDockEF"/>
              </do_otherwise>
            </do_choose>
          </action>
        </cue>
        <cue name="CSV_Chapter2_chickencheck" delay="1s">
          <condition>
            <check_all>
              <check_value value="{player.sector}" list="{sector@CSV_toplevel.CSV_WegZuFreiheit}|{sector@CSV_toplevel.CSV_UFJD Sektoren1}" negate="1"/>
              <check_any>
                <check_value value="{value@CSV_Chapter2_warp.Chickencheckset}" min="1"/>
                <check_value value="{value@CSV_Chapter2_warp.CSVpeoplestillinHSamount}" min="1"/>
              </check_any>
            </check_all>
          </condition>
          <timing>
            <time exact="10s"/>
          </timing>
          <action>
            <do_all>
              <remove_briefing cue="CSV_Chapter2_top"/>
              <remove_objective cue="CSV_Chapter2_top"/>
              <set_value name="CSV_toplevel.CSVchapter2link" exact="0"/>
              <reset_cue cue="CSV_Chapter2"/>
              <!--<reset_cue cue="CSV_Chapter1_jumpWzF"/>
              <reset_cue cue="CSV_Chapter2_TM_killed"/>
              <reset_cue cue="CSV_Chapter2_chickencheck"/>-->
            </do_all>
          </action>
        </cue>
        <cue name="CSV_Chapter2_top" delay="1s">
          <condition>
            <check_all>
              <cue_is_complete cue="CSV_Chapter2_warp"/>
              <check_value value="{player.sector}" exact="{sector@CSV_toplevel.CSV_WegZuFreiheit}"/>
              <check_any>
                <match_object class="tm"/>
                <match_object class="tp"/>
                <match_object class="ts"/>
              </check_any>
            </check_all>
          </condition>
          <timing>
            <time exact="6s"/>
          </timing>
          <action>
            <do_all>
              <cancel_cue cue="CSV_Chapter2_top_NoTM"/>
              <do_if value="{player.ship.isclass.tm}+{player.ship.isclass.ts}+{player.ship.isclass.tp}" min="1">
                <incoming_message author="{actor.name@CSV_toplevel.csvCAFE}" text="{3895,650001}"/>
                <set_object name="this.CSVplayerTM" value="{player.ship}"/>
				  <set_group_relation group="CSV_toplevel.cafeprotectgroupM3">
					  <relation object="CSV_toplevel.HsWzF" relation="enemy" mutual="1"/>
					  <relation object="{player.ship}" relation="enemy" mutual="1"/>
				  </set_group_relation>
                <set_group_command group="CSV_toplevel.cafeprotectgroupM3" command="attack" commandobject="CSV_toplevel.HsWzF"/>
                <set_group_command group="CSV_toplevel.cafeprotectgroupM4" command="attack" commandobject="CSV_toplevel.HsWzF"/>
                <set_group_command group="CSV_toplevel.cafeprotectgroupM5" command="attack" commandobject="CSV_toplevel.HsWzF"/>
                <create_briefing cue="CSV_Chapter2_top" title="{3212,20200}" text="{3212,20201}" background="CSV_C1S4_WegZurFreiheit.tga">
                  <mission discipline="XFXX" level="average"/>
                  <objectives>
                    <objective step="1">
                      <protect object="CSV_toplevel.HsWzF"/>
                    </objective>
                  </objectives>
                </create_briefing>
                <set_objective cue="CSV_Chapter2_top" story="{3200,12}" title="{3212,20200}" noabort="1">
                  <briefing cue="CSV_Chapter2_top" step="1"/>
                  <mission discipline="XFXX" level="average"/>
                  <protect object="CSV_toplevel.HsWzF"/>
                </set_objective>
                <set_value name="this.CSVtotalShipsamount" exact="3"/>
                <set_value name="this.CSVpeoplestillinHScheck" exact="{value@CSV_Chapter2_warp.CSVpeoplestillinHSamount}"/>
                <set_value name="this.CSVWzFKillcount" exact="0"/>
                <set_value name="this.CSVWzFKillcountreached" exact="0"/>
                <set_value name="this.CSVpassengersloadedcheck" exact="0"/>
              </do_if>
            </do_all>
          </action>
          <cues>
            <cue name="CSV_Chapter2_TM_No_Energy" delay="845" instantiate="static">
              <condition>
                <check_all>
                  <object_is_docked dockobject="CSV_toplevel.HsWzF"/>
                  <check_value value="{player.ship.cargo.SS_WARE_ENERGY.count}" max="{value@CSV_toplevel.NeededEnergyForJump}-1"/>
                  <check_value value="{player.ship.cargospace}" min="{value@CSV_toplevel.NeededEnergyForJump}"/>
                  <check_value value="{player.age}" min="{value@CSV_toplevel.C2_Energy_Transfer_Time}+60"/>
                </check_all>
              </condition>
              <action>
                <do_all>
                  <remove_briefing cue="CSV_Chapter2_TM_killed"/>
                  <remove_objective cue="CSV_Chapter2_TM_killed"/>
                  <add_cargo>
                    <ware exact="{value@CSV_toplevel.NeededEnergyForJump}" typename="SS_WARE_ENERGY"/>
                  </add_cargo>
                  <incoming_message author="{actor.name@CSV_toplevel.csvBelisarius}" text="{3895,570013}"/>
                  <set_value name="CSV_toplevel.C2_Energy_Transfer_Time" exact="{player.age}"/>
                  <reset_cue cue="CSV_Chapter2_TM_No_Energy_No_Space"/>
                </do_all>
              </action>
            </cue>
            <cue name="CSV_Chapter2_TM_No_Energy_No_Space" delay="818">
              <condition>
                <check_all>
                  <object_is_docked dockobject="CSV_toplevel.HsWzF"/>
                  <check_value value="{player.ship.cargo.SS_WARE_ENERGY.count}" max="{value@CSV_toplevel.NeededEnergyForJump}-1"/>
                  <check_value value="{player.ship.cargospace}" max="{value@CSV_toplevel.NeededEnergyForJump}-1"/>
                  <check_value value="{player.age}" min="{value@CSV_toplevel.C2_Energy_Transfer_Time}+60"/>
                </check_all>
              </condition>
              <action>
                <incoming_message author="{actor.name@CSV_toplevel.csvBelisarius}" text="{3895,570014}"/>
              </action>
            </cue>
            <cue name="CSV_Chapter2_top completed">
              <condition>
                <cue_completed cue="CSV_Chapter2_top"/>
              </condition>
              <cues>
                <cue name="CSV_Chapter2_killcount" instantiate="static">
                  <condition>
                    <check_any>
                      <any_object_destroyed_by_player group="CSV_toplevel.cafeprotectgroupM3"/>
                      <any_object_destroyed_by_player group="CSV_toplevel.cafeprotectgroupM4"/>
                      <any_object_destroyed_by_player group="CSV_toplevel.cafeprotectgroupM5"/>
                      <any_object_destroyed group="CSV_toplevel.cafeprotectgroupM3"/>
                      <any_object_destroyed group="CSV_toplevel.cafeprotectgroupM4"/>
                      <any_object_destroyed group="CSV_toplevel.cafeprotectgroupM5"/>
                    </check_any>
                  </condition>
                  <action>
					  <do_all>
                    <do_if value="{object.race@{event.param2}}" exact="{lookup.race@player}">
                      <set_value name="CSV_Chapter2_top.CSVWzFKillcount" operation="add"/>
                    </do_if>
					  </do_all>
                  </action>
                </cue>
                <cue name="CSV_Chapter2_CSVWzFKillcount_reached" delay="2s">
                  <condition>
                    <check_value value="{value@CSV_Chapter2_top.CSVWzFKillcount}" min="{value@CSV_Chapter2_top.CSVtotalShipsamount}"/>
                  </condition>
                  <action>
                    <do_all>
                      <create_briefing cue="CSV_Chapter2_top" title="{3212,20200}" text="{3212,20201}" background="CSV_C1S4_WegZurFreiheit.tga">
                        <mission discipline="XXXT" level="easy"/>
                        <objectives>
                          <objective step="2">
                            <custom action="{3212,10209}" object="CSV_toplevel.HsWzF" text="{object.name@CSV_toplevel.HsWzF}" icon="dockat"/>
                          </objective>
                        </objectives>
                      </create_briefing>
                      <set_objective cue="CSV_Chapter2_top" story="{3200,12}" title="{3212,20200}" noabort="1">
                        <briefing cue="CSV_Chapter2_top" step="2"/>
                        <mission discipline="XXXT" level="easy"/>
                        <custom action="{3212,10209}" object="CSV_toplevel.HsWzF" text="{object.name@CSV_toplevel.HsWzF}" icon="dockat"/>
                      </set_objective>
                    </do_all>
                  </action>
                  <cues>
					  <cue name="CSV_Chapter2_StationEnemy">
						  <condition>
                            <object_relation object="CSV_toplevel.HsWzF">
                                <relation relation="enemy"/>
                             </object_relation>
						  </condition>
						  <action>
							  <do_all>
                              <set_relation object="CSV_toplevel.HsWzF">
                                <relation object="{player.ship}" relation="neutral" mutual="0"/>
                              </set_relation>
						        <reset_cue cue="CSV_Chapter2_StationEnemy"/>
						  </do_all>
						  </action>
					  </cue>
                    <cue name="CSV_Chapter2_TMdockedatHS" delay="3s" version="2">
                      <condition>
                        <object_docked object="CSV_Chapter2_top.CSVplayerTM" param="{object@CSV_toplevel.HsWzF}"/>
                      </condition>
                      <timing>
                        <time exact="6s"/>
                      </timing>
                      <action>
                        <do_all>
                          <set_value name="this.CSVWzFcargoscheck" exact="({lookup.type.cargospace@SS_WARE_PASSENGER}*{value@CSV_Chapter2_warp.CSVpeoplestillinHSamount})"/>
                          <set_value name="CSV_Chapter2_TMdockedatHS.LScheck" exact="0"/>
                          
                          <set_value name="this.CargoCheckFailed" exact="0"/>
                          <do_if value="{object.cargospace@CSV_Chapter2_top.CSVplayerTM}" max="{value@this.CSVWzFcargoscheck}-1">
                            <set_value name="this.CargoCheckFailed" exact="1"/>
                          </do_if>
                          <do_if value="{object.cargoclass@CSV_Chapter2_top.CSVplayerTM}" max="{lookup.type.cargoclass@SS_WARE_PASSENGER}-1">
                            <set_value name="this.CargoCheckFailed" exact="1"/>
                          </do_if>
                          <do_choose>
                            <do_when value="{value@this.CargoCheckFailed}" exact="0">
                              <do_choose>
                                <do_when value="{object.equipment.SS_WARE_LIFESUPPORT.exists@CSV_Chapter2_top.CSVplayerTM}+{object.isclass.tp@CSV_Chapter2_top.CSVplayerTM}" min="1">
                                  <incoming_message author="{actor.name@CSV_toplevel.csvBelisarius}" text="{3895,570001}"/>
                                  <cancel_cue cue="CSV_Chapter2_TMdockedatHS_CS"/>
                                  <cancel_cue cue="CSV_Chapter2_TMdockedatHS_LS_ask"/>
                                  <add_cargo object="CSV_Chapter2_top.CSVplayerTM">
                                    <ware exact="{value@CSV_Chapter2_warp.CSVpeoplestillinHSamount}-3" typename="SS_WARE_PASSENGER"/>
                                  </add_cargo>
                                  <set_value name="CSV_Chapter2_warp.CSVpeoplestillinHSamount" exact="0"/>
                                  <set_value name="CSV_Chapter2_top.CSVpassengersloadedcheck" exact="1"/>
                                </do_when>
                                <do_otherwise>
                                  <set_value name="CSV_Chapter2_TMdockedatHS.LScheck" exact="1"/>
                                </do_otherwise>
                              </do_choose>
                            </do_when>
                            <do_otherwise>
                              <incoming_message author="{actor.name@CSV_toplevel.csvBelisarius}" text="{3895,570002}"/>
								<reset_cue cue="CSV_Chapter2_TMdockedatHS"/>
                            </do_otherwise>
                          </do_choose>
                        </do_all>
                      </action>
                      <cues>
                        <cue name="CSV_Chapter2_TMdockedatHS_LS_ask" delay="875">
                          <condition>
                            <check_value value="{value@CSV_Chapter2_TMdockedatHS.LScheck}" exact="1"/>
                          </condition>
                          <timing>
                            <time exact="2s"/>
                          </timing>
                          <action>
                            <ask_question name="CSVWzFLifesupport" author="{actor.name@CSV_toplevel.csvBelisarius}" text="{3895,570003}"/>
                          </action>
                          <cues>
                            <cue name="CSV_Chapter2_TMdockedatHS_LS">
                              <condition>
                                <question_answered question="CSVWzFLifesupport" answer="ok"/>
                              </condition>
                              <action>
                                <do_all>
                                  <add_equipment object="CSV_Chapter2_top.CSVplayerTM">
                                    <ware exact="1" typename="SS_WARE_LIFESUPPORT"/>
                                  </add_equipment>
                                  <add_cargo object="CSV_Chapter2_top.CSVplayerTM">
                                    <ware exact="{value@CSV_Chapter2_warp.CSVpeoplestillinHSamount}-3" typename="SS_WARE_PASSENGER"/>
                                  </add_cargo>
                                  <incoming_message author="{actor.name@CSV_toplevel.csvBelisarius}" text="{3895,570001}"/>
                                  <set_value name="CSV_Chapter2_warp.CSVpeoplestillinHSamount" exact="0"/>
                                  <set_value name="CSV_Chapter2_top.CSVpassengersloadedcheck" exact="1"/>
									<cancel_cue cue="CSV_Chapter2_StationEnemy"/>
                                </do_all>
                              </action>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                    <cue name="CSV_Chapter2_FlytoEF" delay="2s">
                      <condition>
                        <check_value value="{value@CSV_Chapter2_top.CSVpassengersloadedcheck}" exact="1"/>
                      </condition>
                      <timing>
                        <time exact="1s"/>
                      </timing>
                      <action>
                        <do_all>
                          <cancel_cue cue="CSV_Chapter2_TMdockedatHS_LS_ask"/>
                          <cancel_cue cue="CSV_Chapter2_TMdockedatHS_CS"/>
                          <cancel_cue cue="CSV_Chapter2_TMdockedatHS_LS"/>
                          <cancel_cue cue="CSV_Chapter2_chickencheck"/>
                          <cancel_cue cue="CSV_Chapter2_HSWzFcheck"/>
                          <set_value name="CSV_Chapter2_warp.CSVpeoplestillinHSamount2" exact="91"/>
                          <create_briefing cue="CSV_Chapter2_top" title="{3212,20200}" text="{3212,20201}" background="CSV_C6S6_MA_EG2.tga">
                            <mission discipline="XXXT" level="average"/>
                            <objectives>
                              <objective step="3">
                                <deliver object="CSV_toplevel.MiliDock1">
                                  <ware exact="{value@CSV_Chapter2_warp.CSVpeoplestillinHSamount2}" typename="SS_WARE_PASSENGER"/>
                                </deliver>
                              </objective>
                            </objectives>
                          </create_briefing>
                          <set_objective cue="CSV_Chapter2_top" story="{3200,12}" title="{3212,20200}" noabort="1">
                            <briefing cue="CSV_Chapter2_top" step="3"/>
                            <mission discipline="XXXT" level="average"/>
                            <deliver object="CSV_toplevel.MiliDock1">
                              <ware exact="{value@CSV_Chapter2_warp.CSVpeoplestillinHSamount2}" typename="SS_WARE_PASSENGER"/>
                            </deliver>
                          </set_objective>
                        </do_all>
                      </action>
                      <cues>
                        <cue name="CSV_Chapter2_onthewaymsg" delay="1s">
                          <timing>
                            <time min="3m" max="5m"/>
                          </timing>
                          <action>
                            <incoming_message author="{actor.name@CSV_toplevel.csvBelisarius}" text="{3895,570004}"/>
                          </action>
                          <cues>
                            <cue name="CSV_Chapter2_atMiliDockEF" delay="2s">
                              <condition>
                                <check_all>
                                  <cue_is_complete cue="CSV_Chapter2_onthewaymsg"/>
                                  <object_is_docked object="CSV_Chapter2_top.CSVplayerTM" dockobject="CSV_toplevel.MiliDock1"/>
                                </check_all>
                              </condition>
                              <timing>
                                <time exact="6s"/>
                              </timing>
                              <action>
                                <do_all>
                                  <cancel_cue cue="CSV_Chapter2_TM_killed"/>
                                  <set_value name="this.CSVEFpassengercheck" exact="{object.cargo.SS_WARE_PASSENGER.count@CSV_Chapter2_top.CSVplayerTM}"/>
                                  <do_choose>
                                    <do_when value="{value@this.CSVEFpassengercheck}" min="{value@CSV_Chapter2_warp.CSVpeoplestillinHSamount2}">
                                      <set_value name="this.Do Actions" exact="1"/>
                                      <incoming_message author="{actor.name@CSV_toplevel.csvJeffMarxon}" text="{3895,560004}"/>
                                      <reward_player>
                                        <money exact="31254"/>
                                        <notoriety>
                                          <relation operation="add" min="notop2" max="notop3" race="argon"/>
                                        </notoriety>
                                      </reward_player>
                                    </do_when>
                                    <do_when value="{value@this.CSVEFpassengercheck}" min="1" max="90">
                                      <set_value name="this.Do Actions" exact="1"/>
                                      <incoming_message author="{actor.name@CSV_toplevel.csvJeffMarxon}" text="{3895,560005}"/>
                                      <reward_player>
                                        <notoriety>
                                          <relation operation="subtract" min="notop3" max="notop4" race="argon"/>
                                        </notoriety>
                                      </reward_player>
                                    </do_when>
                                  </do_choose>
                                  <do_choose>
                                    <do_when value="{value@this.Do Actions}" exact="1">
                                      <cancel_cue cue="CSV_Chapter2_regainnotop"/>
                                      <cancel_cue cue="CSV_Chapter2_HSWzFcheck"/>
                                      <remove_briefing cue="CSV_Chapter2_top"/>
                                      <remove_objective cue="CSV_Chapter2_top"/>
                                      <add_cargo object="CSV_Chapter2_top.CSVplayerTM">
                                        <ware exact="-{value@this.CSVEFpassengercheck}" typename="SS_WARE_PASSENGER"/>
                                      </add_cargo>
                                      <set_value name="CSV_toplevel.CSVchapter3link" exact="1"/>
                                    </do_when>
                                    <do_otherwise>
                                      <incoming_message author="{actor.name@CSV_toplevel.csvJeffMarxon}" text="{3895,560007}"/>
                                      <remove_briefing cue="CSV_Chapter2_top"/>
                                      <remove_objective cue="CSV_Chapter2_top"/>
                                      <reward_player>
                                        <notoriety>
                                          <relation operation="set" exact="noto0" race="argon"/>
                                        </notoriety>
                                      </reward_player>
                                    </do_otherwise>
                                  </do_choose>
                                </do_all>
                              </action>
                              <cues>
                                <cue name="CSV_Chapter2_regainnotop" delay="5m">
                                  <condition>
                                    <check_all>
                                      <cue_is_complete cue="CSV_Chapter2_atMiliDockEF"/>
                                      <check_value value="{player.notoriety.argon}" min="{lookup.notoriety.rank@notop6}"/>
                                    </check_all>
                                  </condition>
                                  <timing>
                                    <time exact="10s"/>
                                  </timing>
                                  <action>
                                    <do_all>
                                      <incoming_message author="{actor.name@CSV_toplevel.csvJeffMarxon}" text="{3895,560006}"/>
                                      <set_value name="CSV_toplevel.CSVchapter3link" exact="1"/>
                                    </do_all>
                                  </action>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>
          </cues>
        </cue>
      </cues>
    </cue>
    <cue name="CSV_Chapter3" delay="2003" version="2">
      <documentation>
        <content reference="CSV_Chapter3" name="Chapter 3"/>
        <version number="1.0" date="03/08/2009" status="candidate"/>
        <history>
          <change author="Jens" date="08/12/2008" description="Initial version"/>
          <change author="Owen Lake" date="03/08/2009" description="2.5 Beta 2 version"/>
          <change author="Owen Lake" date="20/11/2009" description="2.6 Beta 1 version"/>
        </history>
      </documentation>
      <condition>
        <check_value value="{value@CSV_toplevel.CSVchapter3link}" exact="1"/>
      </condition>
      <timing>
        <time exact="2s"/>
      </timing>
      <action>
        <do_all>
          <cancel_cue cue="CSV_Chapter2"/>
          <remove_tradables object="CSV_toplevel.HsWzF">
            <ware typename="SS_WARE_WARPING"/>
          </remove_tradables>
          <remove_tradables object="CSV_toplevel.HsWzF">
            <ware typename="SS_WARE_ENERGY"/>
          </remove_tradables>
          <create_briefing cue="CSV_Chapter3" title="{3212,20300}" text="{3212,20301}" background="CSV_C3S1_BoronShipyard.tga">
            <mission discipline="XXXT" level="easy"/>
            <objectives>
              <objective step="1">
                <flyto>
                  <sector sector="CSV_toplevel.CSV_VergeltungDerKoenigin"/>
                </flyto>
              </objective>
            </objectives>
          </create_briefing>
          <set_objective cue="CSV_Chapter3" story="{3200,12}" title="{3212,20300}" noabort="1">
            <briefing cue="CSV_Chapter3" step="1"/>
            <mission discipline="XXXT" level="easy"/>
            <flyto>
              <sector sector="CSV_toplevel.CSV_VergeltungDerKoenigin"/>
            </flyto>
          </set_objective>
        </do_all>
      </action>
      <cues>
        <cue name="CSV_Chapter3_inSektor" delay="2s">
          <condition>
            <check_all>
              <cue_is_complete cue="CSV_Chapter3"/>
              <object_sector exact="0">
                <sector sector="CSV_toplevel.CSV_VergeltungDerKoenigin"/>
              </object_sector>
            </check_all>
          </condition>
          <action>
            <do_all>
              <create_briefing cue="CSV_Chapter3" title="{3212,20300}" text="{3212,20301}" background="CSV_C3S1_BoronShipyard.tga">
                <mission discipline="XXXT" level="easy"/>
                <objectives>
                  <objective step="2">
                    <dockat object="CSV_toplevel.Shipyard VdK"/>
                  </objective>
                </objectives>
              </create_briefing>
              <set_objective cue="CSV_Chapter3" story="{3200,12}" title="{3212,20300}" noabort="1">
                <briefing cue="CSV_Chapter3" step="2"/>
                <mission discipline="XXXT" level="easy"/>
                <dockat object="CSV_toplevel.Shipyard VdK"/>
              </set_objective>
            </do_all>
          </action>
          <cues>
            <cue name="CSV_Chapter3_docked" delay="2s">
              <condition>
                <object_is_docked dockobject="CSV_toplevel.Shipyard VdK"/>
              </condition>
              <timing>
                <time exact="2s"/>
              </timing>
              <action>
                <do_all>
                  <set_actor_location actor="CSV_toplevel.csvGagaWa" object="CSV_toplevel.Shipyard VdK" location="crew"/>
                  <create_offer actor="CSV_toplevel.csvGagaWa" discipline="XXXXP" conversation="CSV Mission C3 No1"/>
                  <create_briefing cue="CSV_Chapter3" title="{3212,20300}" text="{3212,20301}" background="CSV_C3S1_BoronShipyard.tga">
                    <mission discipline="XXXT" level="easy"/>
                    <objectives>
                      <objective step="3">
                        <talkto actor="CSV_toplevel.csvGagaWa"/>
                      </objective>
                    </objectives>
                  </create_briefing>
                  <set_objective cue="CSV_Chapter3" story="{3200,12}" title="{3212,20300}" noabort="1">
                    <briefing cue="CSV_Chapter3" step="3"/>
                    <mission discipline="XXXT" level="easy"/>
                    <talkto actor="CSV_toplevel.csvGagaWa"/>
                  </set_objective>
                </do_all>
              </action>
              <cues>
                <cue name="CSV_Chapter3_GagaWa">
                  <condition>
                    <conversation_completed actor="CSV_toplevel.csvGagaWa" conversation="CSV Mission C3 No1" answer="ready"/>
                  </condition>
                  <timing>
                    <time exact="1s"/>
                  </timing>
                  <action>
                    <do_all>
                      <remove_offer actor="CSV_toplevel.csvGagaWa" discipline="XXXXP" conversation="CSV Mission C3 No1"/>
                      <ask_question name="CSV Gaga Wa dialog" author="{actor.name@CSV_toplevel.csvGagaWa}" text="{3895,580001}"/>
                    </do_all>
                  </action>
                  <cues>
                    <cue name="CSV_Chapter3_GagaWa_End">
                      <condition>
                        <question_answered question="CSV Gaga Wa dialog" answer="yes"/>
                      </condition>
                      <timing>
                        <time exact="2s"/>
                      </timing>
                      <action>
                        <do_all>
                          <incoming_message author="{actor.name@CSV_toplevel.csvGagaWa}" text="{3895,580002}"/>
                          <create_briefing cue="CSV_Chapter3" title="{3212,20300}" text="{3212,20301}" background="CSV_C3S4_Aldrin.tga">
                            <mission discipline="XXXT" level="easy"/>
                            <objectives>
                              <objective step="4">
                                <flyto>
                                  <sector sector="CSV_toplevel.CSV_Aldrin"/>
                                </flyto>
                              </objective>
                            </objectives>
                          </create_briefing>
                          <set_objective cue="CSV_Chapter3" story="{3200,12}" title="{3212,20300}" noabort="1">
                            <briefing cue="CSV_Chapter3" step="4"/>
                            <mission discipline="XXXT" level="easy"/>
                            <flyto>
                              <sector sector="CSV_toplevel.CSV_Aldrin"/>
                            </flyto>
                          </set_objective>
                        </do_all>
                      </action>
                      <cues>
                        <cue name="CSV_Chapter3_End" delay="2s">
                          <condition>
                            <object_sector exact="0">
                              <sector sector="CSV_toplevel.CSV_Aldrin"/>
                            </object_sector>
                          </condition>
                          <action>
                            <do_all>
                              <remove_objective cue="CSV_Chapter3"/>
                              <remove_briefing cue="CSV_Chapter3"/>
                              <destroy_actor actor="CSV_toplevel.csvGagaWa"/>
                              <set_value name="CSV_toplevel.CSVchapter4link" exact="1"/>
                            </do_all>
                          </action>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>
          </cues>
        </cue>
      </cues>
    </cue>
    <cue name="CSV_Chapter4" delay="2004" version="2">
      <documentation>
        <content reference="CSV_Chapter4" name="Chapter 4"/>
        <version number="1.0" date="03/08/2009" status="candidate"/>
        <history>
          <change author="Jens" date="15/12/2008" description="Initial version"/>
          <change author="Owen Lake" date="03/08/2009" description="2.5 Beta 2 version"/>
          <change author="Owen Lake" date="20/11/2009" description="2.6 Beta 1 version"/>
        </history>
      </documentation>
      <condition>
        <check_value value="{value@CSV_toplevel.CSVchapter4link}" exact="1"/>
      </condition>
      <action>
        <do_all>
          <create_briefing cue="CSV_Chapter4" title="{3212,20400}" text="{3212,20401}" background="CSV_C3S4_Aldrin.tga">
            <mission discipline="XXXT" level="average"/>
            <objectives>
              <objective step="1">
                <custom action="{35,2006}" text="{actor.name@CSV_toplevel.csvNolaHi}" icon="find"/>
              </objective>
            </objectives>
          </create_briefing>
          <set_objective cue="CSV_Chapter4" story="{3200,12}" title="{3212,20400}" noabort="1">
            <briefing cue="CSV_Chapter4" step="1"/>
            <mission discipline="XXXT" level="average"/>
            <custom action="{35,2006}" text="{actor.name@CSV_toplevel.csvNolaHi}" icon="find"/>
          </set_objective>
          <set_actor_location actor="CSV_toplevel.csvJensKa" object="CSV_toplevel.XFStation" location="crew"/>
          <create_offer actor="CSV_toplevel.csvJensKa" discipline="XXXXP" conversation="CSV Mission C4 No1"/>
        </do_all>
      </action>
      <cues>
        <cue name="CSV_Chapter4_csvJensKa">
          <condition>
            <conversation_completed actor="CSV_toplevel.csvJensKa" conversation="CSV Mission C4 No1" answer="ready"/>
          </condition>
          <timing>
            <time exact="1s"/>
          </timing>
          <action>
            <do_all>
              <remove_offer actor="CSV_toplevel.csvJensKa" discipline="XXXXP" conversation="CSV Mission C4 No1"/>
              <ask_question name="CSV Jens Ka dialog 1" author="{actor.name@CSV_toplevel.csvJensKa}" text="{3895,590001}"/>
            </do_all>
          </action>
          <cues>
            <cue name="CSV_Chapter4_Briefing">
              <condition>
                <question_answered question="CSV Jens Ka dialog 1" answer="yes"/>
              </condition>
              <timing>
                <time exact="1s"/>
              </timing>
              <action>
                <do_all>
                  <set_actor_location actor="CSV_toplevel.csvKetraar" object="CSV_toplevel.StationAl1" location="crew"/>
                  <create_briefing cue="CSV_Chapter4" title="{3212,20400}" text="{3212,20401}" background="CSV_C3S4_Aldrin.tga">
                    <mission discipline="XXXT" level="easy"/>
                    <objectives>
                      <objective step="2">
                        <dockat object="CSV_toplevel.StationAl1"/>
                      </objective>
                    </objectives>
                  </create_briefing>
                  <set_objective cue="CSV_Chapter4" story="{3200,12}" title="{3212,20400}" noabort="1">
                    <briefing cue="CSV_Chapter4" step="2"/>
                    <mission discipline="XXXT" level="easy"/>
                    <dockat object="CSV_toplevel.StationAl1"/>
                  </set_objective>
                </do_all>
              </action>
              <cues>
                <cue name="CSV_Chapter4_Dockat" delay="2s">
                  <condition>
                    <check_all>
                      <cue_is_complete cue="CSV_Chapter4_Briefing"/>
                      <object_is_docked dockobject="CSV_toplevel.StationAl1"/>
                    </check_all>
                  </condition>
                  <timing>
                    <time exact="7s"/>
                  </timing>
                  <action>
                    <do_all>
                      <create_offer actor="CSV_toplevel.csvKetraar" conversation="CSV Mission C4 No2" discipline="XXXXP"/>
                      <create_briefing cue="CSV_Chapter4" title="{3212,20400}" text="{3212,20401}" background="CSV_C3S4_Aldrin.tga">
                        <mission discipline="XXXT" level="easy"/>
                        <objectives>
                          <objective step="3">
                            <talkto actor="CSV_toplevel.csvKetraar"/>
                          </objective>
                        </objectives>
                      </create_briefing>
                      <set_objective cue="CSV_Chapter4" story="{3200,12}" title="{3212,20400}" noabort="1">
                        <briefing cue="CSV_Chapter4" step="3"/>
                        <mission discipline="XXXT" level="easy"/>
                        <talkto actor="CSV_toplevel.csvKetraar"/>
                      </set_objective>
                    </do_all>
                  </action>
                  <cues>
                    <cue name="CSV_Chapter4_ActorDialog_1">
                      <condition>
                        <conversation_completed actor="CSV_toplevel.csvKetraar" conversation="CSV Mission C4 No2" answer="ready"/>
                      </condition>
                      <action>
                        <remove_offer actor="CSV_toplevel.csvKetraar" conversation="CSV Mission C4 No2" discipline="XXXXP"/>
                      </action>
                      <cues>
                        <cue name="CSV_Chapter4_Ask_Dialog_1">
                          <timing>
                            <time exact="10s"/>
                          </timing>
                          <action>
                            <do_all>
                              <set_actor_location actor="CSV_toplevel.csvNolaHi" object="CSV_toplevel.StationAl1" location="crew"/>
                              <ask_question name="CSV Chapter4 Dialog 1" author="{actor.name@CSV_toplevel.csvNolaHi}" text="{3212,10412}"/>
                            </do_all>
                          </action>
                          <cues>
                            <cue name="CSV_Chapter4_wait">
                              <condition>
                                <question_answered question="CSV Chapter4 Dialog 1" answer="yes"/>
                              </condition>
                              <action>
                                <do_all>
                                  <remove_objective cue="CSV_Chapter4"/>
                                  <create_briefing cue="CSV_Chapter4" title="{3212,20400}" text="{3212,20401}" background="CSV_C3S4_Aldrin.tga">
                                    <mission discipline="XXXT" level="trivial"/>
                                    <objectives>
                                      <objective step="4">
                                        <custom action="{35,2048}" text="{35,4402} {13,1279} {actor.name@CSV_toplevel.csvNolaHi}"
                                                comment="(Wait For): (Incomming Message) (by) (Nola Hi) - TODO Replace with its own text entry"/>
                                      </objective>
                                    </objectives>
                                  </create_briefing>
                                  <set_objective cue="CSV_Chapter4" story="{3200,12}" title="{3212,20400}" noabort="1">
                                    <briefing cue="CSV_Chapter4" step="4"/>
                                    <mission discipline="XXXT" level="trivial"/>
                                    <custom action="{35,2048}" text="{1906,108} {13,1279} {actor.name@CSV_toplevel.csvNolaHi}"
                                            comment="(Wait For): (Incomming Message) (by) (Nola Hi) - TODO Replace with its own text entry"/>
                                  </set_objective>
                                </do_all>
                              </action>
                              <cues>
                                <cue name="CSV_Chapter4_csvNolaHi_D1">
                                  <timing comment="TODO Could we have a way for the player get on with it quicker?">
                                    <time exact="10m"/>
                                  </timing>
                                  <action>
                                    <do_all>
                                      <incoming_message author="{actor.name@CSV_toplevel.csvNolaHi}" text="{3895,600004}"/>
                                      <create_briefing cue="CSV_Chapter4" title="{3212,20400}" text="{3212,20401}" background="CSV_C3S4_Aldrin.tga">
                                        <mission discipline="XXXT" level="easy"/>
                                        <objectives>
                                          <objective step="5">
                                            <talkto actor="CSV_toplevel.csvKetraar"/>
                                          </objective>
                                        </objectives>
                                      </create_briefing>
                                      <set_objective cue="CSV_Chapter4" story="{3200,12}" title="{3212,20400}" noabort="1">
                                        <briefing cue="CSV_Chapter4" step="5"/>
                                        <mission discipline="XXXT" level="easy"/>
                                        <talkto actor="CSV_toplevel.csvKetraar"/>
                                      </set_objective>
                                      <create_offer actor="CSV_toplevel.csvKetraar" conversation="CSV Mission C4 No3" discipline="XXXXP"/>
                                    </do_all>
                                  </action>
                                  <cues>
                                    <cue name="CSV_Chapter4_csvKetraar_D1">
                                      <condition>
                                        <conversation_completed actor="CSV_toplevel.csvKetraar" conversation="CSV Mission C4 No3" answer="ready"/>
                                      </condition>
                                      <action>
                                        <remove_offer actor="CSV_toplevel.csvKetraar" conversation="CSV Mission C4 No3" discipline="XXXXP"/>
                                      </action>
                                      <cues>
                                        <!--TODO. Is there another dialog option?-->
                                        <cue name="CSV_Chapter4_Ask_D2">
                                          <timing>
                                            <time exact="10s"/>
                                          </timing>
                                          <action>
                                            <ask_question name="CSV Chapter4 Dialog 2" author="{actor.name@CSV_toplevel.csvKetraar}, {actor.name@CSV_toplevel.csvNolaHi}" text="{3212,10439}"/>
                                          </action>
                                          <cues>
                                            <cue name="CSV_Chapter4_Daten">
                                              <condition>
                                                <question_answered question="CSV Chapter4 Dialog 2" answer="yes"/>
                                              </condition>
                                              <timing>
                                                <time exact="1s"/>
                                              </timing>
                                              <action>
                                                <play_text actor="CSV_toplevel.CSVBetty" pageid="13" textid="1332"/>
                                              </action>
                                              <cues>
                                                <cue name="CSV_Chapter4_ActorDialog_2">
                                                  <condition>
                                                    <cue_completed cue="CSV_Chapter4_Daten"/>
                                                  </condition>
                                                  <timing>
                                                    <time exact="{text.duration@13,1332}+1s"/>
                                                  </timing>
                                                  <action>
                                                    <ask_question name="CSV Chapter4 Dialog 3" author="{actor.name@CSV_toplevel.csvKetraar}" text="{3895,610010}"/>
                                                  </action>
                                                  <cues>
                                                    <cue name="CSV_Chapter4_ActorDialog End">
                                                      <condition>
                                                        <question_answered question="CSV Chapter4 Dialog 3" answer="yes"/>
                                                      </condition>
                                                      <action>
                                                        <do_all>
                                                          <remove_briefing cue="CSV_Chapter4"/>
                                                          <remove_objective cue="CSV_Chapter4"/>
                                                          <destroy_actor actor="CSV_toplevel.csvJensKa"/>
                                                          <destroy_actor actor="CSV_toplevel.csvKetraar"/>
                                                          <destroy_actor actor="CSV_toplevel.csvNolaHi"/>
                                                          <set_value name="CSV_toplevel.CSVchapter5link" exact="1"/>
                                                        </do_all>
                                                      </action>
                                                    </cue>
                                                  </cues>
                                                </cue>
                                              </cues>
                                            </cue>
                                          </cues>
                                        </cue>
                                      </cues>
                                    </cue>
                                  </cues>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>
          </cues>
        </cue>
      </cues>
    </cue>
    <cue name="CSV_Chapter5" delay="2005" version="2">
      <documentation>
        <content reference="CSV_Chapter5" name="Chapter 5"/>
        <version number="1.0" date="03/08/2009" status="candidate"/>
        <history>
          <change author="Jens" date="15/12/2008" description="Initial version"/>
          <change author="Jens" date="01/02/2009" description="Time zum einsameln der Spieler Waren eingefühgt und time an Spieler Schiffklasse angepast. erhöhung der warp Position auf min 50 max 60km."/>
          <change author="Jens" date="04/02/2009" description="Briefing für Warte zeit bei Efaa eingebaut. JD und UFJD Rückgabe weiter nach hinten verschoben."/>
          <change author="Jens" date="17/06/2009" description="efaa sektor nach 20/2 player sekor verschoben. wap player nach 20/2 eingefühgt. warp Efaa zu WzF eingefühgt. creat efaa ausgeklammert und UFJD antrib wird nicht mehr entfernt aus Spieler besits."/>
          <change author="Owen Lake" date="03/08/2009" description="2.5 Beta 2 version"/>
          <change author="Jens" date="06/08/2009" description="CPU ship efaa textid correct"/>
          <change author="Jens" date="07/08/2009" description="Text Durations checked. Bettyspam text durations error removes."/>
          <change author="Owen Lake" date="20/11/2009" description="2.6 Beta 1 version"/>
        </history>
      </documentation>
      <condition>
        <check_value value="{value@CSV_toplevel.CSVchapter5link}" exact="1"/>
      </condition>
      <action>
        <do_all>
          <create_briefing cue="CSV_Chapter5" title="{3212,20500}" text="{3212,20501}" background="CSV_C5S3_efaa.tga">
            <mission discipline="XXXT" level="hard"/>
            <objectives>
              <objective step="1">
                <custom action="{35,2174}" text="{sector.name@CSV_toplevel.CSV_playersector}" comment="Jump To:">
                    <sector sector="CSV_toplevel.CSV_UFJD Sektoren1"/>
                </custom>
              </objective>
            </objectives>
          </create_briefing>
          <set_objective cue="CSV_Chapter5" story="{3200,12}" title="{3212,20500}" noabort="1">
            <briefing cue="CSV_Chapter5" step="1"/>
            <mission discipline="XXXT" level="hard"/>
                <custom action="{35,2174}" text="{sector.name@CSV_toplevel.CSV_playersector}" comment="Jump To:">
                    <sector sector="CSV_toplevel.CSV_UFJD Sektoren1"/>
                </custom>
          </set_objective>
          <set_value name="this.EfaaCounter" min="5" max="8"/>
        </do_all>
      </action>
      <cues>
        <cue name="CSV_Chapter5_CheckJumps" delay="3s">
          <condition>
            <object_sector exact="0">
              <sector sector="CSV_toplevel.CSV_UFJD Sektoren1"/>
            </object_sector>
          </condition>
          <action>
            <set_value name="CSV_Chapter5.EfaaCounter" operation="subtract"/>
          </action>
          <cues>
            <cue name="CSV_Chapter5_CheckJumps_reset">
              <condition>
                <object_changed_sector/>
              </condition>
              <timing>
                <time exact="2s"/>
              </timing>
              <action>
                <do_if value="{value@CSV_Chapter5.EfaaCounter}" min="1">
                  <reset_cue cue="CSV_Chapter5_CheckJumps"/>
                </do_if>
              </action>
            </cue>
          </cues>
        </cue>
        <cue name="CSV_Chapter5_jumptoEfaa">
          <condition>
            <check_all>
              <check_value value="{value@CSV_Chapter5.EfaaCounter}" max="0"/>
              <object_sector exact="0">
                <sector sector="CSV_toplevel.CSV_UFJD Sektoren1"/>
              </object_sector>
            </check_all>
          </condition>
          <action>
            <do_all>
              <cancel_cue cue="CSV_Chapter5_CheckJumps"/>
              <warp_player>
                <position x="0" y="0" z="0"/>
                <sector sector="CSV_toplevel.CSV_playersector"/>
              </warp_player>
            </do_all>
          </action>
          <cues>
            <cue name="CSV_Chapter5_EfaaFind">
              <condition>
                <check_all>
                  <check_value value="{value@CSV_Chapter5.EfaaCounter}" max="0"/>
                  <object_sector exact="0">
                    <sector sector="CSV_toplevel.CSV_playersector"/>
                  </object_sector>
                </check_all>
              </condition>
              <action>
                <do_all>
                  <create_special name="CSV_Chapter5_EfaaFind.EfaaMaker" typename="SS_SPECIAL_SHIPWRECK_7">
                    <position min="25km" max="30km"/>
                    <sector sector="CSV_toplevel.CSV_playersector"/>
                  </create_special>
                  <set_object name="CSV_Chapter5_EfaaFind.PlayerShipMaker" value="{player.ship}"/>
                  <do_if value="{player.ship.equipment.SS_WARE_WARPING.exists}" exact="1">
                    <add_equipment object="{player.ship}">
                      <ware exact="-1" typename="SS_WARE_WARPING"/>
                    </add_equipment>
                    <set_value name="this.CSVc5UFJD JD" exact="1"/>
                  </do_if>
                </do_all>
              </action>
              <cues>
                <cue name="CSV_Chapter5_PlayerShipMaker_Check" delay="5s" instantiate="static">
                  <condition>
                    <check_any>
                      <object_exists object="CSV_Chapter5_EfaaFind.PlayerShipMaker" negate="1"/>
                      <match_object object="CSV_Chapter5_EfaaFind.PlayerShipMaker" race="player" negate="1"/>
                    </check_any>
                  </condition>
                  <action>
                    <set_object name="CSV_Chapter5_EfaaFind.PlayerShipMaker" value="{player.ship}"/>
                  </action>
                </cue>
                <cue name="CSV_Chapter5_EfaaFind_Betty">
                  <timing>
                    <time exact="5s"/>
                  </timing>
                  <action>
                    <play_text>
                      <line actor="CSV_toplevel.CSVBetty2" pageid="17" textid="3983" comment="Sprungantrib"/>
                      <line actor="CSV_toplevel.CSVBetty" pageid="13" textid="1355" comment="außer Bertrieb"/>
                    </play_text>
                  </action>
                  <cues>
                    <cue name="CSV_Chapter5_EfaaFind_Briefing">
                      <condition>
                        <cue_completed cue="CSV_Chapter5_EfaaFind_Betty"/>
                      </condition>
                      <timing>
                        <time exact="{text.duration@17,3983}+{text.duration@13,1355}+1s"/>
                      </timing>
                      <action>
                        <do_all>
                          <create_briefing cue="CSV_Chapter5" title="{3212,20500}" text="{3212,20501}" background="CSV_C5S3_efaa.tga">
                            <mission discipline="XXXT" level="easy"/>
                            <objectives>
                              <objective step="2">
                                <flyto object="CSV_Chapter5_EfaaFind.EfaaMaker"/>
                              </objective>
                            </objectives>
                          </create_briefing>
                          <set_objective cue="CSV_Chapter5" story="{3200,12}" title="{3212,20500}" noabort="1">
                            <briefing cue="CSV_Chapter5" step="2"/>
                            <mission discipline="XXXT" level="easy"/>
                            <flyto object="CSV_Chapter5_EfaaFind.EfaaMaker"/>
                          </set_objective>
                        </do_all>
                      </action>
                      <cues>
                        <cue name="CSV_Chapter5_craeteEfaa" delay="5s">
                          <condition>
                            <object_position max="2km">
                              <position object="CSV_Chapter5_EfaaFind.EfaaMaker"/>
                            </object_position>
                          </condition>
                          <action>
                            <do_all>
                              <create_ship name="CSV_toplevel.CSV_C5_EfaaCPU" typename="SS_SH_TERRAFORMER1" race="friend" invincible="1" textid="90841">
                                <position object="CSV_Chapter5_EfaaFind.EfaaMaker" min="50km" max="100km"/>
                                <sector sector="CSV_toplevel.CSV_playersector"/>
                                <equipment loadout="none">
                                  <ware typename="SS_WARE_TECH246" exact="10"/>
                                  <ware typename="SS_WARE_TECH213" exact="10"/>
                                  <ware typename="SS_SHIELD_F" exact="6"/>
                                </equipment>
                                <command command="stay"/>
                              </create_ship>
                              <create_briefing cue="CSV_Chapter5" title="{3212,20500}" text="{3212,20501}" background="CSV_C5S3_efaa.tga">
                                <mission discipline="XXXT" level="easy"/>
                                <objectives>
                                  <objective step="3">
                                    <flyto object="CSV_toplevel.CSV_C5_EfaaCPU"/>
                                  </objective>
                                </objectives>
                              </create_briefing>
                              <set_objective cue="CSV_Chapter5" story="{3200,12}" title="{3212,20500}" noabort="1">
                                <briefing cue="CSV_Chapter5" step="3"/>
                                <mission discipline="XXXT" level="easy"/>
                                <flyto object="CSV_toplevel.CSV_C5_EfaaCPU"/>
                              </set_objective>
                            </do_all>
                          </action>
                          <cues>
                            <cue name="CSV_Chapter5_EfaaQ1" delay="2s">
                              <condition>
                                <object_position max="25km">
                                  <position object="CSV_toplevel.CSV_C5_EfaaCPU"/>
                                </object_position>
                              </condition>
                              <action>
                                <do_all>
                                  <remove_objective cue="CSV_Chapter5"/>
                                  <set_value name="this.CSVc5Bettyspam" exact="1"/>
                                  <set_value name="this.csvEfaaQlink" exact="0"/>
                                  <ask_question name="CSV Efaa dialog 1" author="{actor.name@CSV_toplevel.csvEFAA}" popup="1" text="{3895,660001}"/>
                                </do_all>
                              </action>
                              <cues>
                                <cue name="CSV_Chapter5_EfaaQ2a">
                                  <condition>
                                    <question_answered question="CSV Efaa dialog 1" answer="right_1"/>
                                  </condition>
                                  <action>
                                    <set_value name="CSV_Chapter5_EfaaQ1.csvEfaaQlink" exact="1"/>
                                  </action>
                                </cue>
                                <cue name="CSV_Chapter5_EfaaQ4">
                                  <condition>
                                    <question_answered question="CSV Efaa dialog 1" answer="wrong_1"/>
                                  </condition>
                                  <cues>
                                    <cue name="CSV_Chapter5_EfaaQ5">
                                      <timing>
                                        <time exact="1s"/>
                                      </timing>
                                      <action>
                                        <ask_question name="CSV Efaa dialog 2" author="{actor.name@CSV_toplevel.csvEFAA}" popup="1" text="{3895,660002}"/>
                                      </action>
                                      <cues>
                                        <cue name="CSV_Chapter5_EfaaQ6b">
                                          <condition>
                                            <question_answered question="CSV Efaa dialog 2" answer="right_2"/>
                                          </condition>
                                          <action>
                                            <set_value name="CSV_Chapter5_EfaaQ1.csvEfaaQlink" exact="1"/>
                                          </action>
                                        </cue>
                                        <cue name="CSV_Chapter5_EfaaQ6">
                                          <condition>
                                            <question_answered question="CSV Efaa dialog 2" answer="wrong_2"/>
                                          </condition>
                                          <timing>
                                            <time exact="2s"/>
                                          </timing>
                                          <action>
                                            <reset_cue cue="CSV_Chapter5_EfaaQ5"/>
                                          </action>
                                        </cue>
                                      </cues>
                                    </cue>
                                  </cues>
                                </cue>
                                <cue name="CSV_Chapter5_EfaaQ2c">
                                  <condition>
                                    <check_value value="{value@CSV_Chapter5_EfaaQ1.csvEfaaQlink}" exact="1"/>
                                  </condition>
                                  <timing>
                                    <time exact="6s"/>
                                  </timing>
                                  <action>
                                    <do_all>
                                      <cancel_cue cue="CSV_Chapter5_Bettyspam"/>
                                      <cancel_cue cue="CSV_Chapter5_wareneject"/>
                                      <incoming_message author="{actor.name@CSV_toplevel.csvEFAA}" popup="1" text="{3895,660003}"/>
                                    </do_all>
                                  </action>
                                  <cues>
                                    <cue name="CSV_Chapter5_EfaaQ3">
                                      <condition>
                                        <cue_is_complete cue="CSV_Chapter5_EfaaQ2c"/>
                                      </condition>
                                      <timing>
                                        <time exact="10s"/>
                                      </timing>
                                      <action>
                                        <do_all>
                                          <do_choose>
                                            <do_when value="{player.ship.isclass.hugeship}" exact="1">
                                              <set_value name="this.EfaaJumpTime" exact="12"/>
                                            </do_when>
                                            <do_when value="{player.ship.isclass.bigship}" exact="1">
                                              <set_value name="this.EfaaJumpTime" exact="8"/>
                                            </do_when>
                                            <do_otherwise>
                                              <set_value name="this.EfaaJumpTime" exact="6"/>
                                            </do_otherwise>
                                          </do_choose>
                                          <incoming_message author="{actor.name@CSV_toplevel.csvEFAA}" popup="1" text="{3895,660004}"/>
                                        </do_all>
                                      </action>
                                      <cues>
                                        <cue name="CSV_Chapter5_TimeBriefing">
                                          <condition>
                                            <cue_is_complete cue="CSV_Chapter5_EfaaQ3"/>
                                          </condition>
                                          <action>
                                            <do_all>
                                              <create_briefing cue="CSV_Chapter5" title="{3212,20500}" text="{3212,10505}" background="CSV_C5S3_efaa.tga">
                                                <mission discipline="XXXT" level="easy"/>
                                                <timer duration="{value@CSV_Chapter5_EfaaQ3.EfaaJumpTime}m"/>
                                                <objectives>
                                                  <objective step="4">
                                                    <custom action="{35,2048}" text="{3212,10504}" comment="(Wait For:) (The Jumpdrive Calibration)"/>
                                                  </objective>
                                                </objectives>
                                              </create_briefing>
                                              <set_objective cue="CSV_Chapter5" story="{3200,12}" title="{3212,20500}" noabort="1">
                                                <briefing cue="CSV_Chapter5" step="4"/>
                                                <mission discipline="XXXT" level="easy"/>
                                                <timer duration="{value@CSV_Chapter5_EfaaQ3.EfaaJumpTime}m"/>
                                                <custom action="{35,2048}" text="{3212,10504}" comment="(Wait For:) (The Jumpdrive Calibration)"/>
                                              </set_objective>
												<show_timer pageid="3212" textid="10504" duration="{value@CSV_Chapter5_EfaaQ3.EfaaJumpTime}m" name="CSV_Chapter5_Timer"/>
                                            </do_all>
                                          </action>
                                          <cues>
                                            <cue name="CSV_Chapter5_Efaa UFJD">
												<condition>
													<onscreen_timer_finished name="CSV_Chapter5_Timer"/>
												</condition>
                                              <action>
                                                <do_all>
                                                  <play_text>
                                                    <line actor="CSV_toplevel.CSVBetty2" pageid="17" textid="3983" comment="Sprungantrib"/>
                                                    <line actor="CSV_toplevel.CSVBetty" pageid="13" textid="27" comment="verfürgbar"/>
                                                  </play_text>
                                                  <do_if value="{value@CSV_Chapter5_EfaaFind.CSVc5UFJD JD}" exact="1">
                                                    <do_if value="{object.equipment.SS_WARE_WARPING.exists@CSV_Chapter5_EfaaFind.PlayerShipMaker}" exact="0">
                                                      <add_equipment object="CSV_Chapter5_EfaaFind.PlayerShipMaker">
                                                        <ware exact="1" typename="SS_WARE_WARPING"/>
                                                      </add_equipment>
                                                    </do_if>
                                                  </do_if>
                                                </do_all>
                                              </action>
                                              <cues>
                                                <cue name="CSV_Chapter5_Efaa UFJD Time">
                                                  <condition>
                                                    <cue_completed cue="CSV_Chapter5_Efaa UFJD"/>
                                                  </condition>
                                                  <timing>
                                                    <time exact="{text.duration@17,3983}+{text.duration@13,27}+1s"/>
                                                  </timing>
                                                  <cues>
                                                    <cue name="CSV_Chapter5_Efaa initiiert jump" delay="1s">
                                                      <condition>
                                                        <check_all>
                                                          <cue_is_complete cue="CSV_Chapter5_Efaa UFJD Time"/>
                                                          <check_value value="{player.ship}" exact="{object@CSV_Chapter5_EfaaFind.PlayerShipMaker}"/>
                                                          <object_sector exact="{object.sector@CSV_toplevel.CSV_C5_efaaCPU}" comment="make sure player is in effa sector"/>
                                                        </check_all>
                                                      </condition>
                                                      <timing>
                                                        <time exact="15s"/>
                                                      </timing>
                                                      <action>
                                                        <do_all>
                                                          <cancel_cue cue="CSV_Chapter5_PlayerShipMaker_Check"/>
                                                          <play_text>
                                                            <line actor="CSV_toplevel.CSVBetty3" pageid="7" textid="1020805" comment="Weg zur Freiheit"/>
                                                            <line actor="CSV_toplevel.CSVBetty" pageid="13" textid="200" comment="Ausgewählt"/>
                                                            <line actor="CSV_toplevel.CSVBetty" pageid="13" textid="1319" comment="Sprungantrieb wird geladen... 10%...20...30...40...50%...60...70...80...90...initiiere Sprung..."/>
                                                          </play_text>
                                                        </do_all>
                                                      </action>
                                                      <cues>
                                                        <cue name="CSV_Chapter5_Playerjump">
                                                          <condition>
                                                            <cue_completed cue="CSV_Chapter5_Efaa initiiert jump"/>
                                                          </condition>
                                                          <timing>
                                                            <time exact="{text.duration@7,1020805}+{text.duration@13,200}+{text.duration@13,1319}"/>
                                                          </timing>
                                                          <action>
                                                            <do_all>
                                                              <cancel_cue cue="CSV_Chapter5_EfaaSectorCheck"/>
                                                              <warp_player>
                                                                <position object="CSV_Chapter5.WzF GateN" min="50km" max="60km"/>
                                                                <sector sector="CSV_toplevel.CSV_WegZuFreiheit"/>
                                                              </warp_player>
                                                            </do_all>
                                                          </action>
                                                          <cues>
                                                            <cue name="CSV_Chapter5_Efaajump" delay="2s">
                                                              <condition>
                                                                <object_sector exact="0">
                                                                  <sector sector="CSV_toplevel.CSV_WegZuFreiheit"/>
                                                                </object_sector>
                                                              </condition>
                                                              <action>
                                                                <warp_object object="CSV_toplevel.CSV_C5_EfaaCPU">
                                                                  <position object="{player.ship}" min="6km" max="12km"/>
                                                                  <sector sector="CSV_toplevel.CSV_WegZuFreiheit"/>
                                                                </warp_object>
                                                              </action>
                                                              <cues>
                                                                <cue name="CSV_Chapter5_Clin" delay="3s">
                                                                  <condition>
                                                                    <cue_is_complete cue="CSV_Chapter5_Efaajump"/>
                                                                  </condition>
                                                                  <action>
                                                                    <do_all>
                                                                      <destroy_object object="CSV_Chapter5_EfaaFind.EfaaMaker"/>
                                                                      <remove_objective cue="CSV_Chapter5"/>
                                                                      <remove_briefing cue="CSV_Chapter5"/>
                                                                      <set_value name="CSV_toplevel.CSVchapter6link" exact="1"/>
                                                                    </do_all>
                                                                  </action>
                                                                </cue>
                                                              </cues>
                                                            </cue>
                                                          </cues>
                                                        </cue>
                                                      </cues>
                                                    </cue>
                                                  </cues>
                                                </cue>
                                              </cues>
                                            </cue>
                                          </cues>
                                        </cue>
                                      </cues>
                                    </cue>
                                  </cues>
                                </cue>
                              </cues>
                            </cue>
                            <cue name="CSV_Chapter5_Bettyspam" delay="2s">
                              <condition>
                                <object_position max="25km">
                                  <position object="CSV_toplevel.CSV_C5_EfaaCPU"/>
                                </object_position>
                              </condition>
                              <cues>
                                <cue name="CSV_Chapter5_Bettyspam_Start">
                                  <action>
                                    <do_all>
                                      <do_any>
                                        <set_value name="this.TextID" min="1" max="53"/>
                                        <set_value name="this.TextID" min="130" max="137"/>
                                        <set_value name="this.TextID" min="1245" max="1371"/>
                                        <set_value name="this.TextID" min="110003" max="1100065"/>
                                      </do_any>
                                      <do_choose>
                                        <do_when value="{text.exists@13,{value@this.TextID}}" exact="1">
                                          <play_text actor="CSV_toplevel.CSVBetty" pageid="13" textid="{value@this.TextID}"/>
                                        </do_when>
                                        <do_otherwise>
                                          <reset_cue cue="CSV_Chapter5_Bettyspam_Start"/>
                                        </do_otherwise>
                                      </do_choose>
                                    </do_all>
                                  </action>
                                  <cues>
                                    <cue name="CSV_Chapter5_Bettyspam_Reset">
                                      <timing>
                                        <time exact="{text.duration@13,{value@CSV_Chapter5_Bettyspam_Start.TextID}}+1s"/>
                                      </timing>
                                      <action>
                                        <reset_cue cue="CSV_Chapter5_Bettyspam_Start"/>
                                      </action>
                                    </cue>
                                  </cues>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>
            <cue name="CSV_Chapter5_EfaaSectorCheck">
              <condition>
                <check_all>
                  <object_changed_sector/>
                  <object_sector exact="0" negate="1">
                    <sector sector="CSV_toplevel.CSV_playersector"/>
                  </object_sector>
                  <object_sector exact="0" negate="1">
                    <sector x="23" y="19"/>
                  </object_sector>
                </check_all>
              </condition>
              <action>
                <do_all>
                  <remove_briefing cue="CSV_Chapter5"/>
                  <remove_objective cue="CSV_Chapter5"/>
                  <set_sector_known sector="CSV_toplevel.CSV_playersector" known="0"/>
                  <find_object class="object" group="this.effasectorobjects" multiple="1" max="99999" race="all|player">
                    <sector sector="CSV_toplevel.CSV_playersector"/>
                  </find_object>
                  <destroy_group group="this.effasectorobjects" explosion="0"/>
                  <destroy_object object="CSV_Chapter5_EfaaFind.EfaaMaker" explosion="0"/>
                  <destroy_object object="CSV_toplevel.CSV_C5_EfaaCPU" explosion="0"/>
                  <reset_cue cue="CSV_Chapter5"/>
                </do_all>
              </action>
            </cue>
          </cues>
        </cue>
      </cues>
    </cue>
    <cue name="CSV_Chapter6" delay="2006" version="2">
      <documentation>
        <content reference="CSV_Chapter6" name="Chapter 6"/>
        <version number="1.0" date="03/08/2009" status="candidate"/>
        <history>
          <change author="Jens" date="17/12/2008" description="Initial version"/>
          <change author="Jens" date="01/02/2009" description="Erhöung der Häck Trigger Distanc auf max 26km. In script run die scriptvalue angepast."/>
          <change author="Owen Lake" date="03/08/2009" description="2.5 Beta 2 version"/>
          <change author="Owen Lake" date="20/11/2009" description="2.6 Beta 1 version"/>
        </history>
      </documentation>
      <condition>
        <check_value value="{value@CSV_toplevel.CSVchapter6link}" exact="1"/>
      </condition>
      <action>
        <do_all>
          <set_sector_known sector="CSV_toplevel.CSV_playersector" known="0"/>
          <find_object class="object" group="this.effasectorobjects" multiple="1" max="99999" race="all|player">
            <sector sector="CSV_toplevel.CSV_playersector"/>
          </find_object>
          <create_briefing cue="CSV_Chapter6" title="{3212,20600}" text="{3212,20601}" background="CSV_C6S2_cafe.tga">
            <mission discipline="XXXT" level="average"/>
            <objectives>
              <objective step="1">
                <flyto object="CSV_toplevel.CafeCPU"/>
              </objective>
            </objectives>
          </create_briefing>
          <set_objective cue="CSV_Chapter6" story="{3200,12}" title="{3212,20600}" noabort="1">
            <briefing cue="CSV_Chapter6" step="1"/>
            <mission discipline="XXXT" level="average"/>
            <flyto object="CSV_toplevel.CafeCPU"/>
          </set_objective>
          <destroy_group group="this.effasectorobjects" explosion="0"/>
        </do_all>
      </action>
      <cues>
        <cue name="CSV_Chapter6_jumpdrive" delay="5s" instantiate="static">
          <condition>
            <check_value value="{player.ship.equipment.SS_WARE_WARPING.exists}" exact="1"/>
          </condition>
          <action>
            <do_all>
              <set_object name="CSV_Chapter6.PlayerShip {player.ship}" value="{player.ship}" group="CSV_Chapter6.PlayerShipGroup"/>
              <add_equipment object="{player.ship}">
                <ware exact="-1" typename="SS_WARE_WARPING"/>
              </add_equipment>
            </do_all>
          </action>
        </cue>
        <cue name="CSV_Chapter6_vorFirewall" delay="2s">
          <condition>
            <object_position max="26km">
              <position object="CSV_toplevel.CafeCPU"/>
            </object_position>
          </condition>
          <action>
            <do_all>
              <remove_objective cue="CSV_Chapter6"/>
              <add_equipment object="CSV_toplevel.CafeCPU">
                <ware typename="SS_WARE_LIFESUPPORT" exact="1"/>
              </add_equipment>
              <set_command object="CSV_toplevel.CafeCPU" command="stay"/>
              <create_briefing cue="CSV_Chapter6" title="{3212,20600}" text="{3212,20601}" background="CSV_C6S2_cafe.tga">
                <mission discipline="XXXT" level="veryhard"/>
                <objectives>
                  <objective step="2">
                    <custom action="{35,2022}" text="{17,90801}" comment="(Disable): (#cafe)"/>
                  </objective>
                </objectives>
              </create_briefing>
              <set_objective cue="CSV_Chapter6" story="{3200,12}" title="{3212,20600}" noabort="1">
                <briefing cue="CSV_Chapter6" step="2"/>
                <mission discipline="XXXT" level="veryhard"/>
                <custom action="{35,2022}" text="{17,90801}" comment="(Disable): (#cafe)" object="CSV_toplevel.CafeCPU"/>
              </set_objective>
              <incoming_message author="{actor.name@CSV_toplevel.csvEFAA}" text="{3895,660005}"/>
            </do_all>
          </action>
          <cues>
            <cue name="CSV_Chapter6_Firewall">
              <condition>
                <cue_is_complete cue="CSV_Chapter6_vorFirewall"/>
              </condition>
              <timing>
                <time exact="1s"/>
              </timing>
              <action>
                <do_all>
                  <run_script script="csv.hacking.init">
                    <scriptargs>
                      <scriptvalue datatype="object" datavalue="{object@CSV_toplevel.CafeCPU}"/>
                    </scriptargs>
                  </run_script>
                </do_all>
              </action>
              <cues>
                <cue name="CSV_Chapter6_FinishHack">
                  <condition>
                    <check_all>
                      <cue_is_complete cue="CSV_Chapter6_Firewall"/>
						<script_event name="csv.hacking.done"/>
                    </check_all>
                  </condition>
                  <timing>
                    <time exact="1s"/>
                  </timing>
                  <action>
                    <do_all>
                      <cancel_cue cue="CSV CPU Defence"/>
                      <cancel_cue cue="CSV_CPU_DFP_top"/>
                      <cancel_cue cue="CSV_Chapter6_jumpdrive" instantiate="static"/>
                      <destroy_group group="CSV_toplevel.CPU Defenders" warp="1"/>
                      <abandon_ship object="CSV_toplevel.CafeCPU" name="this.PilotKick"/>
                      <do_if value="{object.exists@this.PilotKick}" exact="1">
                        <destroy_object object="this.PilotKick"/>
                      </do_if>
                      <set_owner object="CSV_toplevel.CafeCPU" race="neutral"/>
                      <set_relation object="CSV_toplevel.CafeCPU">
                        <relation object="{player.ship}" relation="neutral" mutual="1"/>
                      </set_relation>
                      <destroy_group group="CSV_toplevel.gateprotectgroupM3"/>
                      <destroy_group group="CSV_toplevel.gateprotectgroupM4"/>
                      <destroy_group group="CSV_toplevel.gateprotectgroupM5"/>
                      <destroy_group group="CSV_toplevel.cafeprotectgroupM3"/>
                      <destroy_group group="CSV_toplevel.cafeprotectgroupM4"/>
                      <destroy_group group="CSV_toplevel.cafeprotectgroupM5"/>
                      <create_astronaut name="this.CSVAstronaut" typename="SS_SH_ASTRON" racelogic="0" invincible="1" race="terran">
                        <position object="CSV_toplevel.CafeCPU" min="5km" max="6km"/>
                        <sector sector="CSV_toplevel.CSV_WegZuFreiheit"/>
                      </create_astronaut>
                      <set_actor_location actor="CSV_toplevel.csvGero" object="this.CSVAstronaut" location="pilot"/>
                      <set_command object="CSV_toplevel.CafeCPU" command="follow" commandobject="CSV_toplevel.CSV_C5_EfaaCPU"/>
                      <set_command object="CSV_toplevel.CSV_C5_EfaaCPU" command="moveposition">
                        <position x="200km" y="500km" z="15km"/>
                        <sector sector="CSV_toplevel.CSV_WegZuFreiheit"/>
                      </set_command>
                      <set_command object="this.CSVAstronaut" command="idle"/>
                      <ask_question name="CSV C6 Efaa Nachricht" author="{actor.name@CSV_toplevel.csvEFAA}" text="{3895,660007}"/>
                      <do_all counter="PShipCount" exact="{group.object.count@CSV_Chapter6.PlayerShipGroup}">
                        <do_if value="{group.object.{counter@PShipCount}.cargo.SS_WARE_WARPING.exists@CSV_Chapter6.PlayerShipGroup}" exact="0">
                          <add_equipment object="{group.object.{counter@PShipCount}@CSV_Chapter6.PlayerShipGroup}">
                            <ware exact="1" typename="SS_WARE_WARPING"/>
                          </add_equipment>
                        </do_if>
                      </do_all>
                    </do_all>
                  </action>
                  <cues>
                    <cue name="CSV_Chapter6_Efaa Cafe cutscene">
                      <condition>
                        <question_answered question="CSV C6 Efaa Nachricht" answer="yes"/>
                      </condition>
                      <action>
                        <play_cutscene file="CSV Plot C6">
                          <object name="TempEfaa" object="{object@CSV_toplevel.CSV_C5_EfaaCPU}"/>
                          <object name="TempCafe" object="{object@CSV_toplevel.CafeCPU}"/>
                        </play_cutscene>
                      </action>
                      <cues>
                        <cue name="CSV_Chapter6_AstronautBriefing">
                          <condition>
                            <cutscene_stopped cue="CSV_Chapter6_Efaa Cafe cutscene" key="CSV Plot C6"/>
                          </condition>
                          <action>
                            <do_all>
                              <remove_objective cue="CSV_Chapter6"/>
                              <create_briefing cue="CSV_Chapter6" title="{3212,20600}" text="{3212,20601}" background="CSV_C6S3_Astronaut.tga">
                                <mission discipline="XXXT" level="average"/>
                                <objectives>
                                  <objective step="3">
                                    <custom action="{35,2042}" text="{actor.name@CSV_toplevel.csvGero}" comment="(Collect): Gero 'Jigsaw' Boss"/>
                                  </objective>
                                </objectives>
                              </create_briefing>
                              <set_objective cue="CSV_Chapter6" story="{3200,12}" title="{3212,20600}" noabort="1">
                                <briefing cue="CSV_Chapter6" step="3"/>
                                <mission discipline="XXXT" level="average"/>
                                <custom action="{35,2042}" text="{actor.name@CSV_toplevel.csvGero}" object="{object@CSV_toplevel.csvGero}" comment="(Collect): Gero 'Jigsaw' Boss"/>
                              </set_objective>
                            </do_all>
                          </action>
                          <cues>
                            <cue name="CSV_Chapter6_sammelAstronaut" delay="1s">
                              <condition>
                                <check_value value="{actor.ship@CSV_toplevel.csvGero}" exact="{player.ship}"/>
                              </condition>
                              <timing>
                                <time exact="1s"/>
                              </timing>
                              <action>
                                <do_all>
                                  <create_briefing cue="CSV_Chapter6" title="{3212,20600}" text="{3212,20601}" background="CSV_C6S4_DannasChance2.tga">
                                    <mission discipline="XXXT" level="veryeasy"/>
                                    <objectives>
                                      <objective step="1">
                                        <custom action="{35,2007}" text="{17,90801}"/>
                                      </objective>
                                      <objective step="2">
                                        <custom action="{35,2022}" text="{17,90801}"/>
                                      </objective>
                                      <objective step="3">
                                        <custom action="{35,2042}" text="{actor.name@CSV_toplevel.csvGero}"/>
                                      </objective>
                                      <objective step="4">
                                        <flyto>
                                          <sector sector="CSV_toplevel.CSV_DannasChance"/>
                                        </flyto>
                                      </objective>
                                    </objectives>
                                  </create_briefing>
                                  <set_objective cue="CSV_Chapter6" story="{3200,12}" title="{3212,20600}" noabort="1">
                                    <briefing cue="CSV_Chapter6" step="4"/>
                                    <mission discipline="XXXT" level="veryeasy"/>
                                    <flyto>
                                      <sector sector="CSV_toplevel.CSV_DannasChance"/>
                                    </flyto>
                                  </set_objective>
                                </do_all>
                              </action>
                              <cues>
                                <cue name="CSV_Chapter6_creatHeim" delay="2s">
                                  <condition>
                                    <object_sector exact="0">
                                      <sector sector="CSV_toplevel.CSV_DannasChance"/>
                                    </object_sector>
                                  </condition>
                                  <action>
                                    <do_all>
                                      <warp_object object="CSV_toplevel.CSV_C5_EfaaCPU">
                                        <position x="0" y="0" z="0" max="20km"/>
                                        <sector sector="CSV_toplevel.CSV_playersector"/>
                                      </warp_object>
                                      <warp_object object="CSV_toplevel.CafeCPU">
                                        <position x="0" y="0" z="0" max="20km"/>
                                        <sector sector="CSV_toplevel.CSV_playersector"/>
                                      </warp_object>
                                      <do_all exact="3">
                                        <create_ship group="CSV_toplevel.heimkerer" typename="SS_SH_TERRAFORMER2" race="friend" racelogic="0" textid="90811">
                                          <position x="0" y="-8km" z="-14km" min="1km" max="2km"/>
                                          <sector sector="CSV_toplevel.CSV_DannasChance"/>
				                        <equipment loadout="maximum" loadoutmask="lasers|shields|missiles">
    				                          <ware typename="SS_LASER_EMP_1" exact="8"/>
				                        </equipment>
                                          <command command="stay"/>
                                        </create_ship>
                                      </do_all>
                                      <do_all exact="4">
                                        <create_ship group="CSV_toplevel.heimkerer" typename="SS_SH_TERRAFORMER3" race="friend" racelogic="0" textid="90821">
                                          <position x="0" y="-8km" z="-14km" min="1km" max="2km"/>
                                          <sector sector="CSV_toplevel.CSV_DannasChance"/>
				                        <equipment loadout="maximum" loadoutmask="lasers|shields|missiles">
    				                          <ware typename="SS_LASER_EMP_1" exact="6"/>
				                        </equipment>
                                          <command command="stay"/>
                                        </create_ship>
                                      </do_all>
                                      <do_all exact="3">
                                        <create_ship group="CSV_toplevel.heimkerer" typename="SS_SH_TERRAFORMER4" race="friend" racelogic="0" textid="90831">
                                          <position x="0" y="-8km" z="-14km" min="1km" max="2km"/>
                                          <sector sector="CSV_toplevel.CSV_DannasChance"/>
				                        <equipment loadout="maximum" loadoutmask="lasers|shields|missiles">
    				                          <ware typename="SS_LASER_EMP_1" exact="4"/>
				                        </equipment>
                                          <command command="stay"/>
                                        </create_ship>
                                      </do_all>
                                      <set_group_command group="CSV_toplevel.heimkerer" command="movesector">
                                        <sector sector="CSV_toplevel.CSV_WegZuFreiheit"/>
                                      </set_group_command>
                                    </do_all>
                                  </action>
                                  <cues>
                                    <cue name="CSV_Chapter6_creatHeim_command">
                                      <timing>
                                        <time exact="1m"/>
                                      </timing>
                                      <action>
                                        <do_all>
                                          <incoming_message author="{actor.name@CSV_toplevel.csvMarteen}" text="{3895,620001}"/>
                                          <create_briefing cue="CSV_Chapter6" title="{3212,20600}" text="{3212,20601}" background="CSV_C6S6_MA_EG2.tga">
                                            <mission discipline="XXXT" level="average"/>
                                            <objectives>
                                              <objective step="5">
                                                <flyto>
                                                  <sector sector="CSV_toplevel.CSV_ElenasGlueck"/>
                                                </flyto>
                                              </objective>
                                            </objectives>
                                          </create_briefing>
                                          <set_objective cue="CSV_Chapter6" story="{3200,12}" title="{3212,20600}" noabort="1">
                                            <briefing cue="CSV_Chapter6" step="5"/>
                                            <mission discipline="XXXT" level="average"/>
                                            <flyto>
                                              <sector sector="CSV_toplevel.CSV_ElenasGlueck"/>
                                            </flyto>
                                          </set_objective>
                                        </do_all>
                                      </action>
                                      <cues>
                                        <cue name="CSV_Chapter6_ElenasGlueck" delay="2s">
                                          <condition>
                                            <check_all>
                                              <cue_is_complete cue="CSV_Chapter6_creatHeim_command"/>
                                              <object_sector exact="0">
                                                <sector sector="CSV_toplevel.CSV_ElenasGlueck"/>
                                              </object_sector>
                                            </check_all>
                                          </condition>
                                          <timing>
                                            <time exact="10s"/>
                                          </timing>
                                          <action>
                                            <do_all>
                                              <destroy_group group="CSV_toplevel.heimkerer"/>
                                              <destroy_group group="CSV_NPC_Fleet_top.NPCfleetM1"/>
                                              <destroy_object object="CSV_NPC_Fleet_top.NPCfleetgroup"/>
                                              <destroy_group group="CSV_NPC_Fleet_attackcpu.NPCfleetattackgroup"/>
                                              <create_briefing cue="CSV_Chapter6" title="{3212,20600}" text="{3212,20601}" background="CSV_C6S6_MA_EG2.tga">
                                                <mission discipline="XXXT" level="easy"/>
                                                <objectives>
                                                  <objective step="6">
                                                    <dockat object="CSV_toplevel.MiliDock1"/>
                                                  </objective>
                                                </objectives>
                                              </create_briefing>
                                              <set_objective cue="CSV_Chapter6" story="{3200,12}" title="{3212,20600}" noabort="1">
                                                <briefing cue="CSV_Chapter6" step="6"/>
                                                <mission discipline="XXXT" level="easy"/>
                                                <dockat object="CSV_toplevel.MiliDock1"/>
                                              </set_objective>
                                            </do_all>
                                          </action>
                                          <cues>
                                            <cue name="CSV_Chapter6_DockMilit" delay="1s">
                                              <condition>
                                                <check_all>
                                                  <cue_is_complete cue="CSV_Chapter6_ElenasGlueck"/>
                                                  <check_any>
                                                    <object_is_docked object="{actor.ship@CSV_toplevel.csvGero}" dockobject="CSV_toplevel.MiliDock1"/>
                                                    <check_all>
                                                      <!--For the case when the actor is on a ship docked at another ship-->
                                                      <check_value value="{actor.ship.dockobject.exists@CSV_toplevel.csvGero}" exact="1"/>
                                                      <check_value value="{actor.ship.dockobject.isclass.ship@CSV_toplevel.csvGero}" exact="1"/>
                                                      <object_is_docked object="{actor.ship.dockobject@CSV_toplevel.csvGero}" dockobject="CSV_toplevel.MiliDock1"/>
                                                    </check_all>
                                                  </check_any>
                                                </check_all>
                                              </condition>
                                              <timing>
                                                <time exact="10s"/>
                                              </timing>
                                              <action>
                                                <do_all>
                                                  <destroy_object object="CSV_toplevel.CafeCPU"/>
                                                  <destroy_object object="CSV_toplevel.CSV_C5_EfaaCPU"/>
                                                  <destroy_actor actor="CSV_toplevel.csvGero"/>
                                                  <remove_briefing cue="CSV_Chapter6"/>
                                                  <remove_objective cue="CSV_Chapter6"/>
                                                  <set_value name="CSV_toplevel.CSVchapter7link" exact="1"/>
                                                </do_all>
                                              </action>
                                            </cue>
                                          </cues>
                                        </cue>
                                      </cues>
                                    </cue>
                                  </cues>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>
          </cues>
        </cue>
      </cues>
    </cue>
    <cue name="CSV_Chapter7" delay="2007" version="2">
      <documentation>
        <content reference="CSV_Chapter7" name="CSV Chapter 7"/>
        <version number="1.0" date="03/08/2009" status="candidate"/>
        <history>
          <change author="Ketraar" date="20/12/2008" description="Initial version"/>
          <change author="Owen Lake" date="03/08/2009" description="2.5 Beta 2 version"/>
          <change author="Jens" date="07/08/2009" description="textId {3300,16} changed to {35,707} =Cr"/>
          <change author="Jens" date="08/08/2009" description="Missing gate connection for sector 20-5 to 20-2 add"/>
          <change author="Owen Lake" date="22/11/2009" description="2.6 Beta 1 version"/>
        </history>
      </documentation>
      <condition>
        <check_value value="{value@CSV_toplevel.CSVchapter7link}" exact="1"/>
      </condition>
      <action>
        <incoming_message author="{actor.name@CSV_toplevel.csvJeffMarxon}" text="{3895,560008}"/>
      </action>
      <cues>
        <cue name="CSV_Chapter7_loadactor" delay="2s" version="2">
          <condition>
            <object_is_docked dockobject="CSV_toplevel.MiliDock1"/>
          </condition>
          <action>
            <do_all>
              <set_value name="this.CargoCheckFailed" exact="0"/>
              <do_if value="{player.ship.cargospace}" max="({lookup.type.cargospace@SS_WARE_PASSENGER}*2)-1">
                <set_value name="this.CargoCheckFailed" exact="1"/>
              </do_if>
              <do_if value="{player.ship.cargoclass}" max="{lookup.type.cargoclass@SS_WARE_PASSENGER}-1">
                <set_value name="this.CargoCheckFailed" exact="1"/>
              </do_if>

              <do_choose>
                <do_when value="{value@this.CargoCheckFailed}" exact="0">
                  <do_if value="{player.ship.cargo.SS_WARE_LIFESUPPORT.exists}" exact="0">
                    <add_equipment>
                      <ware exact="1" typename="SS_WARE_LIFESUPPORT"/>
                    </add_equipment>
                  </do_if>
                  <destroy_actor actor="CSV_toplevel.csvBelisarius"/>
                  <create_actor name="CSV_toplevel.csvBelisarius" character="{3895,57}" race="teladi" face="503" voiceflags="32" object="{player.ship}" location="passenger" invincible="1"/>
                  <create_briefing cue="CSV_Chapter7_loadactor" title="{3212,20700}" text="{3212,20701}" background="CSV_C7S1a_WzF_HS.tga">
                    <mission discipline="XXXT" level="average"/>
                    <objectives>
                      <objective step="1">
                        <dockat object="CSV_toplevel.HsWzF"/>
                      </objective>
                    </objectives>
                  </create_briefing>
                  <set_objective cue="CSV_Chapter7_loadactor" story="{3200,12}" title="{3212,20700}" noabort="1">
                    <briefing cue="CSV_Chapter7_loadactor" step="1"/>
                    <mission discipline="XXXT" level="average"/>
                    <dockat object="CSV_toplevel.HsWzF"/>
                  </set_objective>
                  <cancel_cue cue="CSV_Chapter7_loadactor_reset2"/>
                  <set_value name="CSV_toplevel.CSVEFactorloadcheck" exact="1"/>
                </do_when>
                <do_otherwise>
                  <incoming_message author="{actor.name@CSV_toplevel.csvBelisarius}" text="{3895,570008}"/>
                  <set_value name="CSV_toplevel.CSVEFactorloadcheck" exact="2"/>
                </do_otherwise>
              </do_choose>              
            </do_all>
          </action>
          <cues>
            <cue name="CSV_Chapter7_loadactor_reset" delay="2s">
              <condition>
                <check_value value="{value@CSV_toplevel.CSVEFactorloadcheck}" exact="2"/>
              </condition>
              <timing>
                <time exact="2m"/>
              </timing>
              <action>
                <do_choose>
                  <do_when value="{player.dockobject}" exact="{CSV_toplevel.MiliDock1}" negate="1">
                    <create_briefing cue="CSV_Chapter7_loadactor_reset" title="{3212,20700}" text="{3212,20701}" background="CSV_C6S6_MA_EG2.tga">
                      <mission discipline="XXXT" level="easy"/>
                      <objectives>
                        <objective step="1">
                          <dockat object="CSV_toplevel.MiliDock1"/>
                        </objective>
                      </objectives>
                    </create_briefing>
                    <set_objective cue="CSV_Chapter7_loadactor_reset" story="{3200,12}" title="{3212,20700}" noabort="1">
                      <briefing cue="CSV_Chapter7_loadactor_reset" step="1"/>
                      <mission discipline="XXXT" level="easy"/>
                      <dockat object="CSV_toplevel.MiliDock1"/>
                    </set_objective>
                  </do_when>
                  <do_otherwise>
                    <set_value name="CSV_toplevel.CSVEFactorloadcheck" exact="0"/>
                    <cancel_cue cue="CSV_Chapter7_loadactor_reset_2"/>
                    <reset_cue cue="CSV_Chapter7_loadactor"/>
                  </do_otherwise>
                </do_choose>
              </action>
              <cues>
                <cue name="CSV_Chapter7_loadactor_reset_2">
                  <condition>
                    <check_all>
                      <cue_is_complete cue="CSV_Chapter7_loadactor_reset"/>
                      <object_is_docked dockobject="CSV_toplevel.MiliDock1"/>
                    </check_all>
                  </condition>
                  <timing>
                    <time exact="10s"/>
                  </timing>
                  <action>
                    <do_all>
                      <set_value name="CSV_toplevel.CSVEFactorloadcheck" exact="0"/>
                      <remove_briefing cue="CSV_Chapter7_loadactor_reset"/>
                      <remove_objective cue="CSV_Chapter7_loadactor_reset"/>
                      <reset_cue cue="CSV_Chapter7_loadactor"/>
                    </do_all>
                  </action>
                </cue>
              </cues>
            </cue>
          </cues>
        </cue>
        <cue name="CSV_Chapter7_unloadactor" delay="5s" version="4">
          <condition>
            <check_all>
              <check_value value="{value@CSV_toplevel.CSVEFactorloadcheck}" exact="1"/>
              <check_all>
                <check_value value="{actor.ship.exists@CSV_toplevel.csvBelisarius}" exact="1"/>
                <check_any>
                  <object_is_docked object="{actor.ship@CSV_toplevel.csvBelisarius}" dockobject="CSV_toplevel.HsWzF"/>
                  <check_all>
                    <!--For the case when the actor is on a ship docked at another ship-->
                    <check_value value="{actor.ship.dockobject.exists@CSV_toplevel.csvBelisarius}" exact="1"/>
                    <check_value value="{actor.ship.dockobject.isclass.ship@CSV_toplevel.csvBelisarius}" exact="1"/>
                    <object_is_docked object="{actor.ship.dockobject@CSV_toplevel.csvBelisarius}" dockobject="CSV_toplevel.HsWzF"/>
                  </check_all>
                </check_any>
              </check_all>
            </check_all>
          </condition>
          <action>
            <do_all>
              <destroy_actor actor="CSV_toplevel.csvBelisarius"/>
              <create_actor name="CSV_toplevel.csvBelisarius" character="{3895,57}" race="teladi" face="503" voiceflags="32" object="CSV_toplevel.HsWzF" location="crew" invincible="1"/>
              <incoming_message author="{actor.name@CSV_toplevel.csvBelisarius}" text="{3895,570005}"/>
              <remove_briefing cue="CSV_Chapter7_loadactor"/>
              <remove_objective cue="CSV_Chapter7_loadactor"/>
            </do_all>
          </action>
          <cues>
            <cue name="CSV_Chapter7_offercoords" delay="1s">
              <condition>
                <cue_is_complete cue="CSV_Chapter7_unloadactor"/>
              </condition>
              <timing>
                <time min="20m" max="30m"/>
              </timing>
              <action>
                <do_all>
                  <create_briefing cue="CSV_Chapter7_loadactor" title="{3212,20700}" text="{3212,20701}" background="CSV_C7S1a_WzF_HS.tga">
                    <mission discipline="XXXT" level="easy"/>
                    <objectives>
                      <objective step="1">
                        <dockat object="CSV_toplevel.MiliDock1"/>
                      </objective>
                      <objective step="2">
                        <talkto actor="CSV_toplevel.csvBelisarius"/>
                      </objective>
                    </objectives>
                  </create_briefing>
                  <set_objective cue="CSV_Chapter7_loadactor" story="{3200,12}" title="{3212,20700}" noabort="1">
                    <briefing cue="CSV_Chapter7_loadactor" step="2"/>
                    <mission discipline="XXXT" level="easy"/>
                    <talkto actor="CSV_toplevel.csvBelisarius"/>
                  </set_objective>
                  <set_value name="this.CSVcoordsprice" exact="56987546"/>
                  <create_offer actor="CSV_toplevel.csvBelisarius" conversation="L2OfferBuyCustom1" discipline="XXXXP" cue="CSV_Chapter7_offercoords">
                    <params>
                      <param name="OfferText" value="{3899,211209}"/>
                      <param name="Option1" value="{3895,570009}"/>
                      <param name="Price1" value="{value.formatted@this.CSVcoordsprice} {35,707}"/>
                    </params>
                  </create_offer>
                </do_all>
              </action>
              <cues>
                <cue name="CSV_Chapter7_offercoords_denied">
                  <condition>
                    <conversation_completed actor="CSV_toplevel.csvBelisarius" conversation="L2OfferBuyCustom1" answer="cancel"/>
                  </condition>
                  <action>
                    <do_all>
                      <remove_offer actor="CSV_toplevel.csvBelisarius" conversation="L2OfferBuyCustom1" discipline="XXXXP"/>
                      <remove_briefing cue="CSV_Chapter7_loadactor"/>
                      <remove_objective cue="CSV_Chapter7_loadactor"/>
                      <reset_cue cue="CSV_Chapter7_offercoords"/>
                    </do_all>
                  </action>
                </cue>
                <cue name="CSV_Chapter7_offercoords_accepted">
                  <condition>
                    <conversation_completed actor="CSV_toplevel.csvBelisarius" conversation="L2OfferBuyCustom1" answer="accept1"/>
                  </condition>
                  <action>
                    <do_choose>
                      <do_when value="{player.money}" min="{value@CSV_Chapter7_offercoords.CSVcoordsprice}">
                        <do_all>
                          <reward_player>
                            <money exact="-{value@CSV_Chapter7_offercoords.CSVcoordsprice}"/>
                          </reward_player>
                          <remove_offer actor="CSV_toplevel.csvBelisarius" conversation="L2OfferBuyCustom1" discipline="XXXXP"/>
                          <incoming_message author="{actor.name@CSV_toplevel.csvBelisarius}" text="{3895,570006}"/>
                          <set_value name="CSV_toplevel.CSVNotarOffer" exact="1"/>
                          <create_briefing cue="CSV_Chapter7_loadactor" title="{3212,20700}" text="{3212,20701}" background="sector_argon_argon_prime_sy.tga">
                            <mission discipline="XXXT" level="easy"/>
                            <objectives>
                              <objective step="3">
                                <talkto actor="CSV_toplevel.CSVNotaractor"/>
                              </objective>
                            </objectives>
                          </create_briefing>
                          <set_objective cue="CSV_Chapter7_loadactor" story="{3200,12}" title="{3212,20700}" noabort="1">
                            <briefing cue="CSV_Chapter7_loadactor" step="3"/>
                            <mission discipline="XXXT" level="easy"/>
                            <talkto actor="CSV_toplevel.CSVNotaractor"/>
                          </set_objective>
                        </do_all>
                      </do_when>
                      <do_otherwise>
                        <do_all>
                          <remove_offer actor="CSV_toplevel.csvBelisarius" conversation="L2OfferBuyCustom1" discipline="XXXXP"/>
                          <incoming_message author="{actor.name@CSV_toplevel.csvBelisarius}" text="{3895,570007}"/>
                          <remove_briefing cue="CSV_Chapter7_loadactor"/>
                          <remove_objective cue="CSV_Chapter7_loadactor"/>
                          <reset_cue cue="CSV_Chapter7_offercoords"/>
                        </do_all>
                      </do_otherwise>
                    </do_choose>
                  </action>
                  <cues>
                    <cue name="CSV_SectorOffer_top" delay="1s">
                      <condition>
                        <check_all>
                          <check_value value="{value@CSV_toplevel.CSVNotarOffer}" exact="1"/>
                          <object_sector max="1">
                            <sector sector="{object.sector@CSV_toplevel.CSV_NotarSY}"/>
                          </object_sector>
                        </check_all>
                      </condition>
                      <action>
                        <do_all>
                          <create_offer actor="CSV_toplevel.CSVNotaractor" conversation="L2OfferBuyCustom1" discipline="XXXXP" cue="CSV_SectorOffer_top">
                            <params>
                              <param name="OfferText" value="{3899,211208}"/>
                              <param name="Option1" value="{3895,640003}"/>
                              <param name="Price1" value="{value.formatted@CSV_toplevel.CSVsectorregcost} {35,707}"/>
                            </params>
                          </create_offer>
                        </do_all>
                      </action>
                      <cues>
                        <cue name="CSV_SectorOffer_denied">
                          <condition>
                            <conversation_completed actor="CSV_toplevel.CSVNotaractor" conversation="L2OfferBuyCustom1" answer="cancel"/>
                          </condition>
                          <action>
                            <do_all>
                              <remove_offer actor="CSV_toplevel.CSVNotaractor" conversation="L2OfferBuyCustom1" discipline="XXXXP"/>
                              <reset_cue cue="CSV_SectorOffer_top"/>
                            </do_all>
                          </action>
                        </cue>
                        <cue name="CSV_SectorOffer_acepted">
                          <condition>
                            <conversation_completed actor="CSV_toplevel.CSVNotaractor" conversation="L2OfferBuyCustom1" answer="accept1"/>
                          </condition>
                          <action>
                            <do_all>
                              <remove_offer actor="CSV_toplevel.CSVNotaractor" conversation="L2OfferBuyCustom1" discipline="XXXXP"/>
                              <do_choose>
                                <do_when value="{player.money}" min="{value@CSV_toplevel.CSVsectorregcost}">
                                  <reward_player>
                                    <money exact="-{value@CSV_toplevel.CSVsectorregcost}"/>
                                  </reward_player>
                                  <ask_question name="CSVSelectSectorName" author="{actor.name@CSV_toplevel.CSVNotaractor}" text="{3895,640001}"/>
                                </do_when>
                                <do_otherwise>
                                  <incoming_message author="{actor.name@CSV_toplevel.CSVNotaractor}" text="{3895,640002}"/>
                                  <reset_cue cue="CSV_SectorOffer_top"/>
                                </do_otherwise>
                              </do_choose>
                            </do_all>
                          </action>
							<patch>
								<find_sector name="CSV_toplevel.CSV_playersector" x="22" y="5" comment="Player Sector"/>
							</patch>
							<cues>
                            <cue name="CSV_SectorOffer_acepted1">
                              <condition>
                                <check_any>
                                  <question_answered question="CSVSelectSectorName" answer="argon"/>
                                  <question_answered question="CSVSelectSectorName" answer="boron"/>
                                  <question_answered question="CSVSelectSectorName" answer="paranid"/>
                                  <question_answered question="CSVSelectSectorName" answer="split"/>
                                  <question_answered question="CSVSelectSectorName" answer="teladi"/>
                                </check_any>
                              </condition>
                              <action>
                                <do_all>
									<find_sector name="CSV_toplevel.CSV_playersector" x="22" y="5" comment="Player Sector"/>
									<do_choose>
										<!--"CSV Sector Race" is Global for all missions-->
									  <do_when value="{question.answer}" exact="argon">
                                      <load_map file="ANH_Map_Argon"/>
                                      <set_sector_override sector="CSV_toplevel.CSV_playersector" textid="15054"/>
                                      <alter_sector sector="CSV_toplevel.CSV_playersector" background="SS_BG_8" population="0"/>
                                      <set_value name="ANH Sector Race" exact="{lookup.race@argon}"/>
                                    </do_when>
                                    <do_when value="{question.answer}" exact="boron">
                                      <load_map file="ANH_Map_Boron"/>
                                      <set_sector_override sector="CSV_toplevel.CSV_playersector" textid="15055"/>
                                      <alter_sector sector="CSV_toplevel.CSV_playersector" background="SS_BG_101" population="0"/>
                                      <set_value name="ANH Sector Race" exact="{lookup.race@boron}"/>
                                    </do_when>
                                    <do_when value="{question.answer}" exact="paranid">
                                      <load_map file="ANH_Map_Paranid"/>
                                      <set_sector_override sector="CSV_toplevel.CSV_playersector" textid="15056"/>
                                      <alter_sector sector="CSV_toplevel.CSV_playersector" background="SS_BG_106" population="0"/>
                                      <set_value name="ANH Sector Race" exact="{lookup.race@paranid}"/>
                                    </do_when>
                                    <do_when value="{question.answer}" exact="split">
                                      <load_map file="ANH_Map_Split"/>
                                      <set_sector_override sector="CSV_toplevel.CSV_playersector" textid="15053"/>
                                      <alter_sector sector="CSV_toplevel.CSV_playersector" background="SS_BG_4" population="0"/>
                                      <set_value name="ANH Sector Race" exact="{lookup.race@split}"/>
                                    </do_when>
                                    <do_when value="{question.answer}" exact="teladi">
                                      <load_map file="ANH_Map_Teladi"/>
                                      <set_sector_override sector="CSV_toplevel.CSV_playersector" textid="15057"/>
                                      <alter_sector sector="CSV_toplevel.CSV_playersector" background="SS_BG_98" population="0"/>
                                      <set_value name="ANH Sector Race" exact="{lookup.race@teladi}"/>
                                    </do_when>
                                  </do_choose>
                                  <create_gate name="CSVNorthgateinUnknownSector" gate="east" typename="SS_WG_EAST" race="argon">
                                    <position x="80km" y="0" z="0"/>
                                    <sector x="21" y="5"/>
                                    <destination gate="west" sector="CSV_toplevel.CSV_playersector"/>
                                  </create_gate>
                                  <create_gate name="this.CSVSouthgateinPS" gate="west" typename="SS_WG_WEST" race="argon">
                                    <position x="-80km" y="0" z="0"/>
                                    <sector sector="CSV_toplevel.CSV_playersector"/>
                                    <destination gate="east" x="21" y="5"/>
                                  </create_gate>
                                  <create_asteroid name="this.astroinUS" typename="SS_ASTEROID_01" minable="0">
                                    <position x="-30km" y="0" z="28km"/>
                                    <sector x="21" y="5"/>
                                    <resource exact="5" typename="SS_WARE_ORE"/>
                                  </create_asteroid>
                                </do_all>
                              </action>
                            </cue>
                            <!-- Playersectors End-->
                            <cue name="CSV_SectorOffer_Briefing" delay="2s">
                              <condition>
                                <cue_is_complete cue="CSV_SectorOffer_acepted1"/>
                              </condition>
                              <action>
                                <do_all>
                                  <create_briefing cue="CSV_Chapter7_loadactor" title="{3212,20700}" text="{3212,20701}" background="CSV_C7S4_UnbekannterSektor.tga">
                                    <mission discipline="XXXT" level="easy"/>
                                    <objectives>
                                      <objective step="4">
                                        <flyto>
                                          <sector x="21" y="5"/>
                                        </flyto>
                                      </objective>
                                    </objectives>
                                  </create_briefing>
                                  <set_objective cue="CSV_Chapter7_loadactor" story="{3200,12}" title="{3212,20700}" noabort="1">
                                    <briefing cue="CSV_Chapter7_loadactor" step="4"/>
                                    <mission discipline="XXXT" level="easy"/>
                                    <flyto>
                                      <sector x="21" y="5"/>
                                    </flyto>
                                  </set_objective>
                                </do_all>
                              </action>
                              <cues>
                                <cue name="CSV_SectorOffer_arrivedUS">
                                  <condition>
                                    <check_all>
                                      <object_changed_sector/>
                                      <object_sector exact="0">
                                        <sector x="21" y="5"/>
                                      </object_sector>
                                    </check_all>
                                  </condition>
                                  <timing>
                                    <time exact="5s"/>
                                  </timing>
                                  <action>
                                    <do_all>
                                      <create_briefing cue="CSV_Chapter7_loadactor" title="{3212,20700}" text="{3212,20701}" background="CSV_C7S4_UnbekannterSektor.tga">
                                        <mission discipline="XXXT" level="easy"/>
                                        <objectives>
                                          <objective step="5">
                                            <custom action="{35,2006}" text="{object.type.name@CSVNorthgateinUnknownSector}" icon="find"/>
                                          </objective>
                                        </objectives>
                                      </create_briefing>
                                      <set_objective cue="CSV_Chapter7_loadactor" story="{3200,12}" title="{3212,20700}" noabort="1">
                                        <briefing cue="CSV_Chapter7_loadactor" step="5"/>
                                        <mission discipline="XXXT" level="easy"/>
                                        <custom action="{35,2006}" text="{object.type.name@CSVNorthgateinUnknownSector}" icon="find"/>
                                      </set_objective>
                                    </do_all>
                                  </action>
                                </cue>
                              </cues>
                            </cue>
                            <cue name="CSV_SectorOffer_addgates" delay="2s">
                              <condition>
                                <check_all>
                                  <object_position max="15km">
                                    <position object="CSVNorthgateinUnknownSector"/>
                                    <sector x="21" y="5"/>
                                  </object_position>
                                </check_all>
                              </condition>
                              <action>
                                <do_all>
                                  <create_object name="Bluish Snout Inactive Gate" class="wreck" typename="SS_SPECIAL_GATE_INACTIVE">
                                    <position x="60km" y="0" z="0"/>
                                    <rotation alpha="90deg"/>
                                    <sector x="20" y="3"/>
                                  </create_object>
									<create_briefing cue="CSV_Chapter7_loadactor" title="{3212,20700}" text="{3212,20701}" background="CSV_C7S4_UnbekannterSektor.tga">
                                    <mission discipline="XXXT" level="easy"/>
                                    <objectives>
                                      <objective step="6">
                                        <flyto>
                                          <sector sector="CSV_toplevel.CSV_playersector"/>
                                        </flyto>
                                      </objective>
                                    </objectives>
                                  </create_briefing>
                                  <set_objective cue="CSV_Chapter7_loadactor" story="{3200,12}" title="{3212,20700}" noabort="1">
                                    <briefing cue="CSV_Chapter7_loadactor" step="6"/>
                                    <mission discipline="XXXT" level="easy"/>
                                    <flyto>
                                      <sector sector="CSV_toplevel.CSV_playersector"/>
                                    </flyto>
                                  </set_objective>
                                </do_all>
                              </action>
                              <cues>
                                <cue name="CSV_acomplished" delay="2s" version="2">
                                  <condition>
                                    <object_sector exact="0">
                                      <sector sector="CSV_toplevel.CSV_playersector"/>
                                    </object_sector>
                                  </condition>
                                  <timing>
                                    <time exact="6s"/>
                                  </timing>
                                  <action>
                                    <do_all>
										<do_if value="{value@StartedNewHome}" exact="0">
											<alter_sector x="23" y="0" background="SS_BG_88"/>
											<start_script script="plugin.guilds.patch">
												<scriptargs>
													<scriptvalue datatype="string" datavalue="NewHome"/>
													<scriptvalue datatype="integer" datavalue="500"/>
												</scriptargs>
											</start_script>
										</do_if>
										<remove_briefing cue="CSV_Chapter7_loadactor"/>
                                      <remove_objective cue="CSV_Chapter7_loadactor"/>
										<set_owner object="{sector@CSV_toplevel.CSV_playersector}" race="player"/>
                                      <play_movie movieid="8120"/>
                                      <set_value name="CSV_toplevel.CSVComplet" exact="1"/>
                                      <unlock_achievement name="NEW_HOME_PLOT"/>
                                      <set_value name="ANH Plot Complete" exact="1"/>
										<start_script script="plugin.guilds.sectors">
											<scriptargs>
												<scriptvalue datatype="sector" datavalue="{sector@CSV_toplevel.CSV_playersector}"/>
												<scriptvalue datatype="string" datavalue="update"/>
											</scriptargs>
										</start_script>
										<cancel_cue cue="CSV_Chapter7"/>
                                    </do_all>
                                  </action>
                                  <patch>
                                    <do_if value="{value@ANH Plot Complete}" exact="1">
                                      <remove_briefing cue="CSV_Chapter7_loadactor"/>
                                      <remove_objective cue="CSV_Chapter7_loadactor"/>
                                      <cancel_cue cue="CSV_Chapter7"/>
                                    </do_if>
                                  </patch>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>
          </cues>
        </cue>
      </cues>
    </cue>
    <cue name="CSV_NPC_Fleet_top" library="1">
      <documentation>
        <content reference="CSV_NPC_Fleet_top" name="NPC Fleet Management"/>
        <version number="1.0" date="03/08/2009" status="candidate"/>
        <history>
          <change author="Ketraar" date="14/12/2008" description="Initial version"/>
          <change author="Owen Lake" date="03/08/2009" description="2.5 Beta 2 version"/>
          <change author="Owen Lake" date="20/11/2009" description="2.6 Beta 1 version"/>
        </history>
      </documentation>
      <condition>
        <object_sector object="CSV_toplevel.CafeCPU">
          <sector sector="CSV_toplevel.CSV_DannasChance"/>
        </object_sector>
      </condition>
      <action>
        <do_all>
          <create_ship name="this.NPCfleetM1" invincible="1" racelogic="0" highlight="1" race="argon" typename="SS_SH_A_M1" textid="90881">
            <position x="8km" y="-8km" z="12km"/>
            <sector sector="CSV_toplevel.CSV_DannasChance"/>
            <equipment loadout="maximum" loadoutmask="all"/>
            <command command="stay"/>
          </create_ship>
          <do_all min="10" max="15">
            <create_ship group="this.NPCfleetgroup" typename="{random.type@SS_SH_A_M3|SS_SH_A_M3_1|SS_SH_A_M3_2|SS_SH_A_M3_3|SS_SH_A_M4|SS_SH_A_M4_1|SS_SH_A_M4_2|SS_SH_A_M4_3|SS_SH_A_M4P|SS_SH_A_M5|SS_SH_A_M5_1|SS_SH_A_M5_2|SS_SH_A_M5_3}" race="argon" racelogic="0" warp="1" capturable="0">
              <position object="this.NPCfleetM1" min="5km" max="7km"/>
              <sector sector="CSV_toplevel.CSV_DannasChance"/>
              <equipment loadout="maximum" loadoutmask="all"/>
              <command command="protect" commandobject="this.NPCfleetM1"/>
            </create_ship>
            <set_actor_location actor="CSV_toplevel.csvMarteen" object="this.NPCfleetM1" location="pilot"/>
          </do_all>
        </do_all>
      </action>
      <cues>
        <cue name="CSV_NPC_Fleet_attackcpu">
          <condition>
            <cue_is_complete cue="CSV_NPC_Fleet_top"/>
          </condition>
          <timing>
            <time exact="5s"/>
          </timing>
          <action>
            <do_all min="2" max="4">
              <create_ship group="this.NPCfleetattackgroup" typename="{random.type@SS_SH_A_M3|SS_SH_A_M3_1|SS_SH_A_M3_2|SS_SH_A_M3_3|SS_SH_A_M4|SS_SH_A_M4_1|SS_SH_A_M4_2|SS_SH_A_M4_3|SS_SH_A_M4P|SS_SH_A_M5|SS_SH_A_M5_1|SS_SH_A_M5_2|SS_SH_A_M5_3}" race="argon" racelogic="0" warp="1" dockobject="CSV_NPC_Fleet_top.NPCfleetM1">
                <sector sector="CSV_toplevel.CSV_DannasChance"/>
                <equipment loadout="maximum" loadoutmask="all"/>
                <command command="attack" commandobject="CSV_toplevel.CafeCPU"/>
              </create_ship>
            </do_all>
          </action>
          <cues>
            <cue name="CSV_NPC_Fleet_attackcpu_check" delay="5s">
              <condition>
                <check_all>
                  <cue_is_complete cue="CSV_NPC_Fleet_attackcpu"/>
                  <check_value value="{value@CSV_toplevel.CSVNPCfleetreset}" min="{value@CSV_toplevel.CSVNPCfleetresetlimit}"/>
                  <any_object_exists group="CSV_NPC_Fleet_attackcpu.NPCfleetattackgroup" negate="1"/>
                </check_all>
              </condition>
              <timing>
                <time min="2m" max="3m"/>
              </timing>
              <action>
                <do_all>
                  <set_value name="CSV_toplevel.CSVNPCfleetreset" operation="add" exact="1"/>
                  <reset_cue cue="CSV_NPC_Fleet_attackcpu"/>
                </do_all>
              </action>
            </cue>
          </cues>
        </cue>
      </cues>
    </cue>
    <cue name="CSV_CPU_DFP_top" library="1">
      <condition>
        <object_exists object="CSV_toplevel.CafeCPU"/>
      </condition>
      <cues>
        <cue name="CSV_CPU_DFP_check">
          <condition>
            <check_all>
              <count_ships class="ship" race="player" min="1">
                <position object="CSV_toplevel.CafeCPU"/>
                <sector sector="{object.sector@CSV_toplevel.CafeCPU}"/>
                <distance max="15km"/>
              </count_ships>
            </check_all>
          </condition>
          <action>
            <do_all>
              <find_ship group="CSV_CPU_DFP_check.DFPships" race="player">
                <position object="CSV_toplevel.CafeCPU"/>
                <sector sector="{object.sector@CSV_toplevel.CafeCPU}"/>
                <distance max="15km"/>
              </find_ship>
              <destroy_group group="CSV_CPU_DFP_check.DFPships" explosion="1"/>
            </do_all>
          </action>
          <cues>
            <cue name="CSV_CPU_DFP_check_reset" delay="689">
              <condition>
                <cue_is_complete cue="CSV_CPU_DFP_check"/>
              </condition>
              <action>
                <reset_cue cue="CSV_CPU_DFP_top"/>
              </action>
            </cue> 
          </cues>
        </cue>
      </cues>
    </cue>
    <cue name="CSV CPU Defence" library="1">
      <documentation>
        <content reference="CSV CPU Defence" name="Spawns and manages the CPU defence ships and player damage"/>
        <version number="1.0" date="03/08/2009" status="testing"/>
        <history>
          <change author="Owen Lake" date="01/01/2009" description="Initial version. Can't remember date."/>
          <change author="Owen Lake" date="03/08/2009" description="2.5 Beta 2 version"/>
          <change author="Jens" date="09/08/2009" description="Add textid value for CPU Defenders."/>
        </history>
      </documentation>
      <condition>
        <object_exists object="CSV_toplevel.CafeCPU"/>
      </condition>
      <cues>
        <cue name="CSV CPU Defence Create Terraformers" delay="60s" instantiate="static">
          <condition>
            <check_all>
              <check_value value="{group.object.count@CSV_toplevel.CPU Defenders}" max="50"/>
              <check_value value="{player.sector}" exact="{object.sector@CSV_toplevel.CafeCPU}"/>
            </check_all>
          </condition>
          <action>
            <do_all>
              <reset_cue cue="CSV CPU Defence Player Leaves"/>
              <do_all exact="50-{group.object.count@CSV_toplevel.CPU Defenders}">
                <do_any>
                  <do_all chance="5">
                    <set_value name="this.Typename" exact="{lookup.type@SS_SH_TERRAFORMER2}"/>
                    <set_value name="this.Textid" exact="90811"/>
                  </do_all>
                  <do_all chance="3">
                    <set_value name="this.Typename" exact="{lookup.type@SS_SH_TERRAFORMER3}"/>
                    <set_value name="this.Textid" exact="90821"/>
                  </do_all>
                  <do_all chance="1">
                    <set_value name="this.Typename" exact="{lookup.type@SS_SH_TERRAFORMER4}"/>
                    <set_value name="this.Textid" exact="90831"/>
                  </do_all>
                </do_any>
                <create_ship group="CSV_toplevel.CPU Defenders" typename="{value@this.Typename}" capturable="0" race="xenon" racelogic="0" textid="{value@this.Textid}" warp="1">
                  <position object="CSV_toplevel.CafeCPU" max="5km"/>
                  <sector sector="{object.sector@CSV_toplevel.CafeCPU}"/>
                  <equipment loadout="maximum" loadoutmask="lasers|shields|missiles"/>
                </create_ship>
              </do_all>
              <set_group_command group="CSV_toplevel.CPU Defenders" command="killenemiesrange">
                <position object="CSV_toplevel.CafeCPU"/>
                <sector sector="{object.sector@CSV_toplevel.CafeCPU}"/>
              </set_group_command>
            </do_all>
          </action>
        </cue>
        <cue name="CSV CPU Defence Player Close" delay="7s" instantiate="static" version="4">
          <condition>
            <check_all>
              <object_exists object="CSV_toplevel.CafeCPU"/>
              <object_position max="13km">
                <position object="CSV_toplevel.CafeCPU"/>
              </object_position>
            </check_all>
          </condition>
          <action>
            <do_all>
              <do_any>
                <do_all chance="5">
                  <do_choose>
                    <do_when value="{player.ship.shields}" max="5">
                      <set_hull object="{player.ship}" exact="15" action="damage"/>
                    </do_when>
                    <do_otherwise>
                      <set_shield object="{player.ship}" exact="25" action="damage"/>
                    </do_otherwise>
                  </do_choose>
                </do_all>
                <set_value chance="3" name="this.temp" exact="1"/>
              </do_any>
              <do_choose>
                <do_when value="{group.object.count@CSV_toplevel.CPU Player Attackers}" max="20">
                  <do_all exact="5">
                    <create_ship group="CSV_toplevel.CPU Player Attackers" typename="SS_SH_TERRAFORMER2" capturable="0" race="xenon" racelogic="0" textid="90811" warp="1">
                      <sector sector="{object.sector@CSV_toplevel.CafeCPU}"/>
                      <equipment loadout="maximum" loadoutmask="lasers|shields|missiles"/>
                      <command command="killenemies"/>
                    </create_ship>
                  </do_all>
                </do_when>
                <do_otherwise>
                  <do_all exact="5">
                    <set_object name="this.WarpObject" value="{group.furthest@CSV_toplevel.CPU Player Attackers}"/>
                    <set_command object="this.WarpObject" command="none"/>
                    <warp_object object="this.WarpObject">
                      <position object="{player.ship}" exact="500m"/>
                    </warp_object>
                    <set_command object="this.WarpObject" command="killenemies"/>
                  </do_all>
                </do_otherwise>
              </do_choose>
            </do_all>
          </action>
        </cue>
        <cue name="CSV CPU Defence Player Leaves" delay="5s">
          <condition>
            <check_value value="{player.sector}" exact="{object.sector@CSV_toplevel.CafeCPU}" negate="1"/>
          </condition>
          <action>
            <destroy_group group="CSV_toplevel.CPU Player Attackers" warp="1"/>
          </action>
        </cue>
      </cues>
    </cue>
  </cues>
  <signature>e3zk4UXxRVKdTpCY0A8WSWsmstkSN7ZZPcJg82kVDxctVbGIcs+WlIucFCSqMFdzFKu84fBixPDZBUGvQddLUtOEUdcRxczVYHq+Ml+izjLbg76u+1fk9vK5ckPeGQozuHq9uXu/SJ1o7ei1iiNQPwh7OVzRKWyMiLecfBP41bmc0WhnvfpDylKrI7D2542HktPAmkTWwgmxwp/Inlfzwufxuu4nsMxBcJ3Sr8k6cXReXzR6y8ACiTJ7HiXVK2jU9O2PxQAEHC3kLwmLz5q2D3D5btKO2lbe77WaTpcg1RvlCSXjh2EG49ZQHDbvqhgg+nCOsPFTopTG99Uc5b48Pw==</signature>
</director>