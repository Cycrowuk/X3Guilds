<?xml version="1.0" encoding="utf-8" ?>
<?xml-stylesheet href="director.xsl" type="text/xsl" ?>
<director name="test" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="director.xsd">
  <documentation>
    <author name="Ketraar" alias="Ketraar" contact="Forums"/>
    <content reference="KTH" name="Treasure Hunt" description="Treasure Hunt Mission" />
    <version number="1.0" date="25/05/2009" status="release"/>
  </documentation>
  <cues>
    <cue name="KTH_Message">
      <documentation>
        <history>
          <change author="Owen Lake" date="21/12/2008" description="Improved base version. Added delay attributes. Added cue localisation to all actors, groups, object and values.
                  Removed stationary object position checking library and reworked it to use a group instead. Removed redundent extra do_all and check_all tags.
                  Removed redundent extra { and } around some text. Reworked some conditions to be more efficiant."/>
          <change author="Ketraar" date="15/01/2009" description="Ammended actors names as some were missing the KTH prefix"/>
          <change author="Ketraar" date="17/01/2009" description="Removed race atribute and pilot name for Yaki ship.
                  Added additional sectorcheck for cue KTHsectorchange_without_offer to make sure this only triggers when player leaves sector.
                  Added destroy actor to KTHoffer_rejected and KTHsectorchange_without_offer cue to prevent having multiple characters when reseting toplevel.
                  Removed object_changed_sector check in cue KTHofferbuckz and added delay of 2s."/>
          <change author="Ketraar" date="20/01/2009" description="Removed pop=1 for all incomming messages.
                  Added final start conditions, but commented out for testing purpouses.
                  Added text ID for (Treasure Hunter).
                  Removed (Bar Tender) from Teladi actor name (Ceo's Buckzoid), guides already states who to talk to."/>
          <change author="Ketraar" date="22/01/2009" description="Made some minor addjustments to following cues:
                  KTHeighthhint_scan, KTHfinalinstructions_objective, KTHfinalinstructions_accept, KTHfinaloffer_accept. Added new cue KTHfinalinstructions_destroy_wreck do to these changes."/>
        </history>
      </documentation>
      <condition>
        <check_all>
          <object_changed_sector/>
			<check_value value="{player.statistic.5020}" min="92"/>
          <check_age value="{player.age}" min="{value@Player Patch Age}+10m"/>
          <match_sector race="argon|boron"/>
 		  <check_value value="{player.notoriety.teladi}" min="200"/>
		</check_all>
      </condition>
      <timing>
        <time exact="6s"/>
      </timing>
      <action>
        <incoming_message author="{random.pilot.argon}" text="{3214,64}"/>
      </action>
      <cues>
        <cue name="KTH_toplevel" delay="5s">
          <condition>
            <cue_is_complete cue="KTH_Message"/>
          </condition>
          <action>
            <do_all>
              <do_any>
                <find_sector name="KTH_toplevel.KTHyaki1sthintsector" x="0" y="11"/>
                <find_sector name="KTH_toplevel.KTHyaki1sthintsector" x="0" y="12"/>
                <find_sector name="KTH_toplevel.KTHyaki1sthintsector" x="0" y="13"/>
              </do_any>
              <find_sector name="KTH_toplevel.KTHhint1" x="1" y="7"/>
              <find_sector name="KTH_toplevel.KTHhint2" x="4" y="3"/>
              <find_sector name="KTH_toplevel.KTHhint3" x="11" y="8"/>
              <find_sector name="KTH_toplevel.KTHhint4" x="8" y="7"/>
              <find_sector name="KTH_toplevel.KTHhint5" x="0" y="10"/>
              <find_sector name="KTH_toplevel.KTHhint6" x="2" y="6"/>
              <find_sector name="KTH_toplevel.KTHhint7" x="1" y="3"/>
              <find_sector name="KTH_toplevel.KTHhint8" x="7" y="4"/>
              <find_sector name="KTH_toplevel.KTHwreck" x="5" y="8"/>
              <find_sector name="KTH_toplevel.KTMwrecksector" x="5" y="8"/>
              <find_station name="KTH_toplevel.KTHshipyard" race="argon" class="shipyard">
                <sector x="2" y="4"/>
              </find_station>
              <do_if value="{object.exists@KTH_toplevel.KTHshipyard}" exact="0">
                <find_station name="KTH_toplevel.KTHshipyard" race="argon" class="shipyard">
                  <sector x="0" y="0"/>
                  <jumps max="100"/>
                </find_station>
                <do_if value="{object.exists@KTH_toplevel.KTHshipyard}" exact="0">
                  <create_station name="KTH_toplevel.KTHshipyard" typename="SS_FAC_A_SHIP" race="argon">
                    <sector x="2" y="4"/>
                    <equipment loadout="default"/>
                  </create_station>
                </do_if>
              </do_if>
              <set_sector name="KTH_toplevel.KTHshipyardsector" value="{object.sector@KTH_toplevel.KTHshipyard}"/>
              <set_invincible object="KTH_toplevel.KTHshipyard" invincible="1"/>

              <find_sector name="KTH_toplevel.KTHoffersector1" x="3" y="7"/>
              <find_sector name="KTH_toplevel.KTHoffersector2" x="4" y="4"/>
              <find_sector name="KTH_toplevel.KTHoffersector3" x="3" y="4"/>
              <find_sector name="KTH_toplevel.KTHoffersector4" x="4" y="3"/>
              <find_sector name="KTH_toplevel.KTHoffersector5" x="4" y="6"/>
              <find_sector name="KTH_toplevel.KTHoffersector6" x="4" y="8"/>
              <find_sector name="KTH_toplevel.KTHoffersector7" x="5" y="7"/>
              <find_sector name="KTH_toplevel.KTHoffersector8" x="6" y="7"/>
              <do_all exact="8" counter="count">
				  <find_station group="KTH_toplevel.KTHpotentialofferstationgroup" race="default|pirate" class="station" dockingallowed="1">
					  <sector sector="KTH_toplevel.KTHoffersector{counter@count}"/>
				  </find_station>
			  </do_all>
              <do_choose>
                <do_when value="{group.object.count@KTH_toplevel.KTHpotentialofferstationgroup}" exact="0">
                  <set_value name="this.RandomSectorValue" min="1" max="8"/>
                  <set_sector name="KTH_toplevel.KTHoffersector" value="{sector@KTH_toplevel.KTHoffersector{value@this.RandomSectorValue}}"/>
                  <create_station name="KTH_toplevel.KTHofferstation" typename="SS_FAC_A_POWER" race="{random.race@default}" invincible="1">
                    <position x="0" y="0" z="0" max="30km" height="10km"/>
                    <sector sector="KTH_toplevel.KTHoffersector"/>
                    <equipment loadout="default"/>
                    <secondaryresources>
                      <ware typename="SS_WARE_TECH205" min="10" max="60"/>
                    </secondaryresources>
                    <products>
                      <ware typename="SS_WARE_ENERGY" min="1000" max="2000"/>
                    </products>
                  </create_station>
                </do_when>
                <do_otherwise>
                  <set_object name="KTH_toplevel.KTHofferstation" value="{group.object.random@KTH_toplevel.KTHpotentialofferstationgroup}"/>
                  <set_sector name="KTH_toplevel.KTHoffersector" value="{object.sector@KTH_toplevel.KTHofferstation}"/>
                  <set_invincible object="KTH_toplevel.KTHofferstation" invincible="1"/>
                </do_otherwise>
              </do_choose>
              <create_actor name="KTH_toplevel.KTHfirsthintactor" character="{random.pilot.goner}"/>
              <do_if value="{object.exists@KTH_toplevel.KTHofferstation}" exact="0">
                <reset_cue cue="KTH_toplevel"/>
              </do_if>
              
              <!--These value resets are useful for reseting the mission.-->
              <set_value name="this.KTHYakicheck" exact="0"/>
              <set_value name="this.KTHbuckzlink" exact="0"/>
              <set_value name="this.KTH2ndhintlink" exact="0"/>
              <set_value name="this.KTH3rdhintlink" exact="0"/>
              <set_value name="this.KTH4rdhintlink" exact="0"/>
              <set_value name="this.KTH5thhintlink" exact="0"/>
              <set_value name="this.KTH6thhintlink" exact="0"/>
              <set_value name="this.KTH7thhintlink" exact="0"/>
              <set_value name="this.KTH8thhintlink" exact="0"/>
              <set_value name="this.KTHfindwrecklink" exact="0"/>
              <set_value name="this.KTHfinalofferlink" exact="0"/>
              <set_value name="this.KTHfinalofferofferlink" exact="0"/>
              <set_value name="this.KTHcleanuplink" exact="0"/>
              <set_value name="this.KTHLifesupportcheck" exact="0"/>
              <set_value name="this.KTHRescueabort" exact="0"/>
              <set_value name="this.KTHcargospcacheck" exact="0"/>
              <set_value name="this.KTHcrewdelivercheck" exact="0"/>
              <set_value name="this.KTHYakiconversationcount" exact="0"/>
              <set_value name="this.KTHYakiSatcheck" exact="0"/>
              <set_value name="KTH_toplevel.KTHOfferSectorJumpCount" exact="0"/>
              <set_value name="KTH_toplevel.KTHOfferResetMission" exact="0"/>
            </do_all>
          </action>
          <cues>
            <cue name="KTH_create_offer">
              <condition>
                <check_all>
                  <object_changed_sector/>
                  <object_sector object="{player.ship}" exact="0">
                    <sector sector="KTH_toplevel.KTHoffersector"/>
                  </object_sector>
                </check_all>
              </condition>
              <action>
                <do_all>
                  <create_actor name="KTH_toplevel.KTHofferactor" character="{3895,67} {3214,50}" race="teladi" voice="510" face="501" object="KTH_toplevel.KTHofferstation" location="crew" invincible="1"/>
                  <create_offer actor="KTH_toplevel.KTHofferactor" conversation="L2OfferFindHard" discipline="XXXXP" cue="KTH_create_offer"/>
                  <create_briefing cue="KTH_create_offer" title="{3214,1}" text="{3214,2}" background="station_argon_space_fuel_distillery.tga">
                    <mission discipline="XXXT" level="easy"/>
                    <objectives>
                      <objective step="1" background="station_argon_space_fuel_distillery.tga">
                        <custom action="{35,2074}" text="{3214,4}"/>
                      </objective>
                    </objectives>
                  </create_briefing>
                  <set_value name="KTH_toplevel.KTHOfferSectorJumpLimit" exact="3"/>
                </do_all>
              </action>
              <cues>
                <cue name="KTH_offer_sector_jump_counter" instantiate="static">
                  <condition>
                    <check_all>
                      <object_changed_sector/>
                      <check_value value="{player.sector}" exact="{sector@KTH_toplevel.KTHoffersector}" negate="1"/>
                    </check_all>
                  </condition>
                  <action>
                    <do_all>
                      <set_value name="KTH_toplevel.KTHOfferSectorJumpCount" operation="add"/>
                      <do_if value="{value@KTH_toplevel.KTHOfferSectorJumpCount}" min="{value@KTH_toplevel.KTHOfferSectorJumpLimit}">
                        <remove_offer actor="KTH_toplevel.KTHofferactor" conversation="L2OfferFindHard" discipline="XXXXP"/>
                        <destroy_actor actor="KTH_toplevel.KTHofferactor"/>
                        <set_invincible object="KTH_toplevel.KTHshipyard" invincible="0"/>
                        <set_invincible object="KTH_toplevel.KTHofferstation" invincible="0"/>
                        <set_value name="KTH_toplevel.KTHOfferResetMission" exact="1"/>
                        <cancel_cue cue="KTH_offer_sector_jump_counter" instantiate="static"/>
                      </do_if>
                    </do_all>
                  </action>
                </cue>
                <cue name="KTHoffer_left_sector_reset" delay="1m">
                  <condition>
                    <check_value value="{value@KTH_toplevel.KTHOfferResetMission}" exact="1"/>
                  </condition>
                  <timing>
                    <time min="60m" max="120m"/>
                  </timing>
                  <action>
                    <reset_cue cue="KTH_toplevel"/>
                  </action>
                </cue>
                <cue name="KTHoffer_rejected">
                  <condition>
                    <conversation_completed actor="KTH_toplevel.KTHofferactor" conversation="L2OfferFindHard" answer="reject"/>
                  </condition>
                  <action>
                    <set_value name="KTH_toplevel.KTHOfferSectorJumpLimit" exact="1"/>
                  </action>
                </cue>
                <cue name="KTH_offer_accepted_but_no_credits" instantiate="static">
                  <condition>
                    <check_all>
                      <conversation_completed actor="KTH_toplevel.KTHofferactor" conversation="L2OfferFindHard" answer="accept"/>
                      <check_value value="{player.money}" max="49999"/>
                    </check_all>
                  </condition>
                  <action>
                    <do_all>
                      <do_if value="{player.age}" min="{value@KTH_toplevel.KHTRejectedLogTime}+60">
                        <do_choose>
                          <do_when value="{value@KTH_toplevel.KHTRejectedLogTime}" min="1">
                            <incoming_message author="{actor.name@KTH_toplevel.KTHofferactor}" text="{3214,24}"/>
                          </do_when>
                          <do_otherwise>
                            <!--Don't spam the log if the player has already recieved one.-->
                            <incoming_message author="{actor.name@KTH_toplevel.KTHofferactor}" text="{3214,24}" temporary="1"/>
                          </do_otherwise>
                        </do_choose>
                        <set_value name="KTH_toplevel.KHTRejectedLogTime" exact="{player.age}"/>
                      </do_if>
                      <set_value name="KTH_toplevel.KTHOfferSectorJumpLimit" exact="7"/>
                    </do_all>
                  </action>
                </cue>
                <cue name="KTH_offer_accepted">
                  <condition>
                    <check_all>
                      <conversation_completed actor="KTH_toplevel.KTHofferactor" conversation="L2OfferFindHard" answer="accept"/>
                      <check_value value="{player.money}" min="50000"/>
                    </check_all>
                  </condition>
                  <action>
                    <do_all>
                      <reward_player>
                        <money exact="-50000" transactionid="34" transactionpage="9619"/>
                        <map>
                          <sector sector="KTH_toplevel.KTHyaki1sthintsector"/>
                        </map>
                      </reward_player>
                      <remove_offer actor="KTH_toplevel.KTHofferactor" conversation="L2OfferFindHard" discipline="XXXXP"/>
                      <cancel_cue cue="KTH_offer_sector_jump_counter"/>
                      <create_ship name="KTH_toplevel.KTHyakiship" race="neutral" highlight="1" invincible="1" typename="SS_SH_Y_M3_PROTO" boardable="0" capturable="0">
                        <position x="0" y="0" z="0" min="50km" max="70km"/>
                        <sector sector="KTH_toplevel.KTHyaki1sthintsector"/>
                        <equipment loadout="maximum"/>
                        <pilot shipname="{3214,5}"/>
                      </create_ship>
                      <create_actor name="KTH_toplevel.KTHyakiactor" race="yaki" subrace="argon" character="{3895,68}" object="KTH_toplevel.KTHyakiship" location="pilot" voiceflags="32" invincible="1"/>
                      <set_racelogic object="KTH_toplevel.KTHyakiship" racelogic="0"/>
						<set_owner object="KTH_toplevel.KTHyakiship" race="{lookup.race@teladi}"/>
						<set_relation object="KTH_toplevel.KTHyakiship">
							<relation object="{player.ship}" mutual="1" relation="neutral"/>
						</set_relation>
						<set_command object="KTH_toplevel.KTHyakiship" command="idle"/>
                      <create_stationary name="KTH_toplevel.YakiSat" race="neutral" invincible="1" typename="SS_SH_SAT2">
                        <position object="KTH_toplevel.KTHyakiship" min="5km" max="7km"/>
                        <sector sector="KTH_toplevel.KTHyaki1sthintsector"/>
                      </create_stationary>
                      <set_value name="KTH_toplevel.YakiSatx" exact="{object.position.x@KTH_toplevel.YakiSat}"/>
                      <set_value name="KTH_toplevel.YakiSaty" exact="{object.position.y@KTH_toplevel.YakiSat}"/>
                      <set_value name="KTH_toplevel.YakiSatz" exact="{object.position.z@KTH_toplevel.YakiSat}"/>
                      <do_all min="2" max="5">
                        <create_stationary group="KTH_toplevel.YakiOLGroup" race="neutral" invincible="1" typename="SS_SH_ORBITALLASER">
                          <position object="KTH_toplevel.KTHyakiship" min="5km" max="10km"/>
                          <sector sector="KTH_toplevel.KTHyaki1sthintsector"/>
                        </create_stationary>
                      </do_all>
                      <do_all min="5" max="10">
                        <create_stationary group="KTH_toplevel.YakiMines" race="neutral" invincible="1" typename="SS_SH_MINE_1" active="0">
                          <position object="KTH_toplevel.KTHyakiship" min="10km" max="15km"/>
                          <sector sector="KTH_toplevel.KTHyaki1sthintsector"/>
                        </create_stationary>
                      </do_all>
                    </do_all>
                  </action>
                  <cues>
                    <cue name="KTH_Order_Yakiship" delay="30s">
                      <condition>
                        <check_all>
                          <object_exists object="KTH_toplevel.KTHyakiship"/>
                          <object_position object="KTH_toplevel.KTHyakiship" min="5km">
                            <position x="{value@KTH_toplevel.YakiSatx}" y="{value@KTH_toplevel.YakiSaty}" z="{value@KTH_toplevel.YakiSatz}"/>
                          </object_position>
                        </check_all>
                      </condition>
                      <action>
                        <set_command object="KTH_toplevel.KTHyakiship" command="movecontinue">
                          <position x="{value@KTH_toplevel.YakiSatx}" y="{value@KTH_toplevel.YakiSaty}" z="{value@KTH_toplevel.YakiSatz}"/>
                          <sector sector="KTH_toplevel.KTHyaki1sthintsector"/>
                        </set_command>
                      </action>
                      <cues>
                        <cue name="KTH_Order_Yakiship_Reset">
                          <timing>
                            <time exact="3m"/>
                          </timing>
                          <action>
                            <do_all>
                              <set_command object="KTH_toplevel.KTHyakiship" command="idle"/>
                              <reset_cue cue="KTH_Order_Yakiship"/>
                            </do_all>
                          </action>
                        </cue>
                      </cues>
                    </cue>
                    <cue name="KTHincoming_Yakibriefing">
                      <timing>
                        <time exact="2s"/>
                      </timing>
                      <action>
                        <do_all>
                          <create_briefing cue="KTH_create_offer" title="{3214,1}" text="{3214,6}">
                            <mission discipline="XXXT" level="average"/>
                            <objectives>
                              <objective step="2">
                                <talkto actor="KTH_toplevel.KTHyakiactor"/>
                              </objective>
                            </objectives>
                          </create_briefing>
                          <set_objective cue="KTH_create_offer" title="{3214,1}" text="{3214,6}" noabort="1">
                            <briefing cue="KTH_create_offer" step="2"/>
                            <mission discipline="XXXT" level="average"/>
                            <talkto actor="KTH_toplevel.KTHyakiactor"/>
                          </set_objective>
                          <create_offer actor="KTH_toplevel.KTHyakiactor" conversation="yakicontact" cue="KTHincoming_Yakibriefing" discipline="XXXT"/>
                        </do_all>
                      </action>
                      <cues>
                        <cue name="KTHmeet_yaki_attempt_counter" instantiate="static">
                          <condition>
                            <conversation_completed actor="KTH_toplevel.KTHyakiactor" conversation="yakicontact" answer="accept"/>
                          </condition>
                          <action>
                            <set_value name="KTH_toplevel.KTHYakiconversationcount" operation="add"/>
                          </action>
                        </cue>
                        <cue name="KTHmeet_yaki" delay="1s">
                          <condition>
                            <check_value value="{value@KTH_toplevel.KTHYakiconversationcount}" min="2"/>
                          </condition>
                          <action>
                            <do_all>
                              <remove_offer actor="KTH_toplevel.KTHyakiactor" conversation="yakicontact" discipline="XXXT"/>
                              <set_communicates object="KTH_toplevel.KTHyakiship" communicates="0"/>
                              <set_invincible object="KTH_toplevel.YakiSat" invincible="0"/>
                              <create_briefing cue="KTH_create_offer" title="{3214,1}" text="{3214,6}">
                                <mission discipline="XFXX" level="easy"/>
                                <objectives>
                                  <objective step="3">
                                    <custom action="{35,2004}" text="{object.name@KTH_toplevel.YakiSat}" object="KTH_toplevel.YakiSat" icon="destroy"/>
                                  </objective>
                                </objectives>
                              </create_briefing>
                              <set_objective cue="KTH_create_offer" title="{3214,1}" text="{3214,6}" noabort="1">
                                <briefing cue="KTH_create_offer" step="3"/>
                                <mission discipline="XFXX" level="easy"/>
                                <custom action="{35,2004}" text="{object.name@KTH_toplevel.YakiSat}" object="KTH_toplevel.YakiSat" icon="destroy"/>
                              </set_objective>
                            </do_all>
                          </action>
                          <cues>
                            <cue name="KTHpersuade_yaki_Sat" delay="1s">
                              <condition>
                                <object_exists object="KTH_toplevel.YakiSat" negate="1"/>
                              </condition>
                              <action>
                                <do_all>
                                  <set_object name="KTH_toplevel.YakiOL" value="{group.object.random@KTH_toplevel.YakiOLGroup}"/>
                                  <set_group_invincible group="KTH_toplevel.YakiOLGroup" invincible="0"/>
                                  <set_group_relation group="KTH_toplevel.YakiOLGroup">
                                    <relation object="{player.ship}" relation="enemy"/>
                                  </set_group_relation>
                                  <create_briefing cue="KTH_create_offer" title="{3214,1}" text="{3214,6}">
                                    <mission discipline="XXXT" level="average"/>
                                    <objectives>
                                      <objective step="4">
                                        <custom action="{35,2004}" text="{object.name@KTH_toplevel.YakiOL}" object="KTH_toplevel.YakiOL" icon="destroy"/>
                                      </objective>
                                    </objectives>
                                  </create_briefing>
                                  <set_objective cue="KTH_create_offer" title="{3214,1}" text="{3214,6}" noabort="1">
                                    <briefing cue="KTH_create_offer" step="4"/>
                                    <mission discipline="XXXT" level="average"/>
                                    <custom action="{35,2004}" text="{object.name@KTH_toplevel.YakiOL}" object="KTH_toplevel.YakiOL" icon="destroy"/>
                                  </set_objective>
                                </do_all>
                              </action>
                              <cues>
                                <cue name="KTHpersuade_yaki_OL" delay="1s">
                                  <condition>
                                    <object_exists object="KTH_toplevel.YakiOL" negate="1"/>
                                  </condition>
                                  <timing>
                                    <time exact="2s"/>
                                  </timing>
                                  <action>
                                    <do_all>
                                      <set_group_relation group="KTH_toplevel.YakiOLGroup">
                                        <relation object="{player.ship}" relation="friend"/>
                                      </set_group_relation>
                                      <play_text priority="99" actor="KTH_toplevel.KTHyakiactor" textid="1"/>
                                    </do_all>
                                  </action>
                                  <cues>
                                    <cue name="KTHpersuade_yaki_deploySat">
                                      <condition>
                                        <cue_completed cue="KTHpersuade_yaki_OL"/>
                                      </condition>
                                      <timing>
                                        <time exact="{text.duration@{actor.voice@KTH_toplevel.KTHyakiactor},1}+2s"/>
                                      </timing>
                                      <action>
                                        <do_all>
                                          <set_communicates object="KTH_toplevel.KTHyakiship" communicates="1"/>
                                          <incoming_message author="{actor.name@KTH_toplevel.KTHyakiactor}" text="{3214,67}"/>
                                          <create_stationary name="KTH_toplevel.YakiSatbeacon" class="beacon" race="none" invincible="1" typename="SS_SH_BEACON">
                                            <position x="{value@KTH_toplevel.YakiSatx}" y="{value@KTH_toplevel.YakiSaty}" z="{value@KTH_toplevel.YakiSatz}" max="1km"/>
                                            <sector sector="KTH_toplevel.KTHyaki1sthintsector"/>
                                          </create_stationary>
                                          <create_briefing cue="KTH_create_offer" title="{3214,1}" text="{3214,6}">
                                            <mission discipline="XXXT" level="average"/>
                                            <objectives>
                                              <objective step="5">
                                                <custom action="{35,2061}" text="{lookup.type.name@SS_SH_SAT2}" guidance="KTH_toplevel.YakiSatbeacon" icon="build"/>
                                              </objective>
                                            </objectives>
                                          </create_briefing>
                                          <set_objective cue="KTH_create_offer" title="{3214,1}" text="{3214,6}" noabort="1">
                                            <briefing cue="KTH_create_offer" step="5"/>
                                            <mission discipline="XXXT" level="average"/>
                                            <custom action="{35,2061}" text="{lookup.type.name@SS_SH_SAT2}" guidance="KTH_toplevel.YakiSatbeacon" icon="build"/>
                                          </set_objective>
                                        </do_all>
                                      </action>
                                      <cues>
                                        <cue name="KTHpersuade_yaki_Satdeployed">
                                          <condition>
                                            <check_all>
                                              <object_ejected/>
                                              <cue_is_complete cue="KTHpersuade_yaki_deploySat"/>
                                            </check_all>
                                          </condition>
                                          <action>
                                            <do_all>
                                              <find_object name="this.Yakisat2count" typename="SS_SH_SAT2" race="player">
                                                <position object="KTH_toplevel.YakiSatbeacon"/>
                                                <sector sector="KTH_toplevel.KTHyaki1sthintsector"/>
                                                <distance max="2km"/>
                                              </find_object>
                                              <do_choose>
                                                <do_when value="{object.exists@this.Yakisat2count}" min="1">
                                                  <destroy_object object="KTH_toplevel.YakiSatbeacon" explosion="0"/>
                                                  <set_owner object="this.Yakisat2count" race="neutral"/>
                                                  <incoming_message author="{actor.name@KTH_toplevel.KTHyakiactor}" text="{3214,13}"/>
                                                  <remove_briefing cue="KTH_create_offer"/>
                                                  <remove_objective cue="KTH_create_offer"/>
                                                  <create_briefing cue="KTHpersuade_yaki_Satdeployed" title="{3214,1}" text="{3214,23}" background="station_argon_space_fuel_distillery.tga">
                                                    <mission discipline="XXXT" level="average"/>
                                                    <objectives>
                                                      <objective step="1">
                                                        <custom action="{3214,22}" text="{3214,14}"/>
                                                      </objective>
                                                    </objectives>
                                                  </create_briefing>
                                                  <set_objective cue="KTHpersuade_yaki_Satdeployed" title="{3214,1}" text="{3214,23}" noabort="1">
                                                    <briefing cue="KTHpersuade_yaki_Satdeployed" step="1"/>
                                                    <mission discipline="XXXT" level="average"/>
                                                    <custom action="{3214,22}" text="{3214,14}"/>
                                                  </set_objective>
                                                  <set_value name="KTH_toplevel.KTHbuckzlink" exact="1"/>
                                                </do_when>
                                                <do_otherwise>
                                                  <reset_cue cue="KTHpersuade_yaki_Satdeployed"/>
                                                </do_otherwise>
                                              </do_choose>
                                            </do_all>
                                          </action>
                                        </cue>
                                      </cues>
                                    </cue>
                                  </cues>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>
            <!--first hint prepare-->
            <cue name="KTHfirsthint" delay="959">
              <condition>
                <check_value value="{value@KTH_toplevel.KTHbuckzlink}" exact="1"/>
              </condition>
              <action>
                <create_asteroid name="KTH_toplevel.KTHhint1Asteroid" typename="SS_ASTEROID_03" invincible="1" minable="0">
                  <position x="10km" y="5km" z="44km"/>
                  <sector sector="KTH_toplevel.KTHhint1"/>
                  <resource exact="55" typename="SS_WARE_NIVIDIUM2"/>
                </create_asteroid>
              </action>
              <cues>
                <cue name="KTHfirsthint_Scanobject" delay="3s">
                  <condition>
                    <object_position max="10km">
                      <position object="KTH_toplevel.KTHhint1Asteroid"/>
                    </object_position>
                  </condition>
                  <action>
                    <do_all>
                      <destroy_actor actor="KTH_toplevel.KTHfirsthintactor"/>
                      <cancel_cue cue="KTH_Order_Yakiship"/>
                      <set_actor_invincible actor="KTH_toplevel.KTHyakiactor" invincible="0"/>
                      <destroy_object object="KTH_toplevel.KTHyakiship" warp="1"/>
                      <play_text pageid="13" textid="2001"/>
                    </do_all>
                  </action>
                  <cues>
                    <cue name="KTHfirsthint_Scanobject_complete">
                      <condition>
                        <cue_completed cue="KTHfirsthint_Scanobject"/>
                      </condition>
                      <timing>
                        <time exact="10s"/>
                      </timing>
                      <action>
                        <play_text>
                          <line pageid="13" textid="2002"/>
                          <line pageid="13" textid="1332"/>
                        </play_text>
                      </action>
                      <cues>
                        <cue name="KTHfirsthint_Scanobject_message">
                          <condition>
                            <cue_completed cue="KTHfirsthint_Scanobject_complete"/>
                          </condition>
                          <timing>
                            <time exact="5s"/>
                          </timing>
                          <action>
                            <do_all>
                              <incoming_message author="{3214,34}" text="{3214,25}"/>
                              <set_invincible object="KTH_toplevel.KTHhint1Asteroid" invincible="0"/>
                              <create_briefing cue="KTHpersuade_yaki_Satdeployed">
                                <objectives>
                                  <objective step="2">
                                    <destroy object="KTH_toplevel.KTHhint1Asteroid"/>
                                  </objective>
                                </objectives>
                              </create_briefing>
                              <set_objective cue="KTHpersuade_yaki_Satdeployed" noabort="1">
                                <briefing cue="KTHpersuade_yaki_Satdeployed" step="2"/>
                                <destroy object="KTH_toplevel.KTHhint1Asteroid"/>
                              </set_objective>
                            </do_all>
                          </action>
                          <cues>
                            <cue name="KTHfirsthint_Scanobject_destroyed">
                              <condition>
                                <object_exists object="KTH_toplevel.KTHhint1Asteroid" negate="1"/>
                              </condition>
                              <timing>
                                <time exact="1s"/>
                              </timing>
                              <action>
                                <do_all>
                                  <create_crate name="KTH_toplevel.Crate" invincible="1" discoverypoints="10000">
                                    <position x="10km" y="5km" z="44km"/>
                                    <sector sector="KTH_toplevel.KTHhint1"/>
                                    <ware exact="1" typename="SS_WARE_LOGBOOK"/>
                                  </create_crate>
									<set_discoverable object="KTH_toplevel.Crate" discoverable="1" distance="60000"/>
									<create_briefing cue="KTHpersuade_yaki_Satdeployed">
                                    <objectives>
                                      <objective step="2">
                                        <custom action="{35,2042}" text="{object.name@KTH_toplevel.Crate}" object="KTH_toplevel.Crate"/>
                                      </objective>
                                    </objectives>
                                  </create_briefing>
                                  <set_objective cue="KTHpersuade_yaki_Satdeployed" noabort="1">
                                    <briefing cue="KTHpersuade_yaki_Satdeployed" step="2"/>
                                    <custom action="{35,2042}" text="{object.name@KTH_toplevel.Crate}" object="KTH_toplevel.Crate"/>
                                  </set_objective>
                                </do_all>
                              </action>
                              <cues>
                                <cue name="KTHfirsthint_cratecollected" delay="2s">
                                  <condition>
                                    <check_all>
                                      <cue_is_complete cue="KTHfirsthint_Scanobject_destroyed"/>
                                      <object_exists object="KTH_toplevel.Crate" negate="1"/>
                                    </check_all>
                                  </condition>
                                  <timing>
                                    <time exact="2s"/>
                                  </timing>
                                  <action>
                                    <do_all>
                                      <create_actor name="KTH_toplevel.KTHsecondhintactor" character="{random.pilot.argon}"/>
                                      <!--
                                  <incoming_message author="{actor.name@KTH_toplevel.KTHsecondhintactor}" text="{3214,26}"/>
                                  -->
                                      <remove_briefing cue="KTHpersuade_yaki_Satdeployed"/>
                                      <remove_objective cue="KTHpersuade_yaki_Satdeployed"/>
                                      <create_briefing cue="KTHpersuade_yaki_Satdeployed" title="{3214,1}" text="{3214,26}" background="part_1.tga">
                                        <mission discipline="XXXT" level="hard"/>
                                        <objectives>
                                          <objective step="1">
                                            <custom action="{3214,22}" text="{3214,15}"/>
                                          </objective>
                                        </objectives>
                                      </create_briefing>
                                      <set_objective cue="KTHpersuade_yaki_Satdeployed" title="{3214,1}" text="{3214,26}" noabort="1">
                                        <briefing cue="KTHpersuade_yaki_Satdeployed" step="1"/>
                                        <mission discipline="XXXT" level="hard"/>
                                        <custom action="{3214,22}" text="{3214,15}"/>
                                      </set_objective>
                                      <set_value name="KTH_toplevel.KTH2ndhintlink" exact="1"/>
                                    </do_all>
                                  </action>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>
            <!--second hint prepare-->
            <cue name="KTHsecondhint" delay="964">
              <condition>
                <check_value value="{value@KTH_toplevel.KTH2ndhintlink}" exact="1"/>
              </condition>
              <action>
                <do_all>
                  <create_crate name="KTH_toplevel.Crate" invincible="1" discoverypoints="10000">
                    <position x="25km" y="1km" z="50km"/>
                    <sector sector="KTH_toplevel.KTHhint2"/>
                    <ware exact="1" typename="SS_WARE_LOGBOOK"/>
                  </create_crate>
				<set_discoverable object="KTH_toplevel.Crate" discoverable="1" distance="60000"/>

					<create_actor name="KTH_toplevel.KTHthirdhintactor" character="{random.pilot.teladi}"/>
                </do_all>
              </action>
              <cues>
                <cue name="KTHsecondhint_collected" delay="3s">
                  <condition>
                    <object_exists object="KTH_toplevel.Crate" negate="1"/>
                  </condition>
                  <action>
                    <do_all>
                      <create_briefing cue="KTHpersuade_yaki_Satdeployed" title="{3214,1}" text="{3214,27}" background="part_2.tga">
                        <mission discipline="XXXT" level="average"/>
                        <objectives>
                          <objective step="1">
                            <custom action="{3214,22}" text="{3214,16}"/>
                          </objective>
                        </objectives>
                      </create_briefing>
                      <set_objective cue="KTHpersuade_yaki_Satdeployed" title="{3214,1}" text="{3214,27}" noabort="1">
                        <briefing cue="KTHpersuade_yaki_Satdeployed" step="1"/>
                        <mission discipline="XXXT" level="average"/>
                        <custom action="{3214,22}" text="{3214,16}"/>
                      </set_objective>
                      <set_value name="KTH_toplevel.KTH3rdhintlink" exact="1"/>
                    </do_all>
                  </action>
                </cue>
              </cues>
            </cue>
            <!--third hint prepare-->
            <cue name="KTHthirdhint" delay="987">
              <condition>
                <check_value value="{value@KTH_toplevel.KTH3rdhintlink}" exact="1"/>
              </condition>
              <action>
                <do_all>
                  <create_crate name="KTH_toplevel.Crate" invincible="1" discoverypoints="10000">
                    <position x="90km" y="0" z="0"/>
                    <sector sector="KTH_toplevel.KTHhint3"/>
                    <ware exact="1" typename="SS_WARE_DUMMY6"/>
                  </create_crate>
				<set_discoverable object="KTH_toplevel.Crate" discoverable="1" distance="60000"/>
					<create_actor name="KTH_toplevel.KTHfourthhintactor" character="{random.pilot.boron}"/>
                </do_all>
              </action>
              <cues>
                <cue name="KTHthirdhint_firstaproach" delay="3s">
                  <condition>
                    <object_position max="8km">
                      <position object="KTH_toplevel.Crate"/>
                    </object_position>
                  </condition>
                  <action>
                    <do_all>
                      <play_text>
                        <line pageid="13" textid="1271"/>
                        <line pageid="13" textid="1271"/>
                      </play_text>
                      <set_value name="this.DroneCount" exact="{value@Constant {player.ship.class} Points}+2"/>
                      <do_if value="{value@this.DroneCount}" min="23" comment="M5-M3, TS and TM">
                        <set_value name="this.DroneCount" exact="22"/>
                      </do_if>
                      <do_all exact="{value@this.DroneCount}">
                        <create_ship group="KTH_toplevel.KTHhint2drones" warp="1" race="enemy" typename="{random.type@SS_SH_FIGHTDRONE|SS_SH_A_MK2DRONE}" capturable="0">
                          <position object="KTH_toplevel.Crate" min="500m" max="1500m"/>
                          <sector sector="KTH_toplevel.KTHhint3"/>
                          <equipment loadout="maximum"/>
                          <command command="attack" commandobject="{player.ship}"/>
                        </create_ship>
                      </do_all>
                      <destroy_object object="KTH_toplevel.Crate" explosion="0"/>
                    </do_all>
                  </action>
                  <cues>
                    <cue name="KTHthirdhint_drones_destryed" delay="1s">
                      <condition>
                        <any_object_exists group="KTH_toplevel.KTHhint2drones" negate="1"/>
                      </condition>
                      <action>
                        <do_all>
                          <create_crate name="KTH_toplevel.Crate" invincible="1" discoverypoints="10000">
                            <position x="90km" y="0km" z="0km"/>
                            <sector sector="KTH_toplevel.KTHhint3"/>
                            <ware exact="1" typename="SS_WARE_LOGBOOK"/>
                          </create_crate>
                          <create_actor name="KTH_toplevel.KTHfourthintactor" character="{random.pilot.paranid}"/>
                        </do_all>
                      </action>
                      <cues>
                        <cue name="KTHthirdhint_collected" delay="2s">
                          <condition>
                            <check_all>
                              <cue_is_complete cue="KTHthirdhint_drones_destryed"/>
                              <object_exists object="KTH_toplevel.Crate" negate="1"/>
                            </check_all>
                          </condition>
                          <action>
                            <do_all>
                              <create_briefing cue="KTHpersuade_yaki_Satdeployed" title="{3214,1}" text="{3214,28}" background="part_3.tga">
                                <mission discipline="XXXT" level="average"/>
                                <objectives>
                                  <objective step="1">
                                    <custom action="{3214,22}" text="{3214,17}"/>
                                  </objective>
                                </objectives>
                              </create_briefing>
                              <set_objective cue="KTHpersuade_yaki_Satdeployed" title="{3214,1}" text="{3214,28}" noabort="1">
                                <briefing cue="KTHpersuade_yaki_Satdeployed" step="1"/>
                                <mission discipline="XXXT" level="average"/>
                                <custom action="{3214,22}" text="{3214,17}"/>
                              </set_objective>
                              <set_value name="KTH_toplevel.KTH4rdhintlink" exact="1"/>
                            </do_all>
                          </action>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>
            <!--fourth hint prepare-->
            <cue name="KTHfourthhint" delay="979">
              <condition>
                <check_value value="{value@KTH_toplevel.KTH4rdhintlink}" exact="1"/>
              </condition>
              <action>
                <do_all>
                  <find_object group="this.NPCstationarygroup" class="stationary" multiple="1" max="9999" race="all" typename="SS_SH_BEACON">
                    <sector sector="KTH_toplevel.KTHhint4"/>
                  </find_object>
                  <destroy_group group="this.NPCstationarygroup" explosion="0"/>
                  <do_all exact="6" counter="count">
                    <create_stationary name="KTH_toplevel.KTHstationary{counter@count}" group="KTH_toplevel.KTHstationary Group" highlight="1" typename="SS_SH_BEACON" race="abandoned" invincible="1">
                      <position x="0" y="0" z="0" min="30km" max="70km" height="40km"/>
                      <sector sector="KTH_toplevel.KTHhint4"/>
                    </create_stationary>
					<set_discoverable object="KTH_toplevel.KTHstationary{counter@count}" discoverable="1" distance="60000"/>
                  </do_all>
                  <create_stationary name="KTH_toplevel.KTHstationaryReal" highlight="1" typename="SS_SH_BEACON" race="abandoned" invincible="1">
                    <position x="0" y="0" z="0" min="30km" max="70km"/>
                    <sector sector="KTH_toplevel.KTHhint4"/>
                  </create_stationary>
					<set_discoverable object="KTH_toplevel.KTHstationaryReal" discoverable="1" distance="60000"/>
                </do_all>
              </action>
              <cues>
                <cue name="KTHfourthhint_appraoch_fake" delay="241" instantiate="static" comment="Using a random group member we avoid checking the position of all objects at the same time.">
                  <condition>
                    <check_all>
                      <check_value value="{group.object.count@KTH_toplevel.KTHstationary Group}" min="1"/>
                      <object_position object="{group.object.random@KTH_toplevel.KTHstationary Group}" max="8km">
                        <position object="{player.ship}"/>
                      </object_position>
                    </check_all>                    
                  </condition>
                  <action>
                    <do_all>
                      <play_text pageid="13" textid="1271"/>
                      <set_object name="this.Stationary" value="{group.nearest@KTH_toplevel.KTHstationary Group}"/>
                      <do_choose>
                        <do_when value="{player.ship.class}" exact="{lookup.class@m5}">
                          <do_all min="2" max="4">
                            <create_ship group="KTH_toplevel.KTHstationary Guards" race="xenon" warp="1" racelogic="0" typename="SS_SH_X_M5" capturable="0">
                              <position object="this.Stationary" max="1km"/>
                              <sector sector="KTH_toplevel.KTHhint4"/>
                              <equipment loadout="default"/>
                              <command command="attack" commandobject="{player.ship}"/>
                            </create_ship>
                          </do_all>
                        </do_when>
                        <do_when value="{player.ship.class}" exact="{lookup.class@m4}">
                          <do_all min="3" max="5">
                            <create_ship group="KTH_toplevel.KTHstationary Guards" race="xenon" warp="1" racelogic="0" typename="{random.type@SS_SH_X_M5|SS_SH_X_M4}" capturable="0">
                              <position object="this.Stationary" max="1km"/>
                              <sector sector="KTH_toplevel.KTHhint4"/>
                              <equipment loadout="default"/>
                              <command command="attack" commandobject="{player.ship}"/>
                            </create_ship>
                          </do_all>
                        </do_when>
                        <do_when value="{player.ship.class}" exact="{lookup.class@m3}">
                          <do_all min="5" max="7">
                            <create_ship group="KTH_toplevel.KTHstationary Guards" race="xenon" warp="1" racelogic="0" typename="{random.type@SS_SH_X_M5|SS_SH_X_M4|SS_SH_X_M3|SS_SH_X_M3P}" capturable="0">
                              <position object="this.Stationary" max="1km"/>
                              <sector sector="KTH_toplevel.KTHhint4"/>
                              <equipment loadout="default"/>
                              <command command="attack" commandobject="{player.ship}"/>
                            </create_ship>
                          </do_all>
                        </do_when>
                        <do_otherwise>
                          <do_all min="7" max="9">
                            <create_ship group="KTH_toplevel.KTHstationary Guards" race="xenon" warp="1" racelogic="0" typename="{random.type@SS_SH_X_M5|SS_SH_X_M4|SS_SH_X_M3|SS_SH_X_M3P|SS_SH_X_M6}" capturable="0">
                              <position object="this.Stationary" max="1km"/>
                              <sector sector="KTH_toplevel.KTHhint4"/>
                              <equipment loadout="default"/>
                              <command command="attack" commandobject="{player.ship}"/>
                            </create_ship>
                          </do_all>
                        </do_otherwise>
                      </do_choose>
                      <destroy_object object="this.Stationary" explosion="0"/>
                      <do_if value="{group.object.count@KTH_toplevel.KTHstationary Group}" exact="0">
                        <cancel_cue cue="KTHfourthhint_appraoch_fake" instantiate="static"/>
                      </do_if>
                    </do_all>
                  </action>
                </cue>
                <cue name="KTHfourthhint_appraoch_stat7" delay="2s">
                  <condition>
                    <object_position max="6km">
                      <position object="KTH_toplevel.KTHstationaryReal"/>
                    </object_position>
                  </condition>
                  <action>
                    <do_all>
                      <cancel_cue cue="KTHfourthhint_appraoch_fake"/>
                      <create_crate name="KTH_toplevel.Crate" invincible="1" discoverypoints="10000">
                        <position x="0" y="150km" z="0"/>
                        <sector sector="KTH_toplevel.KTHoffersector"/>
                        <ware exact="1" typename="SS_WARE_LOGBOOK"/>
                      </create_crate>
                      <play_text>
                        <line pageid="13" textid="1351"/>
                        <line pageid="13" textid="622"/>
                      </play_text>
                    </do_all>
                  </action>
                  <cues>
                    <cue name="KTHfourthhint_warp">
                      <condition>
                        <cue_completed cue="KTHfourthhint_appraoch_stat7"/>
                      </condition>
                      <timing>
                        <time exact="8s"/>
                      </timing>
                      <action>
                        <do_all>
                          <warp_player>
                            <position object="KTH_toplevel.Crate" min="5km" max="10km"/>
                            <sector sector="KTH_toplevel.KTHoffersector"/>
                          </warp_player>
                          <destroy_group group="KTH_toplevel.KTHstationary Guards" explosion="0"/>
                          <destroy_group group="KTH_toplevel.KTHstationary Group"/>
                          <set_target object="KTH_toplevel.Crate"/>
                        </do_all>
                      </action>
                      <cues>
                        <cue name="KTHfourthhint_collect" delay="2s">
                          <condition>
                            <object_exists object="KTH_toplevel.Crate" negate="1"/>
                          </condition>
                          <action>
                            <do_all>
                              <create_briefing cue="KTHpersuade_yaki_Satdeployed" title="{3214,1}" text="{3214,29}" background="part_4.tga">
                                <mission discipline="XXXT" level="hard"/>
                                <objectives>
                                  <objective step="1">
                                    <custom action="{3214,22}" text="{3214,18}"/>
                                  </objective>
                                </objectives>
                              </create_briefing>
                              <set_objective cue="KTHpersuade_yaki_Satdeployed" title="{3214,1}" text="{3214,29}" noabort="1">
                                <briefing cue="KTHpersuade_yaki_Satdeployed" step="1"/>
                                <mission discipline="XXXT" level="hard"/>
                                <custom action="{3214,22}" text="{3214,18}"/>
                              </set_objective>
                              <set_value name="KTH_toplevel.KTH5thhintlink" exact="1"/>
                            </do_all>
                          </action>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>
            <!--fifth hint prepare-->
            <cue name="KTHfifthhint" delay="988">
              <condition>
                <check_value value="{value@KTH_toplevel.KTH5thhintlink}" exact="1"/>
              </condition>
              <action>
				  <do_all>
                    <create_crate name="KTH_toplevel.Crate" invincible="1" discoverypoints="10000">
                        <position x="5km" y="-30km" z="65km"/>
                        <sector sector="KTH_toplevel.KTHhint5"/>
                        <ware exact="1" typename="SS_WARE_LOGBOOK"/>
                    </create_crate>
				    <set_discoverable object="KTH_toplevel.Crate" discoverable="1" distance="60000"/>
				  </do_all>
			  </action>
              <cues>
                <cue name="KTHfifthhint_collect" delay="2s">
                  <condition>
                    <object_exists object="KTH_toplevel.Crate" negate="1"/>
                  </condition>
                  <action>
                    <do_all>
                      <create_briefing cue="KTHpersuade_yaki_Satdeployed" title="{3214,1}" text="{3214,30}" background="part_5.tga">
                        <mission discipline="XXXT" level="easy"/>
                        <objectives>
                          <objective step="1">
                            <custom action="{3214,22}" text="{3214,19}"/>
                          </objective>
                        </objectives>
                      </create_briefing>
                      <set_objective cue="KTHpersuade_yaki_Satdeployed" title="{3214,1}" text="{3214,30}" noabort="1">
                        <briefing cue="KTHpersuade_yaki_Satdeployed" step="1"/>
                        <mission discipline="XXXT" level="easy"/>
                        <custom action="{3214,22}" text="{3214,19}"/>
                      </set_objective>
                      <set_value name="KTH_toplevel.KTH6thhintlink" exact="1"/>
                    </do_all>
                  </action>
                </cue>
              </cues>
            </cue>
            <!--sixth hint prepare-->
            <cue name="KTHsixthhint" delay="998">
              <condition>
                <check_value value="{value@KTH_toplevel.KTH6thhintlink}" exact="1"/>
              </condition>
              <action>
				  <do_all>
                    <create_crate name="KTH_toplevel.Crate" invincible="1" discoverypoints="10000">
                        <position x="26km" y="11km" z="49km"/>
                        <sector sector="KTH_toplevel.KTHhint6"/>
                        <ware exact="1" typename="SS_WARE_LOGBOOK"/>
                    </create_crate>
			        <set_discoverable object="KTH_toplevel.Crate" discoverable="1" distance="60000"/>
				  </do_all>
			  </action>
              <cues>
                <cue name="KTHsixthhint_collect" delay="2s">
                  <condition>
                    <object_exists object="KTH_toplevel.Crate" negate="1"/>
                  </condition>
                  <action>
                    <do_all>
                      <create_briefing cue="KTHpersuade_yaki_Satdeployed" title="{3214,1}" text="{3214,31}" background="part_6.tga">
                        <mission discipline="XXXT" level="veryhard"/>
                        <objectives>
                          <objective step="1">
                            <custom action="{3214,22}" text="{3214,20}"/>
                          </objective>
                        </objectives>
                      </create_briefing>
                      <set_objective cue="KTHpersuade_yaki_Satdeployed" title="{3214,1}" text="{3214,31}" noabort="1">
                        <briefing cue="KTHpersuade_yaki_Satdeployed" step="1"/>
                        <mission discipline="XXXT" level="veryhard"/>
                        <custom action="{3214,22}" text="{3214,20}"/>
                      </set_objective>
                      <set_value name="KTH_toplevel.KTH7thhintlink" exact="1"/>
                    </do_all>
                  </action>
                </cue>
              </cues>
            </cue>
            <!--seventh hint prepare-->
            <cue name="KTHseventhhint" delay="977">
              <condition>
                <check_value value="{value@KTH_toplevel.KTH7thhintlink}" exact="1"/>
              </condition>
              <action>
				  <do_all>
                    <create_crate name="KTH_toplevel.Crate" invincible="1" discoverypoints="10000">
                        <position x="0" y="50km" z="0"/>
                        <sector sector="KTH_toplevel.KTHhint7"/>
                        <ware exact="1" typename="SS_WARE_LOGBOOK"/>
                    </create_crate>
				    <set_discoverable object="KTH_toplevel.Crate" discoverable="1" distance="60000"/>
				  </do_all>
			  </action>
              <cues>
                <cue name="KTHseventhhint_collect" delay="2s">
                  <condition>
                    <object_exists object="KTH_toplevel.Crate" negate="1"/>
                  </condition>
                  <action>
                    <do_all>
                      <create_briefing cue="KTHpersuade_yaki_Satdeployed" title="{3214,1}" text="{3214,32}" background="part_7.tga">
                        <mission discipline="XXXT" level="average"/>
                        <objectives>
                          <objective step="1" background="part_7.tga">
                            <custom action="{3214,22}" text="{3214,21}"/>
                          </objective>
                        </objectives>
                      </create_briefing>
                      <set_objective cue="KTHpersuade_yaki_Satdeployed" title="{3214,1}" text="{3214,32}" noabort="1">
                        <briefing cue="KTHpersuade_yaki_Satdeployed" step="1"/>
                        <mission discipline="XXXT" level="average"/>
                        <custom action="{3214,22}" text="{3214,21}"/>
                      </set_objective>
                      <set_value name="KTH_toplevel.KTH8thhintlink" exact="1"/>
                    </do_all>
                  </action>
                </cue>
              </cues>
            </cue>
            <!--eighth hint prepare-->
            <cue name="KTHeighthhint" delay="935">
              <condition>
                <check_value value="{value@KTH_toplevel.KTH8thhintlink}" exact="1"/>
              </condition>
              <action>
                <do_all>
                  <find_asteroid name="KTH_toplevel.KTH8thhintastro">
                    <sector sector="KTH_toplevel.KTHhint8"/>
                  </find_asteroid>
                  <do_choose>
                    <do_when value="{object.exists@KTH_toplevel.KTH8thhintastro}" exact="0">
                      <create_asteroid name="KTH_toplevel.KTH8thhintastro" typename="SS_ASTEROID_03" minable="0" invincible="1" scanned="0">
                        <position x="0" y="0" z="0" min="40km" max="80km"/>
                        <sector sector="KTH_toplevel.KTHhint8"/>
                        <resource exact="12" typename="SS_WARE_NIVIDIUM2"/>
                      </create_asteroid>
                    </do_when>
                    <do_otherwise>
                      <set_scanned object="KTH_toplevel.KTH8thhintastro" scanned="0"/>
                      <set_minable object="KTH_toplevel.KTH8thhintastro" minable="0"/>
                      <set_invincible object="KTH_toplevel.KTH8thhintastro" invincible="1"/>
                    </do_otherwise>
                  </do_choose>
                </do_all>
              </action>
              <cues>
                <cue name="KTHeighthhint_scan" delay="2s">
                  <condition>
                    <check_all>
                      <cue_is_complete cue="KTHeighthhint"/>
                      <check_value value="{object.scanned@KTH_toplevel.KTH8thhintastro}" exact="1"/>
                    </check_all>
                  </condition>
                  <action>
                    <do_all>
                      <play_text pageid="13" textid="1332"/>
                      <set_value name="KTH_toplevel.KTH8thhintastrox" exact="{object.position.x@KTH_toplevel.KTH8thhintastro}"/>
                      <set_value name="KTH_toplevel.KTH8thhintastroy" exact="{object.position.y@KTH_toplevel.KTH8thhintastro}"/>
                      <set_value name="KTH_toplevel.KTH8thhintastroz" exact="{object.position.z@KTH_toplevel.KTH8thhintastro}"/>
                      <set_invincible object="KTH_toplevel.KTH8thhintastro" invincible="0"/>
                      <create_briefing cue="KTHpersuade_yaki_Satdeployed" title="{3214,1}" text="{3214,32}" background="part_7.tga">
                        <mission discipline="XFXX" level="average"/>
                        <objectives>
                          <objective step="2" background="part_7.tga">
                            <destroy object="KTH_toplevel.KTH8thhintastro"/>
                          </objective>
                        </objectives>
                      </create_briefing>
                      <set_objective cue="KTHpersuade_yaki_Satdeployed" title="{3214,1}" text="{3214,32}" noabort="1">
                        <briefing cue="KTHpersuade_yaki_Satdeployed" step="2"/>
                        <mission discipline="XFXX" level="average"/>
                        <destroy object="KTH_toplevel.KTH8thhintastro"/>
                      </set_objective>
                      <incoming_message author="{3214,34}" popup="1" text="{3214,35}"/>
                    </do_all>
                  </action>
                  <cues>
                    <cue name="KTHeighthhint_destroy" delay="1s">
                      <condition>
                        <object_exists object="KTH_toplevel.KTH8thhintastro" negate="1"/>
                      </condition>
                      <action>
                        <do_all>
                          <create_crate name="KTH_toplevel.Crate" invincible="1" discoverypoints="10000">
                            <position x="{value@KTH_toplevel.KTH8thhintastrox}" y="{value@KTH_toplevel.KTH8thhintastroy}" z="{value@KTH_toplevel.KTH8thhintastroz}"/>
                            <sector sector="KTH_toplevel.KTHhint8"/>
                            <ware exact="1" typename="SS_WARE_LOGBOOK"/>
                          </create_crate>
							<create_briefing cue="KTHpersuade_yaki_Satdeployed">
                            <objectives>
                              <objective step="2">
                                <custom action="{35,2042}" text="{object.name@KTH_toplevel.Crate}" object="KTH_toplevel.Crate"/>
                              </objective>
                            </objectives>
                          </create_briefing>
                          <set_objective cue="KTHpersuade_yaki_Satdeployed" noabort="1">
                            <briefing cue="KTHpersuade_yaki_Satdeployed" step="2"/>
                            <custom action="{35,2042}" text="{object.name@KTH_toplevel.Crate}" object="KTH_toplevel.Crate"/>
                          </set_objective>
                        </do_all>
                      </action>
                      <cues>
                        <cue name="KTHeighthhint_collect" delay="2s">
                          <condition>
                            <object_exists object="KTH_toplevel.Crate" negate="1"/>
                          </condition>
                          <action>
                            <do_all>
                              <remove_briefing cue="KTHpersuade_yaki_Satdeployed"/>
                              <remove_objective cue="KTHpersuade_yaki_Satdeployed"/>
                              <create_briefing cue="KTHpersuade_yaki_Satdeployed" title="{3214,1}" text="{3214,37}" background="part_8.tga">
                                <mission discipline="XXXT" level="average"/>
                                <objectives>
                                  <objective step="1" background="part_8.tga">
                                    <custom action="{3214,36}" text="{3214,33}"/>
                                  </objective>
                                </objectives>
                              </create_briefing>
                              <set_objective cue="KTHpersuade_yaki_Satdeployed" title="{3214,1}" text="{3214,37}" noabort="1">
                                <briefing cue="KTHpersuade_yaki_Satdeployed" step="1"/>
                                <mission discipline="XXXT" level="average"/>
                                <custom action="{3214,36}" text="{3214,33}"/>
                              </set_objective>
                              <set_value name="KTH_toplevel.KTHfindwrecklink" exact="1"/>
                            </do_all>
                          </action>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>
            <!--Final istructions-->
            <cue name="KTHfinalinstructions" delay="957">
              <condition>
                <check_value value="{value@KTH_toplevel.KTHfindwrecklink}" exact="1"/>
              </condition>
              <action>
				  <do_all>
                <create_object class="special" typename="SS_SPECIAL_SHIPWRECK_11" name="KTH_toplevel.KTHTLwreck">
                  <position x="-10km" y="10km" z="-70km"/>
                  <sector sector="KTH_toplevel.KTHwreck"/>
                </create_object>
				<set_discoverable object="KTH_toplevel.KTHTLwreck" discoverable="1" distance="80000"/>
			    </do_all>
              </action>
              <cues>
                <cue name="KTHfinalinstructions_objective" delay="3s" version="2">
                  <condition>
                    <object_position max="8km">
                      <position object="KTH_toplevel.KTHTLwreck"/>
                      <sector sector="KTH_toplevel.KTHwreck"/>
                    </object_position>
                  </condition>
                  <action>
                    <do_all>
                      <remove_briefing cue="KTHpersuade_yaki_Satdeployed"/>
                      <remove_objective cue="KTHpersuade_yaki_Satdeployed"/>
                      <add_cargo object="{player.ship}">
                        <ware exact="-8" typename="SS_WARE_LOGBOOK"/>
                      </add_cargo>
                      <create_briefing cue="KTHfinalinstructions_objective" title="{3214,1}" text="{3214,37}" background="station_argon_space_fuel_distillery.tga">
                        <mission discipline="XXXT" level="easy"/>
                        <objectives>
                          <objective step="1">
                            <custom action="{35,2026}" text="{object.name@KTH_toplevel.KTHTLwreck}" object="KTH_toplevel.KTHTLwreck" icon="flyto"/>
                          </objective>
                        </objectives>
                      </create_briefing>
                      <set_objective cue="KTHfinalinstructions_objective" title="{3214,1}" text="{3214,37}" noabort="1">
                        <briefing cue="KTHfinalinstructions_objective" step="1"/>
                        <mission discipline="XXXT" level="easy"/>
                        <custom action="{35,2026}" text="{object.name@KTH_toplevel.KTHTLwreck}" object="KTH_toplevel.KTHTLwreck" icon="flyto"/>
                      </set_objective>
                    </do_all>
                  </action>
                  <cues>
                    <cue ref="OBJ02">
                      <params>
                        <param name="Cue" value="KTHfinalinstructions" comment="The cue"/>
                        <param name="Object" value="KTH_toplevel.KTHTLwreck" comment="The object to be scanned"/>
                        <param name="Range" value="600"/>
                        <param name="Text" value="{3300,1201}"/>
                        <param name="ResetWhenInterrupted" value="1" comment="Reset the scan percentage when interrupted?"/>
                      </params>
                    </cue>
                    <cue name="KTHfinalinstructions_TLscaned" delay="1s">
                      <condition>
                        <check_value value="{value@KTHfinalinstructions.OBJ02 Progress}" exact="1"/>
                      </condition>
                      <timing>
                        <time exact="2s"/>
                      </timing>
                      <action>
                        <incoming_message author="{random.pilot.argon}" text="{3214,52}"/>
                      </action>
                      <cues>
                        <cue name="KTHfinalinstructions_Xattack" delay="2s">
                          <condition>
                            <cue_is_complete cue="KTHfinalinstructions_TLscaned"/>
                          </condition>
                          <timing>
                            <time exact="1s"/>
                          </timing>
                          <action>
                            <do_all>
                              <create_ship name="KTH_toplevel.Xshutle" invincible="1" typename="SS_SH_X_SHUTTLE" highlight="1" warp="0" race="none" racelogic="0" sellable="0" capturable="0">
                                <position object="{player.ship}" min="8km" max="10km"/>
                                <sector sector="KTH_toplevel.KTHwreck"/>
                                <equipment loadout="maximum" loadoutmask="all"/>
                              </create_ship>
                              <add_equipment object="KTH_toplevel.Xshutle">
                                <ware exact="{object.equipment.SS_WARE_TECH213.maxcount@KTH_toplevel.Xshutle}-{object.equipment.SS_WARE_TECH213.count@KTH_toplevel.Xshutle}" typename="SS_WARE_TECH213"/>
                              </add_equipment>
                              <set_actor_location actor="KTH_toplevel.KTHofferactor" object="KTH_toplevel.Xshutle" location="pilot"/>
                              <set_relation object="KTH_toplevel.Xshutle">
                                <relation object="{player.ship}" mutual="1" relation="enemy"/>
                              </set_relation>
                              <set_command object="KTH_toplevel.Xshutle" command="attack" commandobject="{player.ship}"/>
                              <create_briefing cue="KTHfinalinstructions_objective" title="{3214,1}" background="station_argon_space_fuel_distillery.tga">
                                <mission discipline="XXXT" level="average"/>
                                <objectives>
                                  <objective step="2">
                                    <custom action="{35,2023}" text="{object.name@KTH_toplevel.Xshutle}" object="KTH_toplevel.Xshutle" icon="kill"/>
                                  </objective>
                                </objectives>
                              </create_briefing>
                              <set_objective cue="KTHfinalinstructions_objective" title="{3214,1}" noabort="1">
                                <briefing cue="KTHfinalinstructions_objective" step="2"/>
                                <mission discipline="XXXT" level="average"/>
                                <custom action="{35,2023}" text="{object.name@KTH_toplevel.Xshutle}" object="KTH_toplevel.Xshutle" icon="kill"/>
                              </set_objective>
                            </do_all>
                          </action>
                          <cues>
                            <cue name="KTHfinalinstructions_bail">
                              <condition>
                                <check_all>
                                  <object_attacked_by_player object="KTH_toplevel.Xshutle"/>
                                  <cue_is_complete cue="KTHfinalinstructions_Xattack"/>
                                  <check_value value="{object.shields@KTH_toplevel.Xshutle}" max="5"/>
                                  <check_value value="{object.hull@KTH_toplevel.Xshutle}" max="97"/>
                                </check_all>
                              </condition>
                              <action>
                                <do_all>
                                  <abandon_ship object="KTH_toplevel.Xshutle"/>
                                  <set_command object="KTH_toplevel.Xshutle" command="stay"/>
                                  <set_command object="{actor.ship@KTH_toplevel.KTHofferactor}" command="idle"/>
                                  <create_briefing cue="KTHfinalinstructions_objective" title="{3214,1}" background="station_argon_space_fuel_distillery.tga">
                                    <mission discipline="XXXT" level="easy"/>
                                    <objectives>
                                      <objective step="3">
                                        <custom action="{35,2042}" text="{actor.name@KTH_toplevel.KTHofferactor}" actor="KTH_toplevel.KTHofferactor" icon="flyto"/>
                                      </objective>
                                    </objectives>
                                  </create_briefing>
                                  <set_objective cue="KTHfinalinstructions_objective" title="{3214,1}" noabort="1">
                                    <briefing cue="KTHfinalinstructions_objective" step="3"/>
                                    <mission discipline="XXXT" level="easy"/>
                                    <custom action="{35,2042}" text="{actor.name@KTH_toplevel.KTHofferactor}" actor="KTH_toplevel.KTHofferactor" icon="flyto"/>
                                  </set_objective>
                                </do_all>
                              </action>
                              <cues>
                                <cue name="KTH_Stop_Astronaut" delay="10s" instantiate="static">
                                  <condition>
                                    <check_any>
                                      <check_all>
                                        <check_value value="{actor.exists@KTH_toplevel.KTHofferactor}" exact="1"/>
                                        <check_value value="{actor.ship.exists@KTH_toplevel.KTHofferactor}" exact="1"/>
                                        <check_value value="{actor.ship.isclass.astronaut@KTH_toplevel.KTHofferactor}" exact="1"/>
                                        <check_value value="{actor.ship.destination.exists@KTH_toplevel.KTHofferactor}" exact="1"/>
                                      </check_all>
                                      <check_all>
                                        <check_value value="{group.object.count@KTH_toplevel.KTHCrewactor}" min="1"/>
                                        <check_any exact="{group.object.count@KTH_toplevel.KTHCrewactor}" counter="count">
                                          <check_all>
                                            <check_value value="{actor.ship.exists@{group.object.{counter@count}@KTH_toplevel.KTHCrewactor}}" exact="1"/>
                                            <check_value value="{actor.ship.isclass.astronaut@{group.object.{counter@count}@KTH_toplevel.KTHCrewactor}}" exact="1"/>
                                            <check_value value="{actor.ship.destination.exists@{group.object.{counter@count}@KTH_toplevel.KTHCrewactor}}" exact="1"/>
                                          </check_all>
                                        </check_any>
                                      </check_all>
                                    </check_any>
                                  </condition>
                                  <action>
                                    <do_all>
                                      <do_if value="{actor.exists@KTH_toplevel.KTHofferactor}" exact="1">
                                        <do_if value="{actor.ship.exists@KTH_toplevel.KTHofferactor}" exact="1">
                                          <do_if value="{actor.ship.destination.exists@KTH_toplevel.KTHofferactor}" exact="1">
                                            <set_command object="{actor.ship@KTH_toplevel.KTHofferactor}" command="stay"/>
                                          </do_if>
                                        </do_if>
                                      </do_if>
                                      <do_all exact="{group.object.count@KTH_toplevel.KTHCrewactor}" counter="count">
                                        <do_if value="{actor.ship.exists@{group.object.{counter@count}@KTH_toplevel.KTHCrewactor}}" exact="1">
                                          <do_if value="{actor.ship.destination.exists@{group.object.{counter@count}@KTH_toplevel.KTHCrewactor}}" exact="1">
                                            <set_command object="{actor.ship@{group.object.{counter@count}@KTH_toplevel.KTHCrewactor}}" command="stay"/>
                                          </do_if>
                                        </do_if>
                                      </do_all>
                                    </do_all>
                                  </action>
                                </cue>
                                <cue name="KTHfinalinstructions_AstroLost" delay="10s" instantiate="static" version="4">
                                  <condition>
                                    <check_any>
                                      <check_all>
                                        <check_value value="{actor.exists@KTH_toplevel.KTHofferactor}" exact="1"/>
                                        <check_value value="{actor.ship.exists@KTH_toplevel.KTHofferactor}" exact="1"/>
                                        <check_value value="{actor.ship.isclass.astronaut@KTH_toplevel.KTHofferactor}" exact="0"/>
                                        <check_value value="{actor.ship.race@KTH_toplevel.KTHofferactor}" exact="{lookup.race@player}" negate="1"/>
                                      </check_all>
                                      <check_all>
                                        <check_value value="{group.object.count@KTH_toplevel.KTHCrewactor}" min="1"/>
                                        <check_any exact="{group.object.count@KTH_toplevel.KTHCrewactor}" counter="count">
                                          <check_all>
                                            <check_value value="{actor.ship.exists@{group.object.{counter@count}@KTH_toplevel.KTHCrewactor}}" exact="1"/>
                                            <check_value value="{actor.ship.isclass.astronaut@{group.object.{counter@count}@KTH_toplevel.KTHCrewactor}}" exact="0"/>
                                            <check_value value="{actor.ship.race@{group.object.{counter@count}@KTH_toplevel.KTHCrewactor}}" exact="{lookup.race@player}" negate="1"/>
                                            <check_any>
                                              <object_exists object="KTH_toplevel.KTHCrewship" negate="1"/>
                                              <check_value value="{actor.ship@{group.object.{counter@count}@KTH_toplevel.KTHCrewactor}}" exact="{object@KTH_toplevel.KTHCrewship}" negate="1"/>
                                            </check_any>
                                          </check_all>
                                        </check_any>
                                      </check_all>
                                    </check_any>
                                  </condition>
                                  <action>
                                    <do_all>
                                      <do_choose>
                                        <do_when value="{actor.ship.exists@KTH_toplevel.KTHofferactor}" exact="1">
                                          <create_astronaut name="this.Astronaut" typename="SS_SH_ASTRON">
                                            <position object="{actor.ship@KTH_toplevel.KTHofferactor}"/>
                                            <sector sector="{actor.sector@KTH_toplevel.KTHofferactor}"/>
                                          </create_astronaut>
                                        </do_when>
                                        <do_otherwise>
                                          <create_astronaut name="this.Astronaut" typename="SS_SH_ASTRON"/>
                                        </do_otherwise>
                                      </do_choose>
                                      <set_actor_location actor="KTH_toplevel.KTHofferactor" object="this.Astronaut" location="pilot"/>
                                      <set_command object="this.Astronaut" command="stay"/>
                                      <remove_object object="this.Astronaut"/>
                                      <do_all exact="{group.object.count@KTH_toplevel.KTHCrewactor}" counter="count">
                                        <do_if value="{actor.ship.exists@{group.object.{counter@count}@KTH_toplevel.KTHCrewactor}}" exact="1">
                                          <do_if value="{actor.ship.isclass.astronaut@{group.object.{counter@count}@KTH_toplevel.KTHCrewactor}}" exact="0">
                                            <do_if value="{actor.ship.race@{group.object.{counter@count}@KTH_toplevel.KTHCrewactor}}" exact="{lookup.race@player}" negate="1">
                                              <do_choose>
                                                <do_when value="{object.exists@KTH_toplevel.KTHCrewship}" exact="0">
                                                  <create_astronaut name="this.Astronaut" typename="SS_SH_ASTRON"/>
                                                  <set_actor_location actor="{group.object.{counter@count}@KTH_toplevel.KTHCrewactor}" object="this.Astronaut" location="pilot"/>
                                                  <set_command object="this.Astronaut" command="stay"/>
                                                </do_when>
                                                <do_when value="{actor.ship@{group.object.{counter@count}@KTH_toplevel.KTHCrewactor}}" exact="{object@KTH_toplevel.KTHCrewship}" negate="1">
                                                  <create_astronaut name="this.Astronaut" typename="SS_SH_ASTRON"/>
                                                  <set_actor_location actor="{group.object.{counter@count}@KTH_toplevel.KTHCrewactor}" object="this.Astronaut" location="pilot"/>
                                                  <set_command object="this.Astronaut" command="stay"/>
                                                </do_when>
                                              </do_choose>
                                            </do_if>
                                          </do_if>
                                        </do_if>
                                      </do_all>
                                    </do_all>
                                  </action>
                                </cue>
                                <cue name="KTHfinalinstructions_collectAstro" delay="2s">
                                  <condition>
                                    <match_object object="{actor.ship@KTH_toplevel.KTHofferactor}" race="player"/>
                                  </condition>
                                  <timing>
                                    <time exact="2s"/>
                                  </timing>
                                  <action>
                                    <do_all>
                                      <create_actor name="KTH_toplevel.KTHMilitary" character="{random.pilot.argon}" race="argon" voice="110" face="101" object="KTH_toplevel.KTHshipyard" location="crew" invincible="1"/>
                                      <incoming_message author="{actor.name@KTH_toplevel.KTHMilitary}" text="{3214,53}"/>
                                    </do_all>
                                  </action>
                                  <cues>
                                    <cue name="KTHfinalinstructions_pickupAstro" delay="2s">
                                      <condition>
                                        <check_all>
                                          <cue_is_complete cue="KTHfinalinstructions_collectAstro"/>
                                          <match_object object="{actor.ship@KTH_toplevel.KTHofferactor}" race="player" negate="1"/>
                                        </check_all>
                                      </condition>
                                      <action>
                                        <do_all>
                                          <create_briefing cue="KTHfinalinstructions_objective" title="{3214,1}" background="station_argon_space_fuel_distillery.tga">
                                            <mission discipline="XXXT" level="easy"/>
                                            <objectives>
                                              <objective step="3">
                                                <custom action="{35,2042}" text="{actor.name@KTH_toplevel.KTHofferactor}" actor="KTH_toplevel.KTHofferactor" icon="flyto"/>
                                              </objective>
                                            </objectives>
                                          </create_briefing>
                                          <set_objective cue="KTHfinalinstructions_objective" title="{3214,1}" noabort="1">
                                            <briefing cue="KTHfinalinstructions_objective" step="3"/>
                                            <mission discipline="XXXT" level="easy"/>
                                            <custom action="{35,2042}" text="{actor.name@KTH_toplevel.KTHofferactor}" actor="KTH_toplevel.KTHofferactor" icon="flyto"/>
                                          </set_objective>
                                          <reset_cue cue="KTHfinalinstructions_dockatShipyard"/>
                                        </do_all>
                                      </action>
                                    </cue>
                                    <cue name="KTHfinalinstructions_dockatShipyard" delay="2s">
                                      <condition>
                                        <check_all>
                                          <cue_is_complete cue="KTHfinalinstructions_collectAstro"/>
                                          <match_object object="{actor.ship@KTH_toplevel.KTHofferactor}" race="player"/>
                                        </check_all>
                                      </condition>
                                      <action>
                                        <do_all>
                                          <create_briefing cue="KTHfinalinstructions_objective" title="{3214,1}" background="station_argon_space_fuel_distillery.tga">
                                            <mission discipline="XXXT" level="easy"/>
                                            <objectives>
                                              <objective step="4">
                                                <custom action="{35,2003}" text="{actor.name@KTH_toplevel.KTHofferactor}" object="{actor.name@KTH_toplevel.KTHofferactor}" guidance="KTH_toplevel.KTHshipyard" icon="dockat"/>
                                              </objective>
                                            </objectives>
                                          </create_briefing>
                                          <set_objective cue="KTHfinalinstructions_objective" title="{3214,1}" noabort="1">
                                            <briefing cue="KTHfinalinstructions_objective" step="4"/>
                                            <mission discipline="XXXT" level="easy"/>
                                            <custom action="{35,2003}" text="{actor.name@KTH_toplevel.KTHofferactor}" object="{actor.name@KTH_toplevel.KTHofferactor}" guidance="KTH_toplevel.KTHshipyard" icon="dockat"/>
                                          </set_objective>
                                          <reset_cue cue="KTHfinalinstructions_pickupAstro"/>
                                        </do_all>
                                      </action>
                                    </cue>
                                    <cue name="KTHfinalinstructions_deliveractor" delay="1s">
                                      <condition>
                                        <check_all>
                                          <object_is_docked dockobject="KTH_toplevel.KTHshipyard"/>
                                          <check_value value="{actor.ship@KTH_toplevel.KTHofferactor}" exact="{player.ship}"/>
                                        </check_all>
                                      </condition>
                                      <timing>
                                        <time exact="10s"/>
                                      </timing>
                                      <action>
                                        <do_all>
                                          <cancel_cue cue="KTHfinalinstructions_pickupAstro"/>
                                          <incoming_message author="{actor.name@KTH_toplevel.KTHMilitary}" text="{3214,54}"/>
                                          <destroy_actor actor="KTH_toplevel.KTHofferactor"/>
                                          <destroy_object object="KTH_toplevel.Xshutle" explosion="0"/>
                                          <remove_briefing cue="KTHfinalinstructions_objective"/>
                                          <remove_objective cue="KTHfinalinstructions_objective"/>
                                        </do_all>
                                      </action>
                                      <cues>
                                        <cue name="KTHfinalinstructions_Findcrew">
                                          <timing>
                                            <time min="8m" max="12m"/>
                                          </timing>
                                          <action>
                                            <do_all>
                                              <create_ship name="KTH_toplevel.KTHCrewship" typename="SS_SH_T_TL" invincible="1" racelogic="0" race="pirate" covered="0">
                                                <position x="-50km" y="0km" z="50km"/>
                                                <sector x="0" y="10"/>
                                                <equipment loadout="maximum" loadoutmask="equipment|shields">
                                                  <ware typename="SS_WARE_LIFESUPPORT" exact="1"/>
                                                </equipment>
                                                <command command="idle"/>
                                                <relations>
                                                  <relation object="{player.ship}" mutual="1" relation="enemy"/>
                                                </relations>
                                              </create_ship>
                                              <do_all counter="KTHCrewcounter" exact="7">
                                                <create_actor name="KTH_toplevel.KTHCrewactor{counter@KTHCrewcounter}" character="{random.pilot.argon}" object="KTH_toplevel.KTHCrewship" location="passenger" invincible="1" race="argon"/>
                                                <set_object name="KTH_toplevel.KTHCrewactor {actor@KTH_toplevel.KTHCrewactor{counter@KTHCrewcounter}}" group="KTH_toplevel.KTHCrewactor" value="{actor@KTH_toplevel.KTHCrewactor{counter@KTHCrewcounter}}"/>
                                              </do_all>
                                              <do_all counter="THcounter" min="10" max="15">
                                                <create_ship name="KTH_toplevel.TempPirateShip{counter@THcounter}" group="KTH_toplevel.KTHCrewshipescort" typename="{random.type@SS_SH_T_M3_P|SS_SH_T_M4_P_1|SS_SH_T_M4_P_3|SS_SH_T_M5_P|SS_SH_T_M5_P_1}" race="pirate" racelogic="0" covered="0" capturable="0">
                                                  <position object="KTH_toplevel.KTHCrewship" min="2km" max="4km"/>
                                                  <sector sector="{object.sector@KTH_toplevel.KTHCrewship}"/>
                                                  <equipment loadout="maximum"/>
                                                  <command command="protect" commandobject="KTH_toplevel.KTHCrewship"/>
                                                </create_ship>
                                                <add_equipment object="KTH_toplevel.TempPirateShip">
                                                  <ware exact="{object.equipment.SS_WARE_TECH213.maxcount@KTH_toplevel.TempPirateShip}-{object.equipment.SS_WARE_TECH213.count@KTH_toplevel.TempPirateShip}" typename="SS_WARE_TECH213"/>
                                                </add_equipment>
                                              </do_all>
                                              <incoming_message author="{actor.name@KTH_toplevel.KTHMilitary}" text="{3214,55}"/>
                                            </do_all>
                                          </action>
                                          <cues>
                                            <cue name="KTHfinalinstructions_Findcrew_EscortRacelogic">
                                              <condition>
                                                <object_attacked_by_player object="KTH_toplevel.KTHCrewship"/>
                                              </condition>
                                              <action>
                                                <do_all>
                                                  <set_group_racelogic group="KTH_toplevel.KTHCrewshipescort" racelogic="1"/>
                                                  <set_group_command command="protect" commandobject="KTH_toplevel.KTHCrewship"/>
                                                </do_all>
                                              </action>
                                            </cue>
                                            <cue name="KTHfinalinstructions_Findcrew_complete">
                                              <condition>
                                                <cue_completed cue="KTHfinalinstructions_Findcrew"/>
                                              </condition>
                                              <cues>
                                                <cue name="KTHfinalinstructions_Update Needed Conditions" delay="5s" instantiate="static">
                                                  <condition>
                                                    <check_any>
                                                      <check_value value="{value@KTH_toplevel.Update Needed Conditions Ran}" exact="0"/>
                                                      <check_all>
                                                        <check_value value="{player.ship.equipment.SS_WARE_LIFESUPPORT.exists}+{player.ship.isclass.tp}" exact="0"/>
                                                        <check_value value="{value@KTH_toplevel.GotLifesupport}" exact="1"/>
                                                      </check_all>
                                                      <check_all>
                                                        <check_value value="{player.ship.equipment.SS_WARE_LIFESUPPORT.exists}+{player.ship.isclass.tp}" min="1"/>
                                                        <check_value value="{value@KTH_toplevel.GotLifesupport}" exact="0"/>
                                                      </check_all>
                                                      <check_all>
                                                        <check_value value="{player.ship.cargospace}" max="{lookup.type.cargospace@SS_WARE_PASSENGER}-1"/>
                                                        <check_value value="{value@KTH_toplevel.GotSpace}" exact="1"/>
                                                      </check_all>
                                                      <check_all>
                                                        <check_value value="{player.ship.cargospace}" min="{lookup.type.cargospace@SS_WARE_PASSENGER}"/>
                                                        <check_value value="{value@KTH_toplevel.GotSpace}" exact="0"/>
                                                      </check_all>
                                                      <check_all>
                                                        <check_value value="{player.ship.cargoclass}" max="{lookup.cargoclass@s}"/>
                                                        <check_value value="{value@KTH_toplevel.GotCargoClass}" exact="1"/>
                                                      </check_all>
                                                      <check_all>
                                                        <check_value value="{player.ship.cargoclass}" min="{lookup.cargoclass@m}"/>
                                                        <check_value value="{value@KTH_toplevel.GotCargoClass}" exact="0"/>
                                                      </check_all>
                                                    </check_any>
                                                  </condition>
                                                  <action>
                                                    <do_all>
                                                      <reset_cue cue="KTHfinalinstructions_TLaproach"/>
                                                      <do_if value="{value@KTH_toplevel.TLaproach Done}" exact="0">
                                                        <reset_cue cue="KTHfinalinstructions_FlytoTL"/>
                                                      </do_if>
                                                      <set_value name="KTH_toplevel.Update Needed Conditions Ran" exact="1"/>
                                                      <set_value name="this.MinStep" exact="1"/>
                                                      <set_value name="this.MaxStep" exact="3"/>
                                                      <do_choose>
                                                        <do_when value="{player.ship.equipment.SS_WARE_LIFESUPPORT.exists}+{player.ship.isclass.tp}" exact="0">
                                                          <set_value name="this.LifeSupportStep" exact="{value@this.MinStep}"/>
                                                          <set_value name="this.MinStep" operation="add"/>
                                                          <set_value name="KTH_toplevel.GotLifesupport" exact="0"/>
                                                        </do_when>
                                                        <do_otherwise>
                                                          <set_value name="this.LifeSupportStep" exact="{value@this.MaxStep}"/>
                                                          <set_value name="this.MaxStep" operation="subtract"/>
                                                          <set_value name="KTH_toplevel.GotLifesupport" exact="1"/>
                                                        </do_otherwise>
                                                      </do_choose>
                                                      <do_choose>
                                                        <do_when value="{player.ship.cargospace}" max="{lookup.type.cargospace@SS_WARE_PASSENGER}-1">
                                                          <set_value name="this.CargoSpaceStep" exact="{value@this.MinStep}"/>
                                                          <set_value name="this.MinStep" operation="add"/>
                                                          <set_value name="KTH_toplevel.GotSpace" exact="0"/>
                                                        </do_when>
                                                        <do_otherwise>
                                                          <set_value name="this.CargoSpaceStep" exact="{value@this.MaxStep}"/>
                                                          <set_value name="this.MaxStep" operation="subtract"/>
                                                          <set_value name="KTH_toplevel.GotSpace" exact="1"/>
                                                        </do_otherwise>
                                                      </do_choose>
                                                      <do_choose>
                                                        <do_when value="{player.ship.cargoclass}" max="{lookup.cargoclass@s}">
                                                          <set_value name="this.CargoClassStep" exact="{value@this.MinStep}"/>
                                                          <set_value name="KTH_toplevel.GotCargoClass" exact="0"/>
                                                        </do_when>
                                                        <do_otherwise>
                                                          <set_value name="this.CargoClassStep" exact="{value@this.MaxStep}"/>
                                                          <set_value name="KTH_toplevel.GotCargoClass" exact="1"/>
                                                        </do_otherwise>
                                                      </do_choose>

                                                      <remove_briefing cue="KTHfinalinstructions_Findcrew"/>
                                                      <create_briefing cue="KTHfinalinstructions_Findcrew" title="{3214,1}" background="station_argon_space_fuel_distillery.tga">
                                                        <mission discipline="XXXT" level="trivial"/>
                                                        <objectives>
                                                          <objective step="{value@this.LifeSupportStep}">
                                                            <custom action="{35,2030}" text="{lookup.type.name@SS_WARE_LIFESUPPORT}" icon="buy"/>
                                                          </objective>
                                                          <objective step="{value@this.CargoSpaceStep}">
                                                            <custom action="{35,2030}" text="{lookup.type.cargospace@SS_WARE_PASSENGER} {35,722}" icon="buy"/>
                                                          </objective>
                                                          <objective step="{value@this.CargoClassStep}">
                                                            <custom action="{35,2030}" text="{3214,60}" icon="buy"/>
                                                          </objective>
                                                          <objective step="4">
                                                            <custom action="{35,2007}" text="{object.name@KTH_toplevel.KTHCrewship}, {object.sector.name@KTH_toplevel.KTHCrewship}" object="KTH_toplevel.KTHCrewship" icon="flyto"/>
                                                          </objective>
                                                          <objective step="5">
                                                            <custom action="{35,2039}" text="{object.name@KTH_toplevel.KTHCrewship}, {object.sector.name@KTH_toplevel.KTHCrewship}" object="KTH_toplevel.KTHCrewship" icon="kill"/>
                                                          </objective>
                                                        </objectives>
                                                      </create_briefing>

                                                      <do_choose>
                                                        <do_when value="{value@KTH_toplevel.GotCargoClass}" exact="0">
                                                          <set_objective cue="KTHfinalinstructions_Findcrew" title="{3214,1}" noabort="1">
                                                            <briefing cue="KTHfinalinstructions_Findcrew" step="{value@this.CargoClassStep}"/>
                                                            <custom action="{35,2030}" text="{3214,60}" icon="buy"/>
                                                          </set_objective>
                                                          <play_text>
                                                            <line pageid="13" textid="1271"/>
                                                            <line pageid="13" textid="33"/>
                                                          </play_text>
                                                        </do_when>
                                                        <do_when value="{value@KTH_toplevel.GotSpace}" exact="0">
                                                          <set_objective cue="KTHfinalinstructions_Findcrew" title="{3214,1}" noabort="1">
                                                            <briefing cue="KTHfinalinstructions_Findcrew" step="{value@this.CargoSpaceStep}"/>
                                                            <custom action="{35,2030}" text="{lookup.type.cargospace@SS_WARE_PASSENGER} {35,722}" icon="buy"/>
                                                          </set_objective>
                                                          <play_text priority="99" pageid="13" textid="1253"/>
                                                        </do_when>
                                                        <do_when value="{value@KTH_toplevel.GotLifesupport}" exact="0">
                                                          <set_objective cue="KTHfinalinstructions_Findcrew" title="{3214,1}" noabort="1">
                                                            <briefing cue="KTHfinalinstructions_Findcrew" step="{value@this.LifeSupportStep}"/>
                                                            <custom action="{35,2030}" text="{lookup.type.name@SS_WARE_LIFESUPPORT}" icon="buy"/>
                                                          </set_objective>
                                                          <play_text priority="99">
                                                            <line pageid="17" textid="3943"/>
                                                            <line pageid="13" textid="24"/>
                                                          </play_text>
                                                        </do_when>
                                                      </do_choose>
                                                    </do_all>
                                                  </action>
                                                </cue>
                                                <cue name="KTHfinalinstructions_FlytoTL" delay="2s">
                                                  <condition>
                                                    <check_all>
                                                      <check_value value="{value@KTH_toplevel.GotLifesupport}" exact="1"/>
                                                      <check_value value="{value@KTH_toplevel.GotSpace}" exact="1"/>
                                                      <check_value value="{value@KTH_toplevel.GotCargoClass}" exact="1"/>
                                                      <check_any>
                                                        <check_value value="{object.sector@KTH_toplevel.KTHCrewship}" exact="{player.sector}" negate="1"/>
                                                        <object_position min="15km">
                                                          <position object="KTH_toplevel.KTHCrewship"/>
                                                        </object_position>
                                                      </check_any>
                                                    </check_all>
                                                  </condition>
                                                  <action>
                                                    <set_objective cue="KTHfinalinstructions_Findcrew" title="{3214,1}" noabort="1">
                                                      <briefing cue="KTHfinalinstructions_Findcrew" step="4"/>
                                                      <mission discipline="XXXT" level="easy"/>
                                                      <custom action="{35,2007}" text="{object.name@KTH_toplevel.KTHCrewship}, {object.sector.name@KTH_toplevel.KTHCrewship}" object="KTH_toplevel.KTHCrewship" icon="flyto"/>
                                                    </set_objective>
                                                  </action>
                                                </cue>
                                                <cue name="KTHfinalinstructions_TLaproach" delay="2s">
                                                  <condition>
                                                    <check_all>
                                                      <check_value value="{value@KTH_toplevel.GotLifesupport}" exact="1"/>
                                                      <check_value value="{value@KTH_toplevel.GotSpace}" exact="1"/>
                                                      <check_value value="{value@KTH_toplevel.GotCargoClass}" exact="1"/>
                                                      <object_position max="15km">
                                                        <position object="KTH_toplevel.KTHCrewship"/>
                                                      </object_position>
                                                    </check_all>
                                                  </condition>
                                                  <action>
                                                    <do_all>
                                                      <cancel_cue cue="KTHfinalinstructions_FlytoTL"/>
                                                      <set_value name="KTH_toplevel.TLaproach Done" exact="1"/>
                                                      <set_objective cue="KTHfinalinstructions_Findcrew" title="{3214,1}" text="{3214,56}" noabort="1">
                                                        <briefing cue="KTHfinalinstructions_Findcrew" step="5"/>
                                                        <mission discipline="XXXT" level="average"/>
                                                        <custom action="{35,2039}" text="{object.name@KTH_toplevel.KTHCrewship}, {object.sector.name@KTH_toplevel.KTHCrewship}" object="KTH_toplevel.KTHCrewship" icon="kill"/>
                                                      </set_objective>
                                                    </do_all>
                                                  </action>
                                                </cue>
                                                <cue name="KTHfinalinstructions_rescue" delay="8s" instantiate="static">
                                                  <condition>
                                                    <check_all>
                                                      <check_value value="{value@KTH_toplevel.GotLifesupport}" exact="1"/>
                                                      <check_value value="{value@KTH_toplevel.GotSpace}" exact="1"/>
                                                      <check_value value="{value@KTH_toplevel.GotCargoClass}" exact="1"/>
                                                      <object_position max="3km">
                                                        <position object="KTH_toplevel.KTHCrewship"/>
                                                      </object_position>
                                                      <check_value value="{object.shields@KTH_toplevel.KTHCrewship}" max="10"/>
                                                    </check_all>
                                                  </condition>
                                                  <action>
                                                    <do_all>
                                                      <play_text priority="99">
                                                        <line pageid="13" textid="1286"/>
                                                        <line pageid="13" textid="1257"/>
                                                        <line pageid="17" textid="5433"/>
                                                      </play_text>
                                                      <set_value name="KTH_toplevel.KTHCrewamount" exact="0"/>
                                                      <do_all exact="{group.object.count@KTH_toplevel.KTHCrewactor}" counter="count">
                                                        <do_if value="{actor.ship.exists@{group.object.{counter@count}@KTH_toplevel.KTHCrewactor}}" exact="1">
                                                          <do_if value="{actor.ship@{group.object.{counter@count}@KTH_toplevel.KTHCrewactor}}" exact="{object@KTH_toplevel.KTHCrewship}">
                                                            <set_value name="KTH_toplevel.KTHCrewamount" operation="add"/>
                                                            <do_if value="{value@this.PassengerBeammed}" exact="0">
                                                              <set_value name="KTH_toplevel.KTHCrewamount" operation="subtract"/>
                                                              <set_value name="this.PassengerBeammed" exact="1"/>
                                                              <set_actor_location actor="{group.object.{counter@count}@KTH_toplevel.KTHCrewactor}" object="{player.ship}" location="passenger"/>
                                                            </do_if>
                                                          </do_if>
                                                        </do_if>
                                                      </do_all>
                                                      <do_choose>
                                                        <do_when value="{value@KTH_toplevel.KTHCrewamount}" min="1">
                                                          <create_briefing cue="KTHfinalinstructions_Findcrew" title="{3214,1}" text="{3214,56}" background="station_argon_space_fuel_distillery.tga">
                                                            <mission discipline="XXXT" level="average"/>
                                                            <objectives>
                                                              <objective step="5">
                                                                <custom action="{35,2041}" text="{3214,58}" icon="protect"/>
                                                              </objective>
                                                            </objectives>
                                                          </create_briefing>
                                                          <set_objective cue="KTHfinalinstructions_Findcrew" title="{3214,1}" text="{3214,56}" noabort="1">
                                                            <briefing cue="KTHfinalinstructions_Findcrew" step="5"/>
                                                            <mission discipline="XXXT" level="average"/>
                                                            <custom action="{35,2041}" text="{3214,58}" icon="protect"/>
                                                          </set_objective>
                                                        </do_when>
                                                        <do_otherwise>
                                                          <cancel_cue cue="KTHfinalinstructions_Update Needed Conditions"/>
                                                          <cancel_cue cue="KTHfinalinstructions_rescue" instantiate="static"/>
                                                          <set_invincible object="KTH_toplevel.KTHCrewship" invincible="0"/>
                                                          <create_briefing cue="KTHfinalinstructions_Findcrew" title="{3214,1}" text="{3214,61}" background="station_argon_space_fuel_distillery.tga">
                                                            <mission discipline="XXXT" level="easy"/>
                                                            <objectives>
                                                              <objective step="6">
                                                                <dockat object="KTH_toplevel.KTHshipyard"/>
                                                              </objective>
                                                            </objectives>
                                                          </create_briefing>
                                                          <set_objective cue="KTHfinalinstructions_Findcrew" title="{3214,1}" text="{3214,61}" noabort="1">
                                                            <briefing cue="KTHfinalinstructions_Findcrew" step="6"/>
                                                            <mission discipline="XXXT" level="easy"/>
                                                            <dockat object="KTH_toplevel.KTHshipyard"/>
                                                          </set_objective>
                                                        </do_otherwise>
                                                      </do_choose>
                                                    </do_all>
                                                  </action>
                                                </cue>
                                                <!-- Retrieve Crew and get bonus-->
                                                <cue name="KTHretrievecrew_arrival" delay="500" instantiate="static">
                                                  <condition>
                                                    <check_all>
                                                      <object_is_docked dockobject="KTH_toplevel.KTHshipyard"/>
                                                      <check_value value="{group.object.count@KTH_toplevel.KTHCrewactor}" min="1"/>
                                                      <check_any exact="{group.object.count@KTH_toplevel.KTHCrewactor}" counter="count">
                                                        <check_all>
                                                          <check_value value="{actor.ship.exists@{group.object.{counter@count}@KTH_toplevel.KTHCrewactor}}" exact="1"/>
                                                          <check_value value="{actor.ship@{group.object.{counter@count}@KTH_toplevel.KTHCrewactor}}" exact="{player.ship}"/>
                                                        </check_all>
                                                      </check_any>
                                                    </check_all>
                                                  </condition>
                                                  <action>
                                                    <do_all>
                                                      <set_value name="this.actor removed" exact="0"/>
                                                      <do_all exact="{group.object.count@KTH_toplevel.KTHCrewactor}" counter="count">
                                                        <do_if value="{value@this.actor removed}" exact="0">
                                                          <do_if value="{actor.ship.exists@{group.object.{counter@count}@KTH_toplevel.KTHCrewactor}}" exact="1">
                                                            <do_if value="{actor.ship@{group.object.{counter@count}@KTH_toplevel.KTHCrewactor}}" exact="{player.ship}">
                                                              <set_actor_invincible actor="{group.object.{counter@count}@KTH_toplevel.KTHCrewactor}" invincible="0"/>
                                                              <set_value name="this.actor removed" exact="1"/>
                                                              <set_value name="KTH_toplevel.KTHcrewdelivercheck" operation="add"/>
                                                              <destroy_actor actor="{group.object.{counter@count}@KTH_toplevel.KTHCrewactor}"/>
                                                              <reset_cue cue="KTHretrievecrew_arrival"/>
                                                            </do_if>
                                                          </do_if>
                                                        </do_if>
                                                      </do_all>
                                                    </do_all>
                                                  </action>
                                                </cue>
                                                <cue name="KTHretrievecrew_all_done" delay="2s">
                                                  <condition>
                                                    <check_value value="{group.object.count@KTH_toplevel.KTHCrewactor}" exact="0"/>
                                                  </condition>
                                                  <action>
                                                    <do_choose>
                                                      <do_when value="{value@KTH_toplevel.KTHcrewdelivercheck}" min="7">
                                                        <incoming_message author="{actor.name@KTH_toplevel.KTHMilitary}" text="{3214,63}"/>
                                                        <create_ship typename="SS_SH_X_SHUTTLE" race="player" dockobject="KTH_toplevel.KTHshipyard" sellable="0">
                                                          <sector sector="{player.sector}"/>
                                                          <equipment loadout="default"/>
                                                        </create_ship>
                                                        <unlock_achievement name="TREASURE_HUNT_PLOT"/>
                                                        <remove_briefing cue="KTHfinalinstructions_Findcrew"/>
                                                        <remove_objective cue="KTHfinalinstructions_Findcrew" status="complete"/>
                                                        <set_value name="KTH_toplevel.KTHcleanuplink" exact="1"/>
                                                      </do_when>
                                                      <do_otherwise>
                                                        <incoming_message author="{actor.name@KTH_toplevel.KTHMilitary}" text="{3214,62}"/>
                                                        <remove_briefing cue="KTHfinalinstructions_Findcrew"/>
                                                        <remove_objective cue="KTHfinalinstructions_Findcrew" status="failed"/>
                                                        <reward_player>
                                                          <notoriety>
                                                            <relation race="argon" operation="subtract" min="notop2" max="notop4"/>
                                                          </notoriety>
                                                        </reward_player>
                                                        <set_value name="KTH_toplevel.KTHcleanuplink" exact="1"/>
                                                      </do_otherwise>
                                                    </do_choose>
                                                  </action>
                                                </cue>
                                              </cues>
                                            </cue>
                                          </cues>
                                        </cue>
                                      </cues>
                                    </cue>
                                  </cues>
                                </cue>
                              </cues>
                            </cue>
                          </cues>
                        </cue>
                      </cues>
                    </cue>
                  </cues>
                </cue>
              </cues>
            </cue>
          </cues>
        </cue>
      </cues>
    </cue>
    <cue name="KTHcleanup" delay="952" version="2">
      <condition>
        <check_value value="{value@KTH_toplevel.KTHcleanuplink}" exact="1"/>
      </condition>
      <timing>
        <time exact="5s"/>
      </timing>
      <action>
        <do_all>
          <do_all exact="{group.object.count@KTH_toplevel.KTHCrewactor}" counter="count">
            <set_actor_invincible actor="{group.object.{counter@count}@KTH_toplevel.KTHCrewactor}" invincible="0"/>
            <do_choose>
              <do_when value="{actor.ship.isclass.astronaut@{group.object.1@KTH_toplevel.KTHCrewactor}}" exact="1">
                <destroy_object object="{actor.ship@{group.object.1@KTH_toplevel.KTHCrewactor}}"/>
              </do_when>
              <do_otherwise>
                <destroy_actor actor="{group.object.1@KTH_toplevel.KTHCrewactor}"/>
              </do_otherwise>
            </do_choose>
          </do_all>
          <destroy_object object="KTHpersuade_yaki_Satdeployed.Yakisat2count" explosion="0"/>
          <destroy_group group="KTH_toplevel.YakiOLGroup" explosion="0"/>
          <destroy_group group="KTH_toplevel.YakiMines" explosion="0"/>
          <destroy_object object="KTH_toplevel.AbortTP" warp="1"/>
          <destroy_object object="KTH_toplevel.KTHTLwreck" warp="1"/>
          <destroy_group group="KTH_toplevel.KTHCrewshipescort" warp="1"/>
          <do_if value="{object.race@KTH_toplevel.KTHCrewship}" exact="{lookup.race@player}" negate="1">
            <do_if value="{object.boarding@KTH_toplevel.KTHCrewship}" exact="0">
              <destroy_object object="KTH_toplevel.KTHCrewship" warp="1"/>
            </do_if>
          </do_if>
          <destroy_actor actor="KTH_toplevel.KTHMilitary"/>
          <set_invincible object="KTH_toplevel.KTHshipyard" invincible="0"/>
          <set_invincible object="KTH_toplevel.KTHofferstation" invincible="0"/>
          <cancel_cue cue="KTH_Message"/>
        </do_all>
      </action>
    </cue>
  </cues>
  <signature>p+GH//OJqX7AT6FkFDg7RdF9QTRGBU+tCh6UNt3hvcTf8x3BHKOX01ATd2Y/7GNzOXSHVlvZtB7hQ6oBbLDh5jTXlqDwfJMO+s1Jz3AN7+WEim6L2yJWWIpU70CU3DjiRWjtDafur/ydKUVRTajXmZjgydLuHYylrDJWRrxSgXR7Fr0I6CtedeUQYvOfW7R1FofjJHZIiGe1vpsi4/9Tfxl0zR5Zli+1y1upM7ba4qZC5F2phvQavywYkIgSELTpMzkzQzvJapGBLNG1M+pEJHMN04KOywtLiDKQX81IZQit3Qk7p/ZSOVp288Bb4sjW2g9/ywbYd4NC+fL/88MgZg==</signature>
</director>